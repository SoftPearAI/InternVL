+ PER_DEVICE_BATCH_SIZE=4
+ GRADIENT_ACC=2
+ export MASTER_PORT=34229
+ export LAUNCHER=pytorch
+ OUTPUT_DIR=work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt
+ RUN_NAME=00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt
+ [ ! -d work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt ]
+ mkdir -p work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt
+ deepspeed --include localhost:4,5,6,7 --master_port 34229 internvl/train/internvl_chat_finetune.py --model_name_or_path OpenGVLab/InternVL2-8B --conv_style internlm2-chat --output_dir work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt --meta_path /home/danielko/src/softpear-rnd/generation/video/data/auto_captioning/InternVL/internvl_chat/shell/internlm2_20b_dynamic/metadata.json --overwrite_output_dir True --force_image_size 448 --max_dynamic_patch 12 --down_sample_ratio 0.5 --drop_path_rate 0.1 --pad2square False --freeze_llm True --freeze_mlp False --use_llm_lora 32 --use_backbone_lora 16 --freeze_backbone True --vision_select_layer -1 --use_data_resampling False --dataloader_num_workers 4 --bf16 True --num_train_epochs 5 --per_device_train_batch_size 4 --gradient_accumulation_steps 2 --evaluation_strategy epoch --do_eval True --eval_meta_path /home/danielko/src/softpear-rnd/generation/video/data/auto_captioning/InternVL/internvl_chat/shell/internlm2_20b_dynamic/eval_metadata.json --save_strategy epoch --save_total_limit 3 --learning_rate 2e-5 --weight_decay 0.05 --warmup_ratio 0.03 --lr_scheduler_type cosine --logging_steps 1 --max_seq_length 4096 --do_train True --grad_checkpoint True --group_by_length True --dynamic_image_size True --use_thumbnail True --ps_version v2 --deepspeed zero_stage3_config.json --run_name 00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt --report_to wandb
[2024-07-26 15:27:42,839] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:27:43,905] [WARNING] [runner.py:196:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-07-26 15:27:44,044] [INFO] [runner.py:555:main] cmd = /home/danielko/miniconda3/envs/internvl2/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=34229 --enable_each_rank_log=None internvl/train/internvl_chat_finetune.py --model_name_or_path OpenGVLab/InternVL2-8B --conv_style internlm2-chat --output_dir work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt --meta_path /home/danielko/src/softpear-rnd/generation/video/data/auto_captioning/InternVL/internvl_chat/shell/internlm2_20b_dynamic/metadata.json --overwrite_output_dir True --force_image_size 448 --max_dynamic_patch 12 --down_sample_ratio 0.5 --drop_path_rate 0.1 --pad2square False --freeze_llm True --freeze_mlp False --use_llm_lora 32 --use_backbone_lora 16 --freeze_backbone True --vision_select_layer -1 --use_data_resampling False --dataloader_num_workers 4 --bf16 True --num_train_epochs 5 --per_device_train_batch_size 4 --gradient_accumulation_steps 2 --evaluation_strategy epoch --do_eval True --eval_meta_path /home/danielko/src/softpear-rnd/generation/video/data/auto_captioning/InternVL/internvl_chat/shell/internlm2_20b_dynamic/eval_metadata.json --save_strategy epoch --save_total_limit 3 --learning_rate 2e-5 --weight_decay 0.05 --warmup_ratio 0.03 --lr_scheduler_type cosine --logging_steps 1 --max_seq_length 4096 --do_train True --grad_checkpoint True --group_by_length True --dynamic_image_size True --use_thumbnail True --ps_version v2 --deepspeed zero_stage3_config.json --run_name 00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt --report_to wandb
[2024-07-26 15:27:45,004] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:27:46,074] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [4, 5, 6, 7]}
[2024-07-26 15:27:46,074] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=4, node_rank=0
[2024-07-26 15:27:46,074] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2024-07-26 15:27:46,074] [INFO] [launch.py:163:main] dist_world_size=4
[2024-07-26 15:27:46,074] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=4,5,6,7
[2024-07-26 15:27:47,232] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:27:47,232] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:27:47,232] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:27:47,244] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
[2024-07-26 15:27:51,267] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2024-07-26 15:27:51,267] [INFO] [comm.py:616:init_distributed] cdb=None
[2024-07-26 15:27:51,267] [INFO] [comm.py:643:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-07-26 15:27:51,840] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2024-07-26 15:27:51,840] [INFO] [comm.py:616:init_distributed] cdb=None
[2024-07-26 15:27:51,840] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2024-07-26 15:27:51,840] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2024-07-26 15:27:51,840] [INFO] [comm.py:616:init_distributed] cdb=None
[2024-07-26 15:27:51,840] [INFO] [comm.py:616:init_distributed] cdb=None
07/26/2024 15:27:52 - WARNING - __main__ - Process rank: 3, device: cuda:3, n_gpu: 1distributed training: True, 16-bits training: False
07/26/2024 15:27:52 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
07/26/2024 15:27:52 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
batch_eval_metrics=False,
bf16=True,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=4,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=zero_stage3_config.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=epoch,
eval_use_gather_object=False,
evaluation_strategy=epoch,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=2,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=True,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/runs/Jul26_15-27-51_t2i-node-1,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=1.0,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=cosine,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=5.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=4,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['wandb'],
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
run_name=00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=500,
save_strategy=epoch,
save_total_limit=3,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torch_empty_cache_steps=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.03,
warmup_steps=0,
weight_decay=0.05,
)
07/26/2024 15:27:52 - INFO - __main__ - Loading Tokenizer: OpenGVLab/InternVL2-8B
07/26/2024 15:27:52 - WARNING - __main__ - Process rank: 1, device: cuda:1, n_gpu: 1distributed training: True, 16-bits training: False
07/26/2024 15:27:52 - WARNING - __main__ - Process rank: 2, device: cuda:2, n_gpu: 1distributed training: True, 16-bits training: False
[INFO|tokenization_utils_base.py:2289] 2024-07-26 15:27:52,497 >> loading file ./tokenizer.model from cache at /home/danielko/.cache/huggingface/hub/models--OpenGVLab--InternVL2-8B/snapshots/277b5e2de02e9eab7b547838292ef2ed8885c731/./tokenizer.model
[INFO|tokenization_utils_base.py:2289] 2024-07-26 15:27:52,497 >> loading file added_tokens.json from cache at /home/danielko/.cache/huggingface/hub/models--OpenGVLab--InternVL2-8B/snapshots/277b5e2de02e9eab7b547838292ef2ed8885c731/added_tokens.json
[INFO|tokenization_utils_base.py:2289] 2024-07-26 15:27:52,497 >> loading file special_tokens_map.json from cache at /home/danielko/.cache/huggingface/hub/models--OpenGVLab--InternVL2-8B/snapshots/277b5e2de02e9eab7b547838292ef2ed8885c731/special_tokens_map.json
[INFO|tokenization_utils_base.py:2289] 2024-07-26 15:27:52,497 >> loading file tokenizer_config.json from cache at /home/danielko/.cache/huggingface/hub/models--OpenGVLab--InternVL2-8B/snapshots/277b5e2de02e9eab7b547838292ef2ed8885c731/tokenizer_config.json
[INFO|tokenization_utils_base.py:2289] 2024-07-26 15:27:52,497 >> loading file tokenizer.json from cache at None
[INFO|tokenization_utils_base.py:2533] 2024-07-26 15:27:52,612 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
07/26/2024 15:27:52 - INFO - __main__ - Loading InternVLChatModel...
[INFO|configuration_utils.py:733] 2024-07-26 15:27:52,825 >> loading configuration file config.json from cache at /home/danielko/.cache/huggingface/hub/models--OpenGVLab--InternVL2-8B/snapshots/277b5e2de02e9eab7b547838292ef2ed8885c731/config.json
[INFO|configuration_utils.py:800] 2024-07-26 15:27:52,826 >> Model config InternVLChatConfig {
  "_commit_hash": "277b5e2de02e9eab7b547838292ef2ed8885c731",
  "architectures": [
    "InternVLChatModel"
  ],
  "auto_map": {
    "AutoConfig": "OpenGVLab/InternVL2-8B--configuration_internvl_chat.InternVLChatConfig",
    "AutoModel": "OpenGVLab/InternVL2-8B--modeling_internvl_chat.InternVLChatModel",
    "AutoModelForCausalLM": "OpenGVLab/InternVL2-8B--modeling_internvl_chat.InternVLChatModel"
  },
  "downsample_ratio": 0.5,
  "dynamic_image_size": true,
  "force_image_size": 448,
  "llm_config": {
    "_name_or_path": "internlm/internlm2_5-7b-chat",
    "add_cross_attention": false,
    "architectures": [
      "InternLM2ForCausalLM"
    ],
    "attn_implementation": "flash_attention_2",
    "auto_map": {
      "AutoConfig": "configuration_internlm2.InternLM2Config",
      "AutoModel": "modeling_internlm2.InternLM2ForCausalLM",
      "AutoModelForCausalLM": "modeling_internlm2.InternLM2ForCausalLM"
    },
    "bad_words_ids": null,
    "begin_suppress_tokens": null,
    "bias": false,
    "bos_token_id": 1,
    "chunk_size_feed_forward": 0,
    "cross_attention_hidden_size": null,
    "decoder_start_token_id": null,
    "diversity_penalty": 0.0,
    "do_sample": false,
    "early_stopping": false,
    "encoder_no_repeat_ngram_size": 0,
    "eos_token_id": 2,
    "exponential_decay_length_penalty": null,
    "finetuning_task": null,
    "forced_bos_token_id": null,
    "forced_eos_token_id": null,
    "hidden_act": "silu",
    "hidden_size": 4096,
    "id2label": {
      "0": "LABEL_0",
      "1": "LABEL_1"
    },
    "initializer_range": 0.02,
    "intermediate_size": 14336,
    "is_decoder": false,
    "is_encoder_decoder": false,
    "label2id": {
      "LABEL_0": 0,
      "LABEL_1": 1
    },
    "length_penalty": 1.0,
    "max_length": 20,
    "max_position_embeddings": 32768,
    "min_length": 0,
    "model_type": "internlm2",
    "no_repeat_ngram_size": 0,
    "num_attention_heads": 32,
    "num_beam_groups": 1,
    "num_beams": 1,
    "num_hidden_layers": 32,
    "num_key_value_heads": 8,
    "num_return_sequences": 1,
    "output_attentions": false,
    "output_hidden_states": false,
    "output_scores": false,
    "pad_token_id": 2,
    "prefix": null,
    "pretraining_tp": 1,
    "problem_type": null,
    "pruned_heads": {},
    "remove_invalid_values": false,
    "repetition_penalty": 1.0,
    "return_dict": true,
    "return_dict_in_generate": false,
    "rms_norm_eps": 1e-05,
    "rope_scaling": {
      "factor": 2.0,
      "type": "dynamic"
    },
    "rope_theta": 1000000,
    "sep_token_id": null,
    "suppress_tokens": null,
    "task_specific_params": null,
    "temperature": 1.0,
    "tf_legacy_loss": false,
    "tie_encoder_decoder": false,
    "tie_word_embeddings": false,
    "tokenizer_class": null,
    "top_k": 50,
    "top_p": 1.0,
    "torch_dtype": "bfloat16",
    "torchscript": false,
    "transformers_version": "4.43.1",
    "typical_p": 1.0,
    "use_bfloat16": true,
    "use_cache": true,
    "vocab_size": 92553
  },
  "max_dynamic_patch": 12,
  "min_dynamic_patch": 1,
  "model_type": "internvl_chat",
  "pad2square": false,
  "ps_version": "v2",
  "select_layer": -1,
  "template": "internlm2-chat",
  "torch_dtype": "bfloat16",
  "transformers_version": null,
  "use_backbone_lora": 0,
  "use_llm_lora": 0,
  "use_thumbnail": true,
  "vision_config": {
    "_name_or_path": "",
    "add_cross_attention": false,
    "architectures": [
      "InternVisionModel"
    ],
    "attention_dropout": 0.0,
    "bad_words_ids": null,
    "begin_suppress_tokens": null,
    "bos_token_id": null,
    "chunk_size_feed_forward": 0,
    "cross_attention_hidden_size": null,
    "decoder_start_token_id": null,
    "diversity_penalty": 0.0,
    "do_sample": false,
    "drop_path_rate": 0.0,
    "dropout": 0.0,
    "early_stopping": false,
    "encoder_no_repeat_ngram_size": 0,
    "eos_token_id": null,
    "exponential_decay_length_penalty": null,
    "finetuning_task": null,
    "forced_bos_token_id": null,
    "forced_eos_token_id": null,
    "hidden_act": "gelu",
    "hidden_size": 1024,
    "id2label": {
      "0": "LABEL_0",
      "1": "LABEL_1"
    },
    "image_size": 448,
    "initializer_factor": 1.0,
    "initializer_range": 0.02,
    "intermediate_size": 4096,
    "is_decoder": false,
    "is_encoder_decoder": false,
    "label2id": {
      "LABEL_0": 0,
      "LABEL_1": 1
    },
    "layer_norm_eps": 1e-06,
    "length_penalty": 1.0,
    "max_length": 20,
    "min_length": 0,
    "model_type": "intern_vit_6b",
    "no_repeat_ngram_size": 0,
    "norm_type": "layer_norm",
    "num_attention_heads": 16,
    "num_beam_groups": 1,
    "num_beams": 1,
    "num_channels": 3,
    "num_hidden_layers": 24,
    "num_return_sequences": 1,
    "output_attentions": false,
    "output_hidden_states": false,
    "output_scores": false,
    "pad_token_id": null,
    "patch_size": 14,
    "prefix": null,
    "problem_type": null,
    "pruned_heads": {},
    "qk_normalization": false,
    "qkv_bias": true,
    "remove_invalid_values": false,
    "repetition_penalty": 1.0,
    "return_dict": true,
    "return_dict_in_generate": false,
    "sep_token_id": null,
    "suppress_tokens": null,
    "task_specific_params": null,
    "temperature": 1.0,
    "tf_legacy_loss": false,
    "tie_encoder_decoder": false,
    "tie_word_embeddings": true,
    "tokenizer_class": null,
    "top_k": 50,
    "top_p": 1.0,
    "torch_dtype": "bfloat16",
    "torchscript": false,
    "transformers_version": "4.43.1",
    "typical_p": 1.0,
    "use_bfloat16": true,
    "use_flash_attn": true
  }
}

07/26/2024 15:27:52 - INFO - __main__ - Using flash_attention_2 for InternLM
[INFO|modeling_utils.py:3621] 2024-07-26 15:27:52,826 >> loading weights file model.safetensors from cache at /home/danielko/.cache/huggingface/hub/models--OpenGVLab--InternVL2-8B/snapshots/277b5e2de02e9eab7b547838292ef2ed8885c731/model.safetensors.index.json
[INFO|modeling_utils.py:1569] 2024-07-26 15:27:52,829 >> Instantiating InternVLChatModel model under default dtype torch.bfloat16.
[INFO|modeling_utils.py:3763] 2024-07-26 15:27:52,829 >> Detected DeepSpeed ZeRO-3: activating zero.init() for this model
[INFO|configuration_utils.py:1038] 2024-07-26 15:27:52,838 >> Generate config GenerationConfig {}

[2024-07-26 15:27:57,123] [WARNING] [partition_parameters.py:921:_post_init_method] param `class_embedding` in InternVisionEmbeddings not on GPU so was not broadcasted from rank 0
[2024-07-26 15:27:57,124] [WARNING] [partition_parameters.py:921:_post_init_method] param `position_embedding` in InternVisionEmbeddings not on GPU so was not broadcasted from rank 0
[INFO|configuration_utils.py:1038] 2024-07-26 15:27:57,235 >> Generate config GenerationConfig {
  "bos_token_id": 1,
  "eos_token_id": 2,
  "pad_token_id": 2
}

[2024-07-26 15:27:57,415] [INFO] [partition_parameters.py:326:__exit__] finished initializing model with 8.08B parameters
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.04it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.99it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.90it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.97it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.87it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  2.84it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  3.32it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  3.22it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  3.13it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.33s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.19s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.13s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.33s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.17it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s]
[INFO|modeling_utils.py:4450] 2024-07-26 15:28:01,388 >> All model checkpoint weights were used when initializing InternVLChatModel.

[INFO|modeling_utils.py:4458] 2024-07-26 15:28:01,389 >> All the weights of InternVLChatModel were initialized from the model checkpoint at OpenGVLab/InternVL2-8B.
If your task is similar to the task the model of the checkpoint was trained on, you can already use InternVLChatModel for predictions without further training.
Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.34s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.34s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s]
[INFO|configuration_utils.py:993] 2024-07-26 15:28:01,526 >> loading configuration file generation_config.json from cache at /home/danielko/.cache/huggingface/hub/models--OpenGVLab--InternVL2-8B/snapshots/277b5e2de02e9eab7b547838292ef2ed8885c731/generation_config.json
[INFO|configuration_utils.py:1038] 2024-07-26 15:28:01,527 >> Generate config GenerationConfig {}

07/26/2024 15:28:01 - INFO - __main__ - Finished
07/26/2024 15:28:01 - INFO - __main__ - model.config.force_image_size: 448
07/26/2024 15:28:01 - INFO - __main__ - data_args.force_image_size: 448
07/26/2024 15:28:01 - INFO - __main__ - model.config.vision_config.image_size: 448
07/26/2024 15:28:01 - INFO - __main__ - [Dataset] num_image_token: 256
07/26/2024 15:28:01 - INFO - __main__ - [Dataset] dynamic_image_size: True
07/26/2024 15:28:01 - INFO - __main__ - [Dataset] use_thumbnail: True
07/26/2024 15:28:01 - INFO - __main__ - [Dataset] min_dynamic_patch: 1, max_dynamic_patch: 12
07/26/2024 15:28:01 - INFO - __main__ - Formatting inputs...Skip in lazy mode
07/26/2024 15:28:02 - INFO - __main__ - Add dataset: your-custom-dataset-1 with length: 1284
07/26/2024 15:28:02 - INFO - __main__ - [Dataset] num_image_token: 256
07/26/2024 15:28:02 - INFO - __main__ - [Dataset] dynamic_image_size: True
07/26/2024 15:28:02 - INFO - __main__ - [Dataset] use_thumbnail: True
07/26/2024 15:28:02 - INFO - __main__ - [Dataset] min_dynamic_patch: 1, max_dynamic_patch: 12
07/26/2024 15:28:02 - INFO - __main__ - Formatting inputs...Skip in lazy mode
07/26/2024 15:28:02 - INFO - __main__ - Add dataset: your-custom-dataset-1 with length: 160
trainable params: 6,291,456 || all params: 310,303,744 || trainable%: 2.0275
trainable params: 6,291,456 || all params: 310,303,744 || trainable%: 2.0275
trainable params: 6,291,456 || all params: 310,303,744 || trainable%: 2.0275
trainable params: 6,291,456 || all params: 310,303,744 || trainable%: 2.0275
trainable params: 75,497,472 || all params: 7,813,279,744 || trainable%: 0.9663
trainable params: 75,497,472 || all params: 7,813,279,744 || trainable%: 0.9663
trainable params: 75,497,472 || all params: 7,813,279,744 || trainable%: 0.9663
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.0.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.1.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.2.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.3.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.4.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.5.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.6.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.7.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.8.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.9.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.10.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.11.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.12.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.13.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.14.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.15.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.16.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.17.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.mlp.fc2.lora_A.default.weight
trainable params: 75,497,472 || all params: 7,813,279,744 || trainable%: 0.966307/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.18.mlp.fc2.lora_B.default.weight

07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.19.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.20.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.21.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.22.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.attn.qkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.attn.qkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.attn.proj.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.attn.proj.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.mlp.fc1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.mlp.fc1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.mlp.fc2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - vision_model.base_model.model.encoder.layers.23.mlp.fc2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.0.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.1.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.2.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.3.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.4.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.5.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.6.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.7.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.8.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.9.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.10.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.11.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.12.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.13.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.14.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.15.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.16.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.17.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.18.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.19.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.20.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.21.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.22.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.23.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.24.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.25.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.26.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.27.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.28.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.29.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.30.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.attention.wqkv.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.attention.wqkv.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.attention.wo.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.attention.wo.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.feed_forward.w1.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.feed_forward.w1.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.feed_forward.w3.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.feed_forward.w3.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.feed_forward.w2.lora_A.default.weight
07/26/2024 15:28:13 - INFO - __main__ - language_model.base_model.model.model.layers.31.feed_forward.w2.lora_B.default.weight
07/26/2024 15:28:13 - INFO - __main__ - mlp1.0.weight
07/26/2024 15:28:13 - INFO - __main__ - mlp1.0.bias
07/26/2024 15:28:13 - INFO - __main__ - mlp1.1.weight
07/26/2024 15:28:13 - INFO - __main__ - mlp1.1.bias
07/26/2024 15:28:13 - INFO - __main__ - mlp1.3.weight
07/26/2024 15:28:13 - INFO - __main__ - mlp1.3.bias
[INFO|trainer.py:648] 2024-07-26 15:28:13,974 >> Using auto half precision backend
[2024-07-26 15:28:14,229] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.10.0, git-hash=unknown, git-branch=unknown
[2024-07-26 15:28:17,108] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /home/danielko/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Using /home/danielko/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Using /home/danielko/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Using /home/danielko/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/danielko/.cache/torch_extensions/py310_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.06453108787536621 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 0.10140562057495117 seconds
Loading extension module fused_adam...
[2024-07-26 15:28:17,213] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
Time to load fused_adam op: 0.10174798965454102 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 0.10210132598876953 seconds
[2024-07-26 15:28:17,253] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-07-26 15:28:17,253] [INFO] [utils.py:54:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-07-26 15:28:17,253] [INFO] [logging.py:96:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[2024-07-26 15:28:17,253] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 3 optimizer
[2024-07-26 15:28:17,406] [INFO] [utils.py:785:see_memory_usage] Stage 3 initialize beginning
[2024-07-26 15:28:17,407] [INFO] [utils.py:786:see_memory_usage] MA 4.42 GB         Max_MA 5.69 GB         CA 4.53 GB         Max_CA 7 GB 
[2024-07-26 15:28:17,407] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.47 GB, percent = 10.0%
[2024-07-26 15:28:17,416] [INFO] [stage3.py:117:__init__] Reduce bucket size 1000000000
[2024-07-26 15:28:17,416] [INFO] [stage3.py:118:__init__] Prefetch bucket size 1000000000
[2024-07-26 15:28:17,529] [INFO] [utils.py:785:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[2024-07-26 15:28:17,530] [INFO] [utils.py:786:see_memory_usage] MA 4.42 GB         Max_MA 4.42 GB         CA 4.53 GB         Max_CA 5 GB 
[2024-07-26 15:28:17,530] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.48 GB, percent = 10.0%
Parameter Offload: Total persistent parameters: 386083840 in 921 params
[2024-07-26 15:28:17,819] [INFO] [utils.py:785:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[2024-07-26 15:28:17,819] [INFO] [utils.py:786:see_memory_usage] MA 4.31 GB         Max_MA 4.42 GB         CA 4.53 GB         Max_CA 5 GB 
[2024-07-26 15:28:17,820] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.48 GB, percent = 10.0%
[2024-07-26 15:28:17,957] [INFO] [utils.py:785:see_memory_usage] Before creating fp16 partitions
[2024-07-26 15:28:17,957] [INFO] [utils.py:786:see_memory_usage] MA 4.31 GB         Max_MA 4.31 GB         CA 4.53 GB         Max_CA 5 GB 
[2024-07-26 15:28:17,957] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.48 GB, percent = 10.0%
[2024-07-26 15:28:18,365] [INFO] [utils.py:785:see_memory_usage] After creating fp16 partitions: 1
[2024-07-26 15:28:18,367] [INFO] [utils.py:786:see_memory_usage] MA 4.31 GB         Max_MA 4.31 GB         CA 4.43 GB         Max_CA 5 GB 
[2024-07-26 15:28:18,367] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.48 GB, percent = 10.0%
[2024-07-26 15:28:18,486] [INFO] [utils.py:785:see_memory_usage] Before creating fp32 partitions
[2024-07-26 15:28:18,486] [INFO] [utils.py:786:see_memory_usage] MA 4.31 GB         Max_MA 4.31 GB         CA 4.43 GB         Max_CA 4 GB 
[2024-07-26 15:28:18,486] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.48 GB, percent = 10.0%
[2024-07-26 15:28:18,607] [INFO] [utils.py:785:see_memory_usage] After creating fp32 partitions
[2024-07-26 15:28:18,608] [INFO] [utils.py:786:see_memory_usage] MA 4.42 GB         Max_MA 4.47 GB         CA 4.6 GB         Max_CA 5 GB 
[2024-07-26 15:28:18,608] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.48 GB, percent = 10.0%
[2024-07-26 15:28:18,756] [INFO] [utils.py:785:see_memory_usage] Before initializing optimizer states
[2024-07-26 15:28:18,757] [INFO] [utils.py:786:see_memory_usage] MA 4.42 GB         Max_MA 4.42 GB         CA 4.6 GB         Max_CA 5 GB 
[2024-07-26 15:28:18,757] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.49 GB, percent = 10.0%
[2024-07-26 15:28:18,786] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | init_optimizer_state: 2.06
[2024-07-26 15:28:18,903] [INFO] [utils.py:785:see_memory_usage] After initializing optimizer states
[2024-07-26 15:28:18,903] [INFO] [utils.py:786:see_memory_usage] MA 4.63 GB         Max_MA 4.74 GB         CA 4.92 GB         Max_CA 5 GB 
[2024-07-26 15:28:18,904] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.48 GB, percent = 10.0%
[2024-07-26 15:28:18,904] [INFO] [stage3.py:424:_setup_for_real_optimizer] optimizer state initialized
[2024-07-26 15:28:19,288] [INFO] [utils.py:785:see_memory_usage] After initializing ZeRO optimizer
[2024-07-26 15:28:19,288] [INFO] [utils.py:786:see_memory_usage] MA 6.55 GB         Max_MA 6.61 GB         CA 6.88 GB         Max_CA 7 GB 
[2024-07-26 15:28:19,289] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 126.72 GB, percent = 10.1%
[2024-07-26 15:28:19,289] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adamw
[2024-07-26 15:28:19,289] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client callable to create LR scheduler
[2024-07-26 15:28:19,289] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7efdc058f430>
[2024-07-26 15:28:19,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[[0.9, 0.999]]
[2024-07-26 15:28:19,294] [INFO] [config.py:960:print] DeepSpeedEngine configuration:
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   amp_enabled .................. False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   amp_params ................... False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   bfloat16_enabled ............. True
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   checkpoint_parallel_write_pipeline  False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   checkpoint_tag_validation_enabled  True
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   checkpoint_tag_validation_fail  False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f00263ffd90>
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   communication_data_type ...... None
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   curriculum_enabled_legacy .... False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   curriculum_params_legacy ..... False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   data_efficiency_enabled ...... False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   dataloader_drop_last ......... False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   disable_allgather ............ False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   dump_state ................... False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   dynamic_loss_scale_args ...... None
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   eigenvalue_enabled ........... False
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   eigenvalue_gas_boundary_resolution  1
[2024-07-26 15:28:19,295] [INFO] [config.py:964:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   eigenvalue_layer_num ......... 0
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   eigenvalue_max_iter .......... 100
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   eigenvalue_stability ......... 1e-06
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   eigenvalue_tol ............... 0.01
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   eigenvalue_verbose ........... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   elasticity_enabled ........... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   fp16_auto_cast ............... None
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   fp16_enabled ................. False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   fp16_master_weights_and_gradients  False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   global_rank .................. 0
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   grad_accum_dtype ............. None
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   gradient_accumulation_steps .. 2
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   gradient_clipping ............ 1.0
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   gradient_predivide_factor .... 1.0
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   initial_dynamic_scale ........ 1
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   load_universal_checkpoint .... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   loss_scale ................... 1.0
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   memory_breakdown ............. False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   mics_hierarchial_params_gather  False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   mics_shard_size .............. -1
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   optimizer_legacy_fusion ...... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   optimizer_name ............... adamw
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   optimizer_params ............. {'lr': 2e-05, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0.05}
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   pld_enabled .................. False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   pld_params ................... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   prescale_gradients ........... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   scheduler_name ............... None
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   scheduler_params ............. None
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   sparse_attention ............. None
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   sparse_gradients_enabled ..... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   steps_per_print .............. inf
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   train_batch_size ............. 32
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   train_micro_batch_size_per_gpu  4
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   use_node_local_storage ....... False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   wall_clock_breakdown ......... True
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   world_size ................... 4
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   zero_allow_untested_optimizer  False
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=1000000000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=1000000000 param_persistence_threshold=10000000 model_persistence_threshold=sys.maxsize max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=True stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   zero_enabled ................. True
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   zero_force_ds_cpu_optimizer .. True
[2024-07-26 15:28:19,296] [INFO] [config.py:964:print]   zero_optimization_stage ...... 3
[2024-07-26 15:28:19,296] [INFO] [config.py:950:print_user_config]   json = {
    "zero_optimization": {
        "stage": 3, 
        "overlap_comm": true, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09, 
        "reduce_bucket_size": 1.000000e+09, 
        "stage3_prefetch_bucket_size": 1.000000e+09, 
        "stage3_param_persistence_threshold": 1.000000e+07, 
        "stage3_max_live_parameters": 1.000000e+09, 
        "stage3_max_reuse_distance": 1.000000e+09, 
        "stage3_gather_16bit_weights_on_model_save": true
    }, 
    "fp16": {
        "enabled": false, 
        "auto_cast": true, 
        "loss_scale": 0, 
        "initial_scale_power": 32, 
        "loss_scale_window": 1000, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "bf16": {
        "enabled": true
    }, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 2e-05, 
            "betas": [0.9, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 0.05
        }
    }, 
    "gradient_accumulation_steps": 2, 
    "gradient_clipping": 1.0, 
    "steps_per_print": inf, 
    "train_batch_size": 32, 
    "train_micro_batch_size_per_gpu": 4, 
    "wall_clock_breakdown": true
}
[INFO|trainer.py:2134] 2024-07-26 15:28:19,297 >> ***** Running training *****
[INFO|trainer.py:2135] 2024-07-26 15:28:19,297 >>   Num examples = 1,284
[INFO|trainer.py:2136] 2024-07-26 15:28:19,297 >>   Num Epochs = 5
[INFO|trainer.py:2137] 2024-07-26 15:28:19,297 >>   Instantaneous batch size per device = 4
[INFO|trainer.py:2140] 2024-07-26 15:28:19,297 >>   Total train batch size (w. parallel, distributed & accumulation) = 32
[INFO|trainer.py:2141] 2024-07-26 15:28:19,297 >>   Gradient Accumulation steps = 2
[INFO|trainer.py:2142] 2024-07-26 15:28:19,297 >>   Total optimization steps = 200
[INFO|trainer.py:2143] 2024-07-26 15:28:19,303 >>   Number of trainable parameters = 115,359,744
[INFO|integration_utils.py:786] 2024-07-26 15:28:19,308 >> Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
wandb: Currently logged in as: daniel-kovalenko (dberezin-SoftPear). Use `wandb login --relogin` to force relogin
[2024-07-26 15:28:20,127] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:20,158] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:20,163] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/danielko/src/softpear-rnd/generation/video/data/auto_captioning/InternVL/internvl_chat/wandb/run-20240726_152820-lv9k3lr8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt
wandb: ⭐️ View project at https://wandb.ai/dberezin-SoftPear/huggingface
wandb: 🚀 View run at https://wandb.ai/dberezin-SoftPear/huggingface/runs/lv9k3lr8
  0%|          | 0/200 [00:00<?, ?it/s][2024-07-26 15:28:24,227] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:24,558] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:24,617] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:24,647] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:28,113] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:29,025] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:29,198] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:29,201] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:31,769] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:33,032] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:33,333] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:33,394] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:28:35,354] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2643
[2024-07-26 15:28:42,668] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1917.35 | backward_microstep: 2019.01 | backward_inner_microstep: 2001.57 | backward_allreduce_microstep: 17.34 | step_microstep: 0.04
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2545
[2024-07-26 15:28:49,904] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3579879680
[2024-07-26 15:28:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:28:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 110, numel = 7994508288
[2024-07-26 15:28:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:28:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:28:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 112, numel = 6737661952
[2024-07-26 15:28:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 110, numel = 7994508288
[2024-07-26 15:28:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 112, numel = 6737661952
[2024-07-26 15:28:50,107] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 765.59 | forward_fetch_submit: 72.32 | forward_all_gather: 282.17 | backward_fetch_wait: 82.04 | backward_fetch_submit: 32.08 | backward_all_gather: 220.51 | forward_prefetch_submit: 33.17 | backward_prefetch_wait: 21.45
[2024-07-26 15:28:50,428] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 6.61
[2024-07-26 15:28:50,430] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 2310.00 | backward_microstep: 5231.67 | backward_inner_microstep: 5102.09 | backward_allreduce_microstep: 129.51 | step_microstep: 192.68
[2024-07-26 15:28:50,430] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 4227.34 | backward: 7250.68 | backward_inner: 7103.69 | backward_allreduce: 146.86 | step: 192.73
  0%|          | 1/200 [00:27<1:31:06, 27.47s/it]                                                 {'loss': 2.6003, 'grad_norm': 1.7576381907208596, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.02}
  0%|          | 1/200 [00:27<1:31:06, 27.47s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2569
[2024-07-26 15:28:52,712] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:28:52,713] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:28:52,713] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:28:52,713] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:28:52,713] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:28:52,713] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:28:52,713] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:28:52,713] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:28:52,792] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.11 | forward_fetch_submit: 0.06 | forward_all_gather: 32.82 | backward_fetch_wait: 5.67 | backward_fetch_submit: 0.00 | backward_all_gather: 25.27 | forward_prefetch_submit: 1.71 | backward_prefetch_wait: 0.25
[2024-07-26 15:28:52,816] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 783.12 | backward_microstep: 1564.35 | backward_inner_microstep: 1541.72 | backward_allreduce_microstep: 22.55 | step_microstep: 0.04
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2511
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:28:54,999] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:28:55,073] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.71 | forward_fetch_submit: 0.03 | forward_all_gather: 24.25 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 124.28 | forward_prefetch_submit: 1.27 | backward_prefetch_wait: 0.30
[2024-07-26 15:28:55,189] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.52
[2024-07-26 15:28:55,190] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.28 | backward_microstep: 1503.02 | backward_inner_microstep: 1485.56 | backward_allreduce_microstep: 17.40 | step_microstep: 99.58
[2024-07-26 15:28:55,191] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1529.38 | backward: 3067.37 | backward_inner: 3027.30 | backward_allreduce: 39.95 | step: 99.63
  1%|          | 2/200 [00:32<46:32, 14.11s/it]                                                 {'loss': 2.609, 'grad_norm': 1.9744689882713404, 'learning_rate': 6.666666666666667e-06, 'epoch': 0.05}
  1%|          | 2/200 [00:32<46:32, 14.11s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2579
[2024-07-26 15:28:57,437] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:28:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:28:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:28:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:28:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:28:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:28:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:28:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:28:57,510] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.95 | forward_fetch_submit: 0.06 | forward_all_gather: 34.67 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 21.31 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.26
[2024-07-26 15:28:57,530] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 778.19 | backward_microstep: 1531.77 | backward_inner_microstep: 1512.31 | backward_allreduce_microstep: 19.38 | step_microstep: 0.11
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2556
[2024-07-26 15:29:00,158] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:00,159] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:00,159] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:00,159] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:00,159] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:00,159] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:00,159] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:00,159] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:00,232] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.55 | forward_fetch_submit: 0.03 | forward_all_gather: 25.63 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 116.80 | forward_prefetch_submit: 1.08 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:00,351] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.52
[2024-07-26 15:29:00,353] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.77 | backward_microstep: 1927.63 | backward_inner_microstep: 1909.41 | backward_allreduce_microstep: 18.16 | step_microstep: 101.34
[2024-07-26 15:29:00,353] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1545.94 | backward: 3459.41 | backward_inner: 3421.74 | backward_allreduce: 37.54 | step: 101.45
  2%|▏         | 3/200 [00:37<32:54, 10.02s/it]                                               {'loss': 2.5358, 'grad_norm': 1.655617233405909, 'learning_rate': 1e-05, 'epoch': 0.07}
  2%|▏         | 3/200 [00:37<32:54, 10.02s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2542
[2024-07-26 15:29:02,691] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:02,692] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:02,693] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:02,693] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:02,693] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:02,693] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:02,693] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:02,693] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:02,768] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 38.03 | forward_fetch_submit: 0.06 | forward_all_gather: 33.94 | backward_fetch_wait: 6.05 | backward_fetch_submit: 0.00 | backward_all_gather: 22.94 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.25
[2024-07-26 15:29:02,804] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 783.22 | backward_microstep: 1635.30 | backward_inner_microstep: 1601.03 | backward_allreduce_microstep: 34.12 | step_microstep: 0.24
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2500
[2024-07-26 15:29:05,053] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:05,122] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.17 | forward_fetch_submit: 0.03 | forward_all_gather: 26.14 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 109.72 | forward_prefetch_submit: 1.27 | backward_prefetch_wait: 0.31
[2024-07-26 15:29:05,246] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.72
[2024-07-26 15:29:05,247] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.96 | backward_microstep: 1546.60 | backward_inner_microstep: 1527.82 | backward_allreduce_microstep: 18.72 | step_microstep: 105.45
[2024-07-26 15:29:05,248] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1543.16 | backward: 3181.90 | backward_inner: 3128.85 | backward_allreduce: 52.85 | step: 105.70
  2%|▏         | 4/200 [00:42<26:07,  8.00s/it]                                               {'loss': 2.5195, 'grad_norm': 1.8334795046587018, 'learning_rate': 1.3333333333333333e-05, 'epoch': 0.1}
  2%|▏         | 4/200 [00:42<26:07,  8.00s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2558
[2024-07-26 15:29:07,501] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:07,502] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:07,502] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:07,502] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:07,502] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:07,502] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:07,502] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:07,502] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:07,569] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.46 | forward_fetch_submit: 0.06 | forward_all_gather: 31.88 | backward_fetch_wait: 5.69 | backward_fetch_submit: 0.00 | backward_all_gather: 22.45 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.25
[2024-07-26 15:29:07,604] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.27 | backward_microstep: 1562.27 | backward_inner_microstep: 1528.74 | backward_allreduce_microstep: 33.41 | step_microstep: 0.62
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2584
[2024-07-26 15:29:09,852] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:09,853] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:09,853] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:09,853] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:09,853] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:09,853] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:09,853] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:09,853] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:09,923] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.92 | forward_fetch_submit: 0.03 | forward_all_gather: 24.66 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 126.32 | forward_prefetch_submit: 1.06 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:10,043] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.62
[2024-07-26 15:29:10,044] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.78 | backward_microstep: 1537.69 | backward_inner_microstep: 1519.66 | backward_allreduce_microstep: 17.97 | step_microstep: 102.98
[2024-07-26 15:29:10,045] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1540.03 | backward: 3099.96 | backward_inner: 3048.41 | backward_allreduce: 51.39 | step: 103.60
  2%|▎         | 5/200 [00:47<22:14,  6.84s/it]                                               {'loss': 2.5556, 'grad_norm': 1.6928345855290758, 'learning_rate': 1.6666666666666667e-05, 'epoch': 0.12}
  2%|▎         | 5/200 [00:47<22:14,  6.84s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2599
[2024-07-26 15:29:12,314] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:12,314] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:12,315] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:12,315] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:12,315] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:12,315] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:12,315] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:12,315] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:12,386] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.78 | forward_fetch_submit: 0.06 | forward_all_gather: 31.61 | backward_fetch_wait: 5.69 | backward_fetch_submit: 0.00 | backward_all_gather: 20.35 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:29:12,405] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.84 | backward_microstep: 1561.79 | backward_inner_microstep: 1543.57 | backward_allreduce_microstep: 18.14 | step_microstep: 0.18
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2504
[2024-07-26 15:29:14,601] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:14,601] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:14,602] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:14,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:14,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:14,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:14,602] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:14,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:14,672] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.54 | forward_fetch_submit: 0.03 | forward_all_gather: 22.00 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 127.55 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:14,813] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.52
[2024-07-26 15:29:14,814] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 751.14 | backward_microstep: 1523.27 | backward_inner_microstep: 1493.47 | backward_allreduce_microstep: 29.75 | step_microstep: 111.73
[2024-07-26 15:29:14,814] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1521.95 | backward: 3085.06 | backward_inner: 3037.05 | backward_allreduce: 47.89 | step: 111.92
  3%|▎         | 6/200 [00:51<19:50,  6.14s/it]                                               {'loss': 2.474, 'grad_norm': 1.7204202495487426, 'learning_rate': 2e-05, 'epoch': 0.15}
  3%|▎         | 6/200 [00:51<19:50,  6.14s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:29:17,064] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:17,065] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:17,065] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:17,065] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:17,065] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:17,065] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:17,065] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:17,065] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:17,135] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.25 | forward_fetch_submit: 0.06 | forward_all_gather: 32.31 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 25.15 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.25
[2024-07-26 15:29:17,154] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.33 | backward_microstep: 1544.74 | backward_inner_microstep: 1526.35 | backward_allreduce_microstep: 18.32 | step_microstep: 0.17
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:29:19,632] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:19,633] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:19,633] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:19,633] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:19,633] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:19,633] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:19,633] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:19,633] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:19,699] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.18 | forward_fetch_submit: 0.03 | forward_all_gather: 20.43 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 132.87 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:19,811] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.30
[2024-07-26 15:29:19,812] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.88 | backward_microstep: 1780.05 | backward_inner_microstep: 1762.80 | backward_allreduce_microstep: 17.20 | step_microstep: 95.73
[2024-07-26 15:29:19,812] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1526.19 | backward: 3324.80 | backward_inner: 3289.16 | backward_allreduce: 35.52 | step: 95.90
  4%|▎         | 7/200 [00:56<18:32,  5.77s/it]                                               {'loss': 2.4182, 'grad_norm': 1.5066617573939038, 'learning_rate': 1.9998688836656322e-05, 'epoch': 0.17}
  4%|▎         | 7/200 [00:56<18:32,  5.77s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2558
[2024-07-26 15:29:22,165] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:22,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:22,233] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 29.96 | forward_fetch_submit: 0.06 | forward_all_gather: 28.68 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 20.16 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:29:22,398] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 768.77 | backward_microstep: 1788.33 | backward_inner_microstep: 1624.18 | backward_allreduce_microstep: 164.07 | step_microstep: 0.18
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2557
[2024-07-26 15:29:24,598] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:24,599] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:24,599] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:24,599] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:24,599] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:24,599] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:24,599] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:24,599] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:24,664] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.46 | forward_fetch_submit: 0.03 | forward_all_gather: 33.66 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 129.20 | forward_prefetch_submit: 11.02 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:24,784] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:29:24,785] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.91 | backward_microstep: 1505.34 | backward_inner_microstep: 1487.52 | backward_allreduce_microstep: 17.76 | step_microstep: 102.26
[2024-07-26 15:29:24,785] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1525.67 | backward: 3293.67 | backward_inner: 3111.71 | backward_allreduce: 181.84 | step: 102.44
  4%|▍         | 8/200 [01:01<17:38,  5.51s/it]                                               {'loss': 2.4439, 'grad_norm': 1.2688680222308932, 'learning_rate': 1.9994755690455154e-05, 'epoch': 0.2}
  4%|▍         | 8/200 [01:01<17:38,  5.51s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2535
[2024-07-26 15:29:26,986] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:27,059] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.53 | forward_fetch_submit: 0.06 | forward_all_gather: 27.93 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.62 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:29:27,077] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 750.13 | backward_microstep: 1514.70 | backward_inner_microstep: 1496.69 | backward_allreduce_microstep: 17.93 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2514
[2024-07-26 15:29:29,333] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:29,334] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:29,334] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:29,334] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:29,334] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:29,334] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:29,334] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:29,334] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:29,413] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.27 | forward_fetch_submit: 0.03 | forward_all_gather: 25.70 | backward_fetch_wait: 5.49 | backward_fetch_submit: 0.00 | backward_all_gather: 133.41 | forward_prefetch_submit: 0.99 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:29,543] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.22
[2024-07-26 15:29:29,544] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 773.43 | backward_microstep: 1570.75 | backward_inner_microstep: 1540.01 | backward_allreduce_microstep: 30.68 | step_microstep: 100.38
[2024-07-26 15:29:29,545] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1523.54 | backward: 3085.45 | backward_inner: 3036.71 | backward_allreduce: 48.62 | step: 100.47
  4%|▍         | 9/200 [01:06<16:47,  5.28s/it]                                               {'loss': 2.3554, 'grad_norm': 1.6469233739979054, 'learning_rate': 1.998820159279591e-05, 'epoch': 0.22}
  4%|▍         | 9/200 [01:06<16:47,  5.28s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:29:31,795] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:31,874] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.26 | forward_fetch_submit: 0.06 | forward_all_gather: 34.16 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 20.06 | forward_prefetch_submit: 0.71 | backward_prefetch_wait: 0.25
[2024-07-26 15:29:31,892] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.63 | backward_microstep: 1545.43 | backward_inner_microstep: 1527.43 | backward_allreduce_microstep: 17.91 | step_microstep: 0.18
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2513
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:34,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:34,202] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 29.64 | forward_fetch_submit: 0.03 | forward_all_gather: 26.09 | backward_fetch_wait: 5.53 | backward_fetch_submit: 0.00 | backward_all_gather: 132.36 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:34,380] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.60
[2024-07-26 15:29:34,381] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.82 | backward_microstep: 1581.63 | backward_inner_microstep: 1521.89 | backward_allreduce_microstep: 59.68 | step_microstep: 119.32
[2024-07-26 15:29:34,381] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1540.43 | backward: 3127.06 | backward_inner: 3049.34 | backward_allreduce: 77.60 | step: 119.51
  5%|▌         | 10/200 [01:11<16:16,  5.14s/it]                                                {'loss': 2.2917, 'grad_norm': 1.0976536813632636, 'learning_rate': 1.997902826237712e-05, 'epoch': 0.25}
  5%|▌         | 10/200 [01:11<16:16,  5.14s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2589
[2024-07-26 15:29:36,631] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:36,632] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:36,632] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:36,632] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:36,632] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:36,632] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:36,632] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:36,632] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:36,709] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.17 | forward_fetch_submit: 0.06 | forward_all_gather: 31.13 | backward_fetch_wait: 5.65 | backward_fetch_submit: 0.00 | backward_all_gather: 19.92 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:29:36,730] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.64 | backward_microstep: 1546.17 | backward_inner_microstep: 1525.52 | backward_allreduce_microstep: 20.56 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2570
[2024-07-26 15:29:38,969] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:38,970] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:38,970] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:38,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:38,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:38,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:38,970] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:38,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:39,047] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.45 | forward_fetch_submit: 0.03 | forward_all_gather: 21.43 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 133.66 | forward_prefetch_submit: 0.92 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:39,163] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.46
[2024-07-26 15:29:39,165] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 773.95 | backward_microstep: 1538.52 | backward_inner_microstep: 1520.06 | backward_allreduce_microstep: 18.40 | step_microstep: 98.77
[2024-07-26 15:29:39,165] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1540.58 | backward: 3084.69 | backward_inner: 3045.60 | backward_allreduce: 38.97 | step: 98.87
  6%|▌         | 11/200 [01:16<15:51,  5.03s/it]                                                {'loss': 2.1957, 'grad_norm': 0.9160008950218731, 'learning_rate': 1.9967238104745695e-05, 'epoch': 0.27}
  6%|▌         | 11/200 [01:16<15:51,  5.03s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2560
[2024-07-26 15:29:41,572] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:41,572] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:41,652] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.99 | forward_fetch_submit: 0.06 | forward_all_gather: 28.53 | backward_fetch_wait: 5.66 | backward_fetch_submit: 0.00 | backward_all_gather: 17.10 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:29:41,915] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.40 | backward_microstep: 1966.75 | backward_inner_microstep: 1703.74 | backward_allreduce_microstep: 262.93 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2547
[2024-07-26 15:29:44,620] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:44,620] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:44,620] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:44,620] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:44,620] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:44,620] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:44,621] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:44,621] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:44,695] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 146.35 | forward_fetch_submit: 0.03 | forward_all_gather: 24.84 | backward_fetch_wait: 5.53 | backward_fetch_submit: 0.00 | backward_all_gather: 120.02 | forward_prefetch_submit: 1.00 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:44,992] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 6.08
[2024-07-26 15:29:44,994] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 892.49 | backward_microstep: 2054.46 | backward_inner_microstep: 1865.45 | backward_allreduce_microstep: 188.95 | step_microstep: 109.00
[2024-07-26 15:29:44,994] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1649.88 | backward: 4021.21 | backward_inner: 3569.20 | backward_allreduce: 451.89 | step: 109.08
  6%|▌         | 12/200 [01:22<16:31,  5.27s/it]                                                {'loss': 2.2634, 'grad_norm': 0.9187665571300669, 'learning_rate': 1.995283421166614e-05, 'epoch': 0.3}
  6%|▌         | 12/200 [01:22<16:31,  5.27s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:29:47,226] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:47,226] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:47,226] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:47,226] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:47,226] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:47,226] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:47,227] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:47,227] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:47,306] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.54 | forward_fetch_submit: 0.06 | forward_all_gather: 31.51 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.37 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:29:47,324] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.76 | backward_microstep: 1538.63 | backward_inner_microstep: 1521.20 | backward_allreduce_microstep: 17.36 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2675
[2024-07-26 15:29:49,624] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:49,624] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:49,624] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:49,624] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:49,624] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:49,624] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:49,624] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:49,625] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:49,704] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.55 | forward_fetch_submit: 0.03 | forward_all_gather: 23.41 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 109.34 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:49,819] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:29:49,820] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 796.49 | backward_microstep: 1579.70 | backward_inner_microstep: 1561.99 | backward_allreduce_microstep: 17.65 | step_microstep: 98.44
[2024-07-26 15:29:49,821] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1561.23 | backward: 3118.33 | backward_inner: 3083.21 | backward_allreduce: 35.01 | step: 98.52
  6%|▋         | 13/200 [01:26<16:00,  5.14s/it]                                                {'loss': 2.2039, 'grad_norm': 0.9593357522847277, 'learning_rate': 1.993582036030978e-05, 'epoch': 0.32}
  6%|▋         | 13/200 [01:26<16:00,  5.14s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2610
[2024-07-26 15:29:52,514] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:52,514] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:52,515] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:52,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:52,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:52,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:52,515] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:52,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:52,594] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 283.74 | forward_fetch_submit: 0.06 | forward_all_gather: 30.30 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.75 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:29:52,814] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 837.06 | backward_microstep: 2128.14 | backward_inner_microstep: 1908.09 | backward_allreduce_microstep: 219.97 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2544
[2024-07-26 15:29:55,026] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:55,103] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.31 | forward_fetch_submit: 0.03 | forward_all_gather: 19.87 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 132.19 | forward_prefetch_submit: 0.94 | backward_prefetch_wait: 0.30
[2024-07-26 15:29:55,230] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.60
[2024-07-26 15:29:55,231] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.83 | backward_microstep: 1519.99 | backward_inner_microstep: 1503.04 | backward_allreduce_microstep: 16.89 | step_microstep: 110.87
[2024-07-26 15:29:55,232] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1600.87 | backward: 3648.13 | backward_inner: 3411.15 | backward_allreduce: 236.86 | step: 110.96
  7%|▋         | 14/200 [01:32<16:11,  5.22s/it]                                                {'loss': 2.2892, 'grad_norm': 0.9432993927801496, 'learning_rate': 1.9916201012264255e-05, 'epoch': 0.35}
  7%|▋         | 14/200 [01:32<16:11,  5.22s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2555
[2024-07-26 15:29:57,499] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:29:57,500] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:29:57,501] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:29:57,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:57,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:57,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:29:57,501] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:29:57,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:29:57,576] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 31.32 | forward_fetch_submit: 0.06 | forward_all_gather: 32.47 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 16.66 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:29:57,608] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 773.98 | backward_microstep: 1571.49 | backward_inner_microstep: 1539.89 | backward_allreduce_microstep: 31.52 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2544
[2024-07-26 15:29:59,832] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:29:59,833] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:29:59,833] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:29:59,833] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:29:59,833] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:29:59,833] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:29:59,833] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:29:59,833] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:29:59,909] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.75 | forward_fetch_submit: 0.03 | forward_all_gather: 22.61 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 134.50 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:00,036] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.54
[2024-07-26 15:30:00,038] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.26 | backward_microstep: 1526.79 | backward_inner_microstep: 1509.16 | backward_allreduce_microstep: 17.57 | step_microstep: 110.52
[2024-07-26 15:30:00,038] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1545.22 | backward: 3098.28 | backward_inner: 3049.07 | backward_allreduce: 49.10 | step: 110.61
  8%|▊         | 15/200 [01:37<15:42,  5.10s/it]                                                {'loss': 2.1606, 'grad_norm': 0.9756957861493475, 'learning_rate': 1.9893981312363563e-05, 'epoch': 0.37}
  8%|▊         | 15/200 [01:37<15:42,  5.10s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2534
[2024-07-26 15:30:02,475] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:02,476] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:02,476] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:02,476] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:02,476] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:02,476] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:02,476] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:02,476] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:02,556] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 26.98 | forward_fetch_submit: 0.06 | forward_all_gather: 26.80 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 17.75 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.26
[2024-07-26 15:30:02,629] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.25 | backward_microstep: 1799.06 | backward_inner_microstep: 1726.42 | backward_allreduce_microstep: 72.57 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:30:04,841] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:04,842] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:04,842] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:04,842] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:04,842] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:04,842] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:04,842] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:04,842] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:04,913] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.30 | forward_fetch_submit: 0.03 | forward_all_gather: 20.39 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 129.49 | forward_prefetch_submit: 0.96 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:05,058] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.84
[2024-07-26 15:30:05,060] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.48 | backward_microstep: 1531.02 | backward_inner_microstep: 1500.03 | backward_allreduce_microstep: 30.93 | step_microstep: 115.57
[2024-07-26 15:30:05,060] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1525.71 | backward: 3330.08 | backward_inner: 3226.46 | backward_allreduce: 103.50 | step: 115.66
  8%|▊         | 16/200 [01:42<15:33,  5.07s/it]                                                {'loss': 2.1738, 'grad_norm': 0.8399879761308612, 'learning_rate': 1.9869167087338908e-05, 'epoch': 0.4}
  8%|▊         | 16/200 [01:42<15:33,  5.07s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2582
[2024-07-26 15:30:07,309] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:07,310] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:07,310] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:07,310] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:07,310] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:07,310] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:07,310] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:07,310] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:07,389] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.98 | forward_fetch_submit: 0.06 | forward_all_gather: 32.52 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.45 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:07,407] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.31 | backward_microstep: 1545.10 | backward_inner_microstep: 1527.60 | backward_allreduce_microstep: 17.42 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2541
[2024-07-26 15:30:09,617] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:09,617] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:09,618] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:09,618] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:09,618] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:09,618] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:09,618] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:09,618] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:09,693] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.75 | forward_fetch_submit: 0.03 | forward_all_gather: 18.94 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.79 | forward_prefetch_submit: 0.98 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:09,809] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.17
[2024-07-26 15:30:09,811] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 751.20 | backward_microstep: 1530.42 | backward_inner_microstep: 1513.52 | backward_allreduce_microstep: 16.84 | step_microstep: 100.00
[2024-07-26 15:30:09,811] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1525.48 | backward: 3075.52 | backward_inner: 3041.14 | backward_allreduce: 34.27 | step: 100.08
  8%|▊         | 17/200 [01:46<15:10,  4.98s/it]                                                {'loss': 2.2488, 'grad_norm': 0.8809800982295546, 'learning_rate': 1.9841764844290744e-05, 'epoch': 0.42}
  8%|▊         | 17/200 [01:46<15:10,  4.98s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2562
[2024-07-26 15:30:12,061] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:12,062] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:12,062] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:12,062] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:12,062] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:12,062] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:12,062] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:12,062] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:12,138] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.88 | forward_fetch_submit: 0.07 | forward_all_gather: 34.17 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.61 | forward_prefetch_submit: 2.58 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:12,156] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 768.90 | backward_microstep: 1544.70 | backward_inner_microstep: 1526.77 | backward_allreduce_microstep: 17.85 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2569
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:14,382] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:14,460] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.74 | forward_fetch_submit: 0.03 | forward_all_gather: 19.85 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 131.29 | forward_prefetch_submit: 0.98 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:14,571] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.16
[2024-07-26 15:30:14,573] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.08 | backward_microstep: 1537.30 | backward_inner_microstep: 1520.60 | backward_allreduce_microstep: 16.65 | step_microstep: 95.26
[2024-07-26 15:30:14,573] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1530.95 | backward: 3082.00 | backward_inner: 3047.39 | backward_allreduce: 34.51 | step: 95.35
  9%|▉         | 18/200 [01:51<14:53,  4.91s/it]                                                {'loss': 2.2366, 'grad_norm': 1.5495083785147872, 'learning_rate': 1.9811781768982392e-05, 'epoch': 0.44}
  9%|▉         | 18/200 [01:51<14:53,  4.91s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2568
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:16,795] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:16,861] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.44 | forward_fetch_submit: 0.06 | forward_all_gather: 31.78 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.58 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:16,891] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.31 | backward_microstep: 1529.63 | backward_inner_microstep: 1500.18 | backward_allreduce_microstep: 29.38 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2517
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:19,188] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.94 | forward_fetch_submit: 0.03 | forward_all_gather: 21.83 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 134.12 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:19,305] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.18
[2024-07-26 15:30:19,306] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.22 | backward_microstep: 1520.61 | backward_inner_microstep: 1504.09 | backward_allreduce_microstep: 16.46 | step_microstep: 100.55
[2024-07-26 15:30:19,306] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1534.51 | backward: 3050.24 | backward_inner: 3004.29 | backward_allreduce: 45.85 | step: 100.63
 10%|▉         | 19/200 [01:56<14:39,  4.86s/it]                                                {'loss': 2.168, 'grad_norm': 0.9736890506059267, 'learning_rate': 1.977922572395571e-05, 'epoch': 0.47}
 10%|▉         | 19/200 [01:56<14:39,  4.86s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2562
[2024-07-26 15:30:21,539] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:21,540] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:21,540] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:21,540] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:21,540] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:21,540] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:21,540] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:21,540] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:21,619] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.92 | forward_fetch_submit: 0.06 | forward_all_gather: 31.44 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 19.80 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:21,638] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.00 | backward_microstep: 1538.28 | backward_inner_microstep: 1519.90 | backward_allreduce_microstep: 18.30 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:30:24,476] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:24,477] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:24,477] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:24,477] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:24,477] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:24,477] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:24,479] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:24,479] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:24,554] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 365.85 | forward_fetch_submit: 0.03 | forward_all_gather: 23.01 | backward_fetch_wait: 5.66 | backward_fetch_submit: 0.00 | backward_all_gather: 33.08 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:24,670] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:30:24,672] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 851.39 | backward_microstep: 2059.80 | backward_inner_microstep: 2041.92 | backward_allreduce_microstep: 17.83 | step_microstep: 99.15
[2024-07-26 15:30:24,672] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1617.37 | backward: 3598.08 | backward_inner: 3561.84 | backward_allreduce: 36.13 | step: 99.24
 10%|█         | 20/200 [02:01<15:01,  5.01s/it]                                                {'loss': 2.0061, 'grad_norm': 0.7549355313253968, 'learning_rate': 1.9744105246469264e-05, 'epoch': 0.49}
 10%|█         | 20/200 [02:01<15:01,  5.01s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2572
[2024-07-26 15:30:26,900] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:26,900] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:26,901] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:26,901] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:26,901] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:26,901] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:26,901] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:26,901] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.53 | forward_fetch_submit: 0.06 | forward_all_gather: 30.86 | backward_fetch_wait: 5.66 | backward_fetch_submit: 0.00 | backward_all_gather: 19.05 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:27,006] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.71 | backward_microstep: 1546.32 | backward_inner_microstep: 1527.72 | backward_allreduce_microstep: 18.52 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2528
[2024-07-26 15:30:29,239] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:29,240] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:29,240] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:29,240] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:29,240] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:29,240] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:29,240] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:29,240] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:29,318] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.13 | forward_fetch_submit: 0.03 | forward_all_gather: 23.95 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 136.60 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:29,451] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.17
[2024-07-26 15:30:29,452] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.62 | backward_microstep: 1556.44 | backward_inner_microstep: 1528.13 | backward_allreduce_microstep: 28.26 | step_microstep: 105.36
[2024-07-26 15:30:29,452] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1523.31 | backward: 3102.76 | backward_inner: 3055.87 | backward_allreduce: 46.79 | step: 105.45
 10%|█         | 21/200 [02:06<14:44,  4.94s/it]                                                {'loss': 2.0612, 'grad_norm': 0.9238639502726809, 'learning_rate': 1.9706429546259592e-05, 'epoch': 0.52}
 10%|█         | 21/200 [02:06<14:44,  4.94s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2616
[2024-07-26 15:30:31,719] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:31,720] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:31,720] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:31,720] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:31,720] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:31,720] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:31,720] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:31,720] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:31,796] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.30 | forward_fetch_submit: 0.06 | forward_all_gather: 31.31 | backward_fetch_wait: 5.66 | backward_fetch_submit: 0.00 | backward_all_gather: 20.06 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:31,815] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.75 | backward_microstep: 1556.98 | backward_inner_microstep: 1539.31 | backward_allreduce_microstep: 17.59 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2552
[2024-07-26 15:30:34,037] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:34,037] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:34,037] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:34,037] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:34,037] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:34,038] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:34,038] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:34,038] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:34,114] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.76 | forward_fetch_submit: 0.03 | forward_all_gather: 21.39 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 141.41 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:34,233] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:30:34,235] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.86 | backward_microstep: 1537.31 | backward_inner_microstep: 1519.14 | backward_allreduce_microstep: 18.11 | step_microstep: 101.37
[2024-07-26 15:30:34,235] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1536.59 | backward: 3094.29 | backward_inner: 3058.47 | backward_allreduce: 35.70 | step: 101.44
 11%|█         | 22/200 [02:11<14:31,  4.89s/it]                                                {'loss': 2.1738, 'grad_norm': 0.9233219180829814, 'learning_rate': 1.9666208503126115e-05, 'epoch': 0.54}
 11%|█         | 22/200 [02:11<14:31,  4.89s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2536
[2024-07-26 15:30:36,452] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:36,452] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:36,453] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:36,453] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:36,453] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:36,453] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:36,453] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:36,453] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:36,532] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.99 | forward_fetch_submit: 0.06 | forward_all_gather: 28.30 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.27 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:36,550] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.23 | backward_microstep: 1532.65 | backward_inner_microstep: 1515.35 | backward_allreduce_microstep: 17.23 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2502
[2024-07-26 15:30:38,750] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:38,751] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:38,751] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:38,751] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:38,751] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:38,751] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:38,751] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:38,751] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:38,827] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.83 | forward_fetch_submit: 0.03 | forward_all_gather: 21.35 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 133.46 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:38,948] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.49
[2024-07-26 15:30:38,949] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 748.80 | backward_microstep: 1524.29 | backward_inner_microstep: 1506.36 | backward_allreduce_microstep: 17.88 | step_microstep: 103.80
[2024-07-26 15:30:38,949] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1505.01 | backward: 3056.95 | backward_inner: 3021.72 | backward_allreduce: 35.11 | step: 103.88
 12%|█▏        | 23/200 [02:15<14:16,  4.84s/it]                                                {'loss': 2.1107, 'grad_norm': 0.9569594894945124, 'learning_rate': 1.9623452664340305e-05, 'epoch': 0.57}
 12%|█▏        | 23/200 [02:15<14:16,  4.84s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2660
[2024-07-26 15:30:41,248] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:41,249] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:41,249] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:41,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:41,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:41,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:41,249] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:41,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:41,323] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.18 | forward_fetch_submit: 0.06 | forward_all_gather: 32.59 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.75 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:41,341] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 784.38 | backward_microstep: 1577.11 | backward_inner_microstep: 1559.27 | backward_allreduce_microstep: 17.77 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2535
[2024-07-26 15:30:43,867] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:43,868] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:43,868] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:43,868] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:43,868] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:43,868] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:43,868] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:43,868] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:43,933] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.71 | forward_fetch_submit: 0.03 | forward_all_gather: 22.28 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 110.65 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:44,087] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:30:44,088] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 747.38 | backward_microstep: 1872.19 | backward_inner_microstep: 1823.09 | backward_allreduce_microstep: 49.04 | step_microstep: 105.54
[2024-07-26 15:30:44,089] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1531.73 | backward: 3449.30 | backward_inner: 3382.38 | backward_allreduce: 66.81 | step: 105.62
 12%|█▏        | 24/200 [02:21<14:27,  4.93s/it]                                                {'loss': 2.1341, 'grad_norm': 1.0367911150258808, 'learning_rate': 1.957817324187987e-05, 'epoch': 0.59}
 12%|█▏        | 24/200 [02:21<14:27,  4.93s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2553
[2024-07-26 15:30:46,290] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:46,368] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.39 | forward_fetch_submit: 0.06 | forward_all_gather: 27.43 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.47 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:30:46,396] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.56 | backward_microstep: 1528.82 | backward_inner_microstep: 1501.54 | backward_allreduce_microstep: 27.21 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2559
[2024-07-26 15:30:48,670] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:48,671] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:48,671] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:48,671] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:48,671] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:48,671] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:48,671] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:48,671] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:48,749] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 31.93 | forward_fetch_submit: 0.03 | forward_all_gather: 24.16 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.69 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:48,879] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.55
[2024-07-26 15:30:48,881] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 778.85 | backward_microstep: 1575.98 | backward_inner_microstep: 1553.28 | backward_allreduce_microstep: 22.65 | step_microstep: 108.08
[2024-07-26 15:30:48,881] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1528.39 | backward: 3104.80 | backward_inner: 3054.83 | backward_allreduce: 49.86 | step: 108.16
 12%|█▎        | 25/200 [02:25<14:15,  4.89s/it]                                                {'loss': 2.0984, 'grad_norm': 0.9007060629062469, 'learning_rate': 1.953038210948861e-05, 'epoch': 0.62}
 12%|█▎        | 25/200 [02:25<14:15,  4.89s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2634
[2024-07-26 15:30:51,154] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:51,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:51,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:51,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:51,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:51,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:51,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:51,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:51,229] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.32 | forward_fetch_submit: 0.06 | forward_all_gather: 31.07 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.31 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:51,247] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 773.54 | backward_microstep: 1565.14 | backward_inner_microstep: 1547.95 | backward_allreduce_microstep: 17.11 | step_microstep: 0.09
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2535
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:53,434] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:53,504] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.31 | forward_fetch_submit: 0.03 | forward_all_gather: 22.28 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 137.31 | forward_prefetch_submit: 0.99 | backward_prefetch_wait: 0.30
[2024-07-26 15:30:53,659] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.59
[2024-07-26 15:30:53,661] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.84 | backward_microstep: 1513.94 | backward_inner_microstep: 1478.25 | backward_allreduce_microstep: 35.64 | step_microstep: 120.70
[2024-07-26 15:30:53,661] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1530.36 | backward: 3079.09 | backward_inner: 3026.22 | backward_allreduce: 52.76 | step: 120.80
 13%|█▎        | 26/200 [02:30<14:04,  4.86s/it]                                                {'loss': 1.9888, 'grad_norm': 0.8068945519147025, 'learning_rate': 1.9480091799562706e-05, 'epoch': 0.64}
 13%|█▎        | 26/200 [02:30<14:04,  4.86s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2537
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:30:55,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:30:55,982] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 26.74 | forward_fetch_submit: 0.06 | forward_all_gather: 28.50 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 16.32 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.25
[2024-07-26 15:30:56,006] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.84 | backward_microstep: 1546.10 | backward_inner_microstep: 1522.72 | backward_allreduce_microstep: 23.29 | step_microstep: 0.17
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2501
[2024-07-26 15:30:58,247] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:30:58,247] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:30:58,247] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:30:58,247] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:30:58,247] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:30:58,248] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:30:58,248] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:30:58,248] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:30:58,327] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.29 | forward_fetch_submit: 0.03 | forward_all_gather: 22.72 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 135.50 | forward_prefetch_submit: 1.04 | backward_prefetch_wait: 0.31
[2024-07-26 15:30:58,474] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.41
[2024-07-26 15:30:58,476] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 779.22 | backward_microstep: 1549.07 | backward_inner_microstep: 1519.02 | backward_allreduce_microstep: 29.99 | step_microstep: 117.88
[2024-07-26 15:30:58,476] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1545.04 | backward: 3095.18 | backward_inner: 3041.77 | backward_allreduce: 53.29 | step: 118.06
 14%|█▎        | 27/200 [02:35<13:57,  4.84s/it]                                                {'loss': 2.1355, 'grad_norm': 0.9655221963691895, 'learning_rate': 1.9427315499864345e-05, 'epoch': 0.67}
 14%|█▎        | 27/200 [02:35<13:57,  4.84s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2600
[2024-07-26 15:31:00,747] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:00,748] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:00,748] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:00,748] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:00,748] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:00,748] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:00,748] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:00,748] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:00,827] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.91 | forward_fetch_submit: 0.06 | forward_all_gather: 32.22 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.84 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:00,846] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 778.01 | backward_microstep: 1555.53 | backward_inner_microstep: 1537.49 | backward_allreduce_microstep: 17.96 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2572
[2024-07-26 15:31:03,085] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:03,085] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:03,086] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:03,086] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:03,086] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:03,086] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:03,086] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:03,086] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:03,166] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.00 | forward_fetch_submit: 0.03 | forward_all_gather: 21.83 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 143.79 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:03,495] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.39
[2024-07-26 15:31:03,497] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 768.79 | backward_microstep: 1754.05 | backward_inner_microstep: 1528.63 | backward_allreduce_microstep: 225.35 | step_microstep: 104.69
[2024-07-26 15:31:03,497] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1546.78 | backward: 3309.58 | backward_inner: 3066.14 | backward_allreduce: 243.32 | step: 104.79
 14%|█▍        | 28/200 [02:40<14:02,  4.90s/it]                                                {'loss': 2.0549, 'grad_norm': 0.897157938852431, 'learning_rate': 1.937206705006344e-05, 'epoch': 0.69}
 14%|█▍        | 28/200 [02:40<14:02,  4.90s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2628
[2024-07-26 15:31:05,967] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:05,968] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:05,968] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:05,968] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:05,968] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:05,968] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:05,968] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:05,968] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:06,042] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.99 | forward_fetch_submit: 0.06 | forward_all_gather: 32.53 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.60 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:06,060] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.21 | backward_microstep: 1761.37 | backward_inner_microstep: 1743.58 | backward_allreduce_microstep: 17.70 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2526
[2024-07-26 15:31:08,262] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:08,263] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:08,263] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:08,263] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:08,263] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:08,263] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:08,263] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:08,263] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:08,343] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.64 | forward_fetch_submit: 0.03 | forward_all_gather: 20.93 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 134.33 | forward_prefetch_submit: 0.78 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:08,455] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.31
[2024-07-26 15:31:08,456] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.74 | backward_microstep: 1531.19 | backward_inner_microstep: 1513.70 | backward_allreduce_microstep: 17.43 | step_microstep: 95.90
[2024-07-26 15:31:08,457] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1522.93 | backward: 3292.55 | backward_inner: 3257.29 | backward_allreduce: 35.14 | step: 95.98
 14%|█▍        | 29/200 [02:45<14:00,  4.92s/it]                                                {'loss': 2.115, 'grad_norm': 0.919194936784636, 'learning_rate': 1.9314360938108427e-05, 'epoch': 0.72}
 14%|█▍        | 29/200 [02:45<14:00,  4.92s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2553
[2024-07-26 15:31:10,661] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:10,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:10,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:10,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:10,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:10,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:10,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:10,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:10,737] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.59 | forward_fetch_submit: 0.06 | forward_all_gather: 27.77 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 16.61 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:10,755] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.85 | backward_microstep: 1518.25 | backward_inner_microstep: 1500.71 | backward_allreduce_microstep: 17.46 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2540
[2024-07-26 15:31:12,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:12,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:12,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:12,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:12,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:12,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:12,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:12,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:13,059] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.43 | forward_fetch_submit: 0.03 | forward_all_gather: 20.67 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 133.25 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:13,173] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.35
[2024-07-26 15:31:13,174] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.22 | backward_microstep: 1545.54 | backward_inner_microstep: 1528.17 | backward_allreduce_microstep: 17.32 | step_microstep: 97.48
[2024-07-26 15:31:13,175] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1507.05 | backward: 3063.80 | backward_inner: 3028.90 | backward_allreduce: 34.79 | step: 97.57
 15%|█▌        | 30/200 [02:50<13:45,  4.86s/it]                                                {'loss': 1.9296, 'grad_norm': 0.9373586951112022, 'learning_rate': 1.9254212296427043e-05, 'epoch': 0.74}
 15%|█▌        | 30/200 [02:50<13:45,  4.86s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2603
[2024-07-26 15:31:15,422] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:15,423] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:15,423] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:15,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:15,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:15,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:15,423] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:15,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:15,504] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.80 | forward_fetch_submit: 0.06 | forward_all_gather: 31.10 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.93 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:15,523] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.59 | backward_microstep: 1551.44 | backward_inner_microstep: 1533.18 | backward_allreduce_microstep: 18.19 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2514
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:17,762] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:17,842] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 27.98 | forward_fetch_submit: 0.03 | forward_all_gather: 22.56 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 132.53 | forward_prefetch_submit: 0.92 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:17,962] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:31:17,963] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.50 | backward_microstep: 1550.59 | backward_inner_microstep: 1532.98 | backward_allreduce_microstep: 17.55 | step_microstep: 103.38
[2024-07-26 15:31:17,964] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1534.07 | backward: 3102.03 | backward_inner: 3066.17 | backward_allreduce: 35.74 | step: 103.46
 16%|█▌        | 31/200 [02:54<13:37,  4.84s/it]                                                {'loss': 1.9684, 'grad_norm': 0.9725435039341499, 'learning_rate': 1.9191636897958123e-05, 'epoch': 0.77}
 16%|█▌        | 31/200 [02:54<13:37,  4.84s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2591
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:20,207] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:20,286] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.36 | forward_fetch_submit: 0.06 | forward_all_gather: 30.71 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.83 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:20,304] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.17 | backward_microstep: 1547.12 | backward_inner_microstep: 1529.73 | backward_allreduce_microstep: 17.32 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2532
[2024-07-26 15:31:22,536] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:22,537] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:22,537] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:22,537] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:22,537] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:22,537] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:22,537] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:22,537] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:22,615] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 17.31 | forward_fetch_submit: 0.03 | forward_all_gather: 21.25 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 138.55 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:22,746] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 6.04
[2024-07-26 15:31:22,747] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.42 | backward_microstep: 1544.88 | backward_inner_microstep: 1523.96 | backward_allreduce_microstep: 20.87 | step_microstep: 110.69
[2024-07-26 15:31:22,748] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1532.58 | backward: 3092.01 | backward_inner: 3053.70 | backward_allreduce: 38.19 | step: 110.78
 16%|█▌        | 32/200 [02:59<13:29,  4.82s/it]                                                {'loss': 1.9945, 'grad_norm': 1.711890367477224, 'learning_rate': 1.9126651152015404e-05, 'epoch': 0.79}
 16%|█▌        | 32/200 [02:59<13:29,  4.82s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2565
[2024-07-26 15:31:25,287] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:25,288] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:25,288] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:25,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:25,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:25,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:25,288] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:25,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:25,367] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 118.92 | forward_fetch_submit: 0.06 | forward_all_gather: 30.94 | backward_fetch_wait: 5.70 | backward_fetch_submit: 0.00 | backward_all_gather: 20.17 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:25,384] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 782.07 | backward_microstep: 1827.36 | backward_inner_microstep: 1810.16 | backward_allreduce_microstep: 17.13 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2541
[2024-07-26 15:31:27,588] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:27,588] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:27,589] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:27,589] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:27,589] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:27,589] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:27,589] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:27,589] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:27,668] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.54 | forward_fetch_submit: 0.03 | forward_all_gather: 18.82 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 45.28 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:27,780] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.16
[2024-07-26 15:31:27,781] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.33 | backward_microstep: 1518.92 | backward_inner_microstep: 1501.74 | backward_allreduce_microstep: 17.12 | step_microstep: 95.86
[2024-07-26 15:31:27,781] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1543.38 | backward: 3346.29 | backward_inner: 3311.92 | backward_allreduce: 34.26 | step: 95.94
 16%|█▋        | 33/200 [03:04<13:35,  4.88s/it]                                                {'loss': 1.9903, 'grad_norm': 0.9943006377475556, 'learning_rate': 1.905927209998447e-05, 'epoch': 0.81}
 16%|█▋        | 33/200 [03:04<13:35,  4.88s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:31:30,056] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:30,056] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:30,056] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:30,056] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:30,056] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:30,056] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:30,057] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:30,057] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:30,135] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 27.33 | forward_fetch_submit: 0.06 | forward_all_gather: 32.03 | backward_fetch_wait: 5.65 | backward_fetch_submit: 0.00 | backward_all_gather: 19.61 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:31:30,153] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 784.67 | backward_microstep: 1557.35 | backward_inner_microstep: 1539.53 | backward_allreduce_microstep: 17.75 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2515
[2024-07-26 15:31:32,357] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:32,358] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:32,358] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:32,358] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:32,358] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:32,358] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:32,358] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:32,358] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:32,437] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.58 | forward_fetch_submit: 0.03 | forward_all_gather: 20.54 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 135.63 | forward_prefetch_submit: 0.96 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:32,550] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.15
[2024-07-26 15:31:32,551] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.44 | backward_microstep: 1525.06 | backward_inner_microstep: 1508.42 | backward_allreduce_microstep: 16.58 | step_microstep: 97.04
[2024-07-26 15:31:32,551] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1538.09 | backward: 3082.41 | backward_inner: 3047.97 | backward_allreduce: 34.34 | step: 97.13
 17%|█▋        | 34/200 [03:09<13:25,  4.85s/it]                                                {'loss': 1.9531, 'grad_norm': 1.032569877669501, 'learning_rate': 1.8989517410853956e-05, 'epoch': 0.84}
 17%|█▋        | 34/200 [03:09<13:25,  4.85s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2561
[2024-07-26 15:31:34,810] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:34,811] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:34,811] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:34,811] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:34,811] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:34,811] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:34,811] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:34,811] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:34,888] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.60 | forward_fetch_submit: 0.06 | forward_all_gather: 33.66 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.64 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:31:34,906] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.47 | backward_microstep: 1556.42 | backward_inner_microstep: 1538.73 | backward_allreduce_microstep: 17.61 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2546
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:37,141] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:37,221] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.30 | forward_fetch_submit: 0.03 | forward_all_gather: 20.09 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 137.57 | forward_prefetch_submit: 0.90 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:37,350] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:31:37,352] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.45 | backward_microstep: 1546.52 | backward_inner_microstep: 1528.76 | backward_allreduce_microstep: 17.71 | step_microstep: 112.66
[2024-07-26 15:31:37,352] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1536.90 | backward: 3102.94 | backward_inner: 3067.51 | backward_allreduce: 35.32 | step: 112.74
 18%|█▊        | 35/200 [03:14<13:17,  4.84s/it]                                                {'loss': 1.9136, 'grad_norm': 0.8748964797397428, 'learning_rate': 1.8917405376582144e-05, 'epoch': 0.86}
 18%|█▊        | 35/200 [03:14<13:17,  4.84s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2578
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:39,661] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.47 | forward_fetch_submit: 0.06 | forward_all_gather: 31.50 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.69 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:31:39,690] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.86 | backward_microstep: 1537.01 | backward_inner_microstep: 1509.42 | backward_allreduce_microstep: 27.52 | step_microstep: 0.11
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2517
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:41,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:41,962] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.24 | forward_fetch_submit: 0.03 | forward_all_gather: 21.44 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 130.21 | forward_prefetch_submit: 0.96 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.70
[2024-07-26 15:31:42,099] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 751.91 | backward_microstep: 1517.04 | backward_inner_microstep: 1498.37 | backward_allreduce_microstep: 18.62 | step_microstep: 118.61
[2024-07-26 15:31:42,100] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1516.76 | backward: 3054.06 | backward_inner: 3007.80 | backward_allreduce: 46.14 | step: 118.73
 18%|█▊        | 36/200 [03:19<13:08,  4.81s/it]                                                {'loss': 1.9751, 'grad_norm': 1.0439803633521247, 'learning_rate': 1.8842954907300236e-05, 'epoch': 0.89}
 18%|█▊        | 36/200 [03:19<13:08,  4.81s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2598
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:44,610] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:44,691] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.78 | forward_fetch_submit: 0.06 | forward_all_gather: 34.91 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.98 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:44,725] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 778.79 | backward_microstep: 1815.59 | backward_inner_microstep: 1782.18 | backward_allreduce_microstep: 33.33 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2527
[2024-07-26 15:31:46,914] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:46,996] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.75 | forward_fetch_submit: 0.03 | forward_all_gather: 19.60 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 135.05 | forward_prefetch_submit: 0.91 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:47,113] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.69
[2024-07-26 15:31:47,114] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 750.25 | backward_microstep: 1515.96 | backward_inner_microstep: 1498.19 | backward_allreduce_microstep: 17.70 | step_microstep: 100.09
[2024-07-26 15:31:47,114] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1529.02 | backward: 3331.55 | backward_inner: 3280.40 | backward_allreduce: 51.04 | step: 100.18
 18%|█▊        | 37/200 [03:24<13:13,  4.87s/it]                                                {'loss': 1.8438, 'grad_norm': 0.8316737002082669, 'learning_rate': 1.876618552635348e-05, 'epoch': 0.91}
 18%|█▊        | 37/200 [03:24<13:13,  4.87s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2548
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:49,335] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:49,415] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.44 | forward_fetch_submit: 0.06 | forward_all_gather: 27.58 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.36 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:31:49,434] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.72 | backward_microstep: 1535.90 | backward_inner_microstep: 1518.04 | backward_allreduce_microstep: 17.78 | step_microstep: 0.09
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2495
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:51,643] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:51,730] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.77 | forward_fetch_submit: 0.03 | forward_all_gather: 22.59 | backward_fetch_wait: 5.53 | backward_fetch_submit: 0.00 | backward_all_gather: 132.71 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:51,857] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.62
[2024-07-26 15:31:51,858] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.30 | backward_microstep: 1541.88 | backward_inner_microstep: 1518.94 | backward_allreduce_microstep: 22.86 | step_microstep: 105.02
[2024-07-26 15:31:51,858] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1514.00 | backward: 3077.78 | backward_inner: 3037.01 | backward_allreduce: 40.64 | step: 105.11
 19%|█▉        | 38/200 [03:28<13:02,  4.83s/it]                                                {'loss': 1.9432, 'grad_norm': 0.9606002780581882, 'learning_rate': 1.8687117365181514e-05, 'epoch': 0.94}
 19%|█▉        | 38/200 [03:28<13:02,  4.83s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2599
[2024-07-26 15:31:54,115] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:54,115] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:54,115] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:54,115] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:54,115] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:54,116] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:54,116] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:54,116] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:54,195] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.30 | forward_fetch_submit: 0.06 | forward_all_gather: 32.44 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 19.89 | forward_prefetch_submit: 0.81 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:54,214] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.99 | backward_microstep: 1555.08 | backward_inner_microstep: 1537.33 | backward_allreduce_microstep: 17.67 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:31:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:31:56,498] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.21 | forward_fetch_submit: 0.03 | forward_all_gather: 20.67 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 129.02 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.30
[2024-07-26 15:31:56,642] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.51
[2024-07-26 15:31:56,643] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 745.55 | backward_microstep: 1546.92 | backward_inner_microstep: 1517.33 | backward_allreduce_microstep: 29.53 | step_microstep: 115.03
[2024-07-26 15:31:56,643] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1517.51 | backward: 3102.00 | backward_inner: 3054.69 | backward_allreduce: 47.20 | step: 115.11
 20%|█▉        | 39/200 [03:33<12:55,  4.82s/it]                                                {'loss': 1.965, 'grad_norm': 0.8409938329900004, 'learning_rate': 1.8605771158039253e-05, 'epoch': 0.96}
 20%|█▉        | 39/200 [03:33<12:55,  4.82s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2596
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:31:58,913] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:31:58,993] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.38 | forward_fetch_submit: 0.06 | forward_all_gather: 31.28 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.84 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:31:59,011] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 777.97 | backward_microstep: 1560.79 | backward_inner_microstep: 1542.59 | backward_allreduce_microstep: 18.13 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2493
[2024-07-26 15:32:01,219] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:32:01,219] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:32:01,219] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:32:01,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:32:01,220] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:32:01,220] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:32:01,220] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:32:01,220] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:32:01,300] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.23 | forward_fetch_submit: 0.03 | forward_all_gather: 21.54 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 43.03 | forward_prefetch_submit: 0.83 | backward_prefetch_wait: 0.30
[2024-07-26 15:32:01,421] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.37
[2024-07-26 15:32:01,422] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 773.68 | backward_microstep: 1513.53 | backward_inner_microstep: 1495.09 | backward_allreduce_microstep: 18.38 | step_microstep: 102.72
[2024-07-26 15:32:01,423] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1551.63 | backward: 3074.33 | backward_inner: 3037.70 | backward_allreduce: 36.52 | step: 102.80
 20%|██        | 40/200 [03:38<12:49,  4.81s/it]                                                {'loss': 1.8877, 'grad_norm': 0.942368297201956, 'learning_rate': 1.8522168236559693e-05, 'epoch': 0.99}
 20%|██        | 40/200 [03:38<12:49,  4.81s/it]petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2595
[2024-07-26 15:32:05,016] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:32:05,016] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:32:05,016] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:32:05,016] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:32:05,017] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:32:05,017] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:32:05,017] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:32:05,017] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:32:05,096] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 60.81 | forward_fetch_submit: 0.06 | forward_all_gather: 33.44 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 20.11 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.25
[2024-07-26 15:32:05,271] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 814.12 | backward_microstep: 1715.69 | backward_inner_microstep: 1541.57 | backward_allreduce_microstep: 174.04 | step_microstep: 0.09
[INFO|trainer.py:3819] 2024-07-26 15:32:05,286 >> 
***** Running Evaluation *****
[INFO|trainer.py:3821] 2024-07-26 15:32:05,286 >>   Num examples = 160
[INFO|trainer.py:3824] 2024-07-26 15:32:05,286 >>   Batch size = 8
[2024-07-26 15:32:06,441] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:06,500] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:06,517] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:06,540] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:10,846] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:11,043] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:11,258] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:11,282] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:14,755] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:15,407] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:15,590] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:15,612] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:18,222] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:19,183] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:19,534] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:32:19,534] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2605

  0%|          | 0/5 [00:00<?, ?it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2618
[2024-07-26 15:32:29,087] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 2039288576
[2024-07-26 15:32:29,088] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:32:29,088] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 135, numel = 8157154304
[2024-07-26 15:32:29,088] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 135, numel = 8157154304
[2024-07-26 15:32:29,138] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 572.31 | forward_fetch_submit: 0.51 | forward_all_gather: 83.53 | forward_prefetch_submit: 4.83

 40%|████      | 2/5 [00:03<00:04,  1.51s/it][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:32:30,716] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:32:30,716] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:32:30,716] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:32:30,716] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:32:30,740] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.96 | forward_fetch_submit: 0.00 | forward_all_gather: 19.25 | forward_prefetch_submit: 3.48

 60%|██████    | 3/5 [00:04<00:03,  1.55s/it][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:32:32,125] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:32:32,125] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:32:32,125] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:32:32,125] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:32:32,148] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.32 | forward_fetch_submit: 0.00 | forward_all_gather: 16.81 | forward_prefetch_submit: 0.82

 80%|████████  | 4/5 [00:06<00:01,  1.50s/it][Apetrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:32:34,862] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:32:34,862] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:32:34,862] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:32:34,862] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:32:34,885] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 203.96 | forward_fetch_submit: 0.00 | forward_all_gather: 17.15 | forward_prefetch_submit: 0.99

100%|██████████| 5/5 [00:08<00:00,  1.93s/it][A                                                
                                             [A{'eval_loss': 1.9312480688095093, 'eval_runtime': 29.8005, 'eval_samples_per_second': 5.369, 'eval_steps_per_second': 0.168, 'epoch': 0.99}
 20%|██        | 40/200 [04:12<12:49,  4.81s/it]
100%|██████████| 5/5 [00:08<00:00,  1.93s/it][A
                                             [A[INFO|trainer.py:3503] 2024-07-26 15:32:47,020 >> Saving model checkpoint to work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40
[INFO|configuration_utils.py:472] 2024-07-26 15:32:47,023 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/config.json
[INFO|configuration_utils.py:807] 2024-07-26 15:32:47,024 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/generation_config.json
[INFO|modeling_utils.py:2750] 2024-07-26 15:33:09,819 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 4 checkpoint shards. You can find where each parameters has been saved in the index located at work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2702] 2024-07-26 15:33:09,821 >> tokenizer config file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/tokenizer_config.json
[INFO|tokenization_utils_base.py:2711] 2024-07-26 15:33:09,821 >> Special tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/special_tokens_map.json
[INFO|tokenization_utils_base.py:2762] 2024-07-26 15:33:09,822 >> added tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/added_tokens.json
[2024-07-26 15:33:09,875] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step40 is about to be saved!
[2024-07-26 15:33:12,190] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/global_step40/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-07-26 15:33:12,190] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/global_step40/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-07-26 15:33:16,675] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/global_step40/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-07-26 15:33:17,167] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/global_step40/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-07-26 15:33:17,769] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/global_step40/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-07-26 15:33:17,770] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40/global_step40/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-07-26 15:33:17,891] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step40 is ready now!
[2024-07-26 15:33:19,182] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:19,182] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:19,232] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:19,284] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:23,865] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:24,037] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:24,164] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:24,302] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:28,004] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:28,306] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:28,509] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:28,581] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:31,937] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:32,472] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:32,852] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:33:32,883] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:33:38,694] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:33:38,695] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:38,695] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 117, numel = 7989174272
[2024-07-26 15:33:38,695] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:38,695] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:38,695] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 112, numel = 6737661952
[2024-07-26 15:33:38,695] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7989174272
[2024-07-26 15:33:38,695] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 112, numel = 6737661952
[2024-07-26 15:33:38,774] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 278.23 | forward_fetch_submit: 0.00 | forward_all_gather: 26.96 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 110.95 | forward_prefetch_submit: 1.26 | backward_prefetch_wait: 0.35
[2024-07-26 15:33:38,888] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.30
[2024-07-26 15:33:38,889] [WARNING] [stage3.py:1898:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
[2024-07-26 15:33:38,890] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1043.82 | backward_microstep: 1529.66 | backward_inner_microstep: 1512.03 | backward_allreduce_microstep: 17.57 | step_microstep: 97.81
[2024-07-26 15:33:38,890] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1857.92 | backward: 3245.35 | backward_inner: 3053.63 | backward_allreduce: 191.61 | step: 97.91
 20%|██        | 41/200 [05:15<1:26:24, 32.60s/it]                                                  {'loss': 1.837, 'grad_norm': 1.0582268245784205, 'learning_rate': 1.8436330524160048e-05, 'epoch': 1.01}
 20%|██        | 41/200 [05:15<1:26:24, 32.60s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2513
[2024-07-26 15:33:41,106] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:33:41,106] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:33:41,107] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:33:41,107] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:41,107] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:41,107] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:33:41,107] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:33:41,107] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:33:41,185] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.95 | forward_fetch_submit: 0.06 | forward_all_gather: 27.18 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 16.53 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:33:41,204] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 788.41 | backward_microstep: 1499.82 | backward_inner_microstep: 1481.80 | backward_allreduce_microstep: 17.94 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:33:43,446] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:33:43,525] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.29 | forward_fetch_submit: 0.03 | forward_all_gather: 26.26 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 39.04 | forward_prefetch_submit: 2.09 | backward_prefetch_wait: 0.30
[2024-07-26 15:33:43,634] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.12
[2024-07-26 15:33:43,636] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 791.61 | backward_microstep: 1525.03 | backward_inner_microstep: 1508.19 | backward_allreduce_microstep: 16.79 | step_microstep: 92.90
[2024-07-26 15:33:43,636] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1580.00 | backward: 3024.85 | backward_inner: 2990.01 | backward_allreduce: 34.73 | step: 92.99
 21%|██        | 42/200 [05:20<1:03:51, 24.25s/it]                                                  {'loss': 1.9349, 'grad_norm': 0.9665741300073241, 'learning_rate': 1.8348280530292712e-05, 'epoch': 1.04}
 21%|██        | 42/200 [05:20<1:03:51, 24.25s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2620
[2024-07-26 15:33:45,878] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:33:45,878] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:33:45,878] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:33:45,878] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:45,878] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:45,878] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:33:45,878] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:33:45,879] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:33:45,957] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.68 | forward_fetch_submit: 0.06 | forward_all_gather: 32.40 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.61 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:33:45,975] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.39 | backward_microstep: 1542.23 | backward_inner_microstep: 1525.07 | backward_allreduce_microstep: 17.08 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2575
[2024-07-26 15:33:48,213] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:33:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:33:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:33:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:33:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:33:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:33:48,292] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.29 | forward_fetch_submit: 0.03 | forward_all_gather: 20.81 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 134.73 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:33:48,433] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.94
[2024-07-26 15:33:48,435] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.89 | backward_microstep: 1558.24 | backward_inner_microstep: 1533.21 | backward_allreduce_microstep: 24.97 | step_microstep: 117.08
[2024-07-26 15:33:48,435] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1533.26 | backward: 3100.47 | backward_inner: 3058.30 | backward_allreduce: 42.06 | step: 117.15
 22%|██▏       | 43/200 [05:25<48:10, 18.41s/it]                                                  {'loss': 1.8171, 'grad_norm': 1.0203054722251164, 'learning_rate': 1.8258041344542567e-05, 'epoch': 1.06}
 22%|██▏       | 43/200 [05:25<48:10, 18.41s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2543
[2024-07-26 15:33:50,672] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:33:50,672] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:33:50,672] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:33:50,672] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:50,673] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:50,673] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:33:50,673] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:33:50,673] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:33:50,752] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.44 | forward_fetch_submit: 0.06 | forward_all_gather: 28.40 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 16.46 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.26
[2024-07-26 15:33:50,772] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.69 | backward_microstep: 1537.27 | backward_inner_microstep: 1517.57 | backward_allreduce_microstep: 19.62 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2546
[2024-07-26 15:33:53,127] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:33:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:33:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:33:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:33:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:33:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:33:53,206] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.04 | forward_fetch_submit: 0.03 | forward_all_gather: 19.91 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 116.19 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:33:53,371] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.30
[2024-07-26 15:33:53,373] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.58 | backward_microstep: 1718.33 | backward_inner_microstep: 1654.54 | backward_allreduce_microstep: 63.73 | step_microstep: 102.20
[2024-07-26 15:33:53,373] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1528.25 | backward: 3255.60 | backward_inner: 3172.13 | backward_allreduce: 83.36 | step: 102.29
 22%|██▏       | 44/200 [05:30<37:21, 14.37s/it]                                                {'loss': 1.8771, 'grad_norm': 1.0661924138430263, 'learning_rate': 1.816563663057211e-05, 'epoch': 1.09}
 22%|██▏       | 44/200 [05:30<37:21, 14.37s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2600
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:33:56,546] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:33:56,620] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.59 | forward_fetch_submit: 0.06 | forward_all_gather: 31.83 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 20.12 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:33:56,663] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.76 | backward_microstep: 2498.71 | backward_inner_microstep: 2456.15 | backward_allreduce_microstep: 42.49 | step_microstep: 0.08
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2591
[2024-07-26 15:33:58,874] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:33:58,874] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:33:58,874] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:33:58,874] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:33:58,875] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:33:58,875] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:33:58,875] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:33:58,875] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:33:58,941] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.34 | forward_fetch_submit: 0.03 | forward_all_gather: 23.17 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 137.46 | forward_prefetch_submit: 0.97 | backward_prefetch_wait: 0.30
[2024-07-26 15:33:59,090] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.40
[2024-07-26 15:33:59,091] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.83 | backward_microstep: 1524.72 | backward_inner_microstep: 1496.38 | backward_allreduce_microstep: 28.29 | step_microstep: 121.10
[2024-07-26 15:33:59,091] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1524.57 | backward: 4023.44 | backward_inner: 3952.55 | backward_allreduce: 70.78 | step: 121.18
 22%|██▎       | 45/200 [05:36<30:25, 11.77s/it]                                                {'loss': 1.9126, 'grad_norm': 0.9790368425703265, 'learning_rate': 1.8071090619916095e-05, 'epoch': 1.11}
 22%|██▎       | 45/200 [05:36<30:25, 11.77s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2659
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:01,399] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:01,476] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.11 | forward_fetch_submit: 0.06 | forward_all_gather: 32.76 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 25.15 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:01,494] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 780.60 | backward_microstep: 1573.83 | backward_inner_microstep: 1556.40 | backward_allreduce_microstep: 17.35 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:03,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:03,816] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.88 | forward_fetch_submit: 0.03 | forward_all_gather: 20.05 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 44.86 | forward_prefetch_submit: 0.92 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:03,932] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.28
[2024-07-26 15:34:03,933] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.79 | backward_microstep: 1544.25 | backward_inner_microstep: 1525.59 | backward_allreduce_microstep: 18.60 | step_microstep: 97.92
[2024-07-26 15:34:03,934] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1556.37 | backward: 3118.08 | backward_inner: 3082.01 | backward_allreduce: 35.95 | step: 98.00
 23%|██▎       | 46/200 [05:40<24:53,  9.70s/it]                                                {'loss': 1.8958, 'grad_norm': 0.9455987319049416, 'learning_rate': 1.797442810562721e-05, 'epoch': 1.14}
 23%|██▎       | 46/200 [05:40<24:53,  9.70s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2538
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:06,136] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:06,210] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.70 | forward_fetch_submit: 0.06 | forward_all_gather: 26.85 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.65 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:06,228] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 750.40 | backward_microstep: 1515.66 | backward_inner_microstep: 1497.98 | backward_allreduce_microstep: 17.60 | step_microstep: 0.09
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2549
[2024-07-26 15:34:08,465] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:08,466] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:08,466] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:08,466] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:08,466] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:08,466] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:08,466] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:08,466] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:08,531] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 30.54 | forward_fetch_submit: 0.03 | forward_all_gather: 23.50 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 132.78 | forward_prefetch_submit: 0.94 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:08,653] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.18
[2024-07-26 15:34:08,655] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.97 | backward_microstep: 1545.58 | backward_inner_microstep: 1523.77 | backward_allreduce_microstep: 21.76 | step_microstep: 101.34
[2024-07-26 15:34:08,655] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1508.36 | backward: 3061.25 | backward_inner: 3021.77 | backward_allreduce: 39.36 | step: 101.43
 24%|██▎       | 47/200 [05:45<20:54,  8.20s/it]                                                {'loss': 1.864, 'grad_norm': 0.9158060437829861, 'learning_rate': 1.7875674435774546e-05, 'epoch': 1.16}
 24%|██▎       | 47/200 [05:45<20:54,  8.20s/it]dynamic ViT batch size: 40, images per sample: 10.0, dynamic token length: 3525
[2024-07-26 15:34:11,476] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:11,477] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:11,477] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:11,477] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:11,477] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:11,477] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:11,477] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:11,477] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:11,562] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.16 | forward_fetch_submit: 0.06 | forward_all_gather: 25.57 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 14.72 | forward_prefetch_submit: 0.71 | backward_prefetch_wait: 0.26
[2024-07-26 15:34:11,580] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 962.31 | backward_microstep: 1934.20 | backward_inner_microstep: 1916.56 | backward_allreduce_microstep: 17.57 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2568
[2024-07-26 15:34:13,872] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:13,872] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:13,872] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:13,872] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:13,872] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:13,872] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:13,872] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:13,873] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:13,946] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.20 | forward_fetch_submit: 0.03 | forward_all_gather: 20.62 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 125.03 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:14,197] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.78
[2024-07-26 15:34:14,198] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.21 | backward_microstep: 1730.07 | backward_inner_microstep: 1584.89 | backward_allreduce_microstep: 145.12 | step_microstep: 105.88
[2024-07-26 15:34:14,198] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1722.50 | backward: 3664.27 | backward_inner: 3501.46 | backward_allreduce: 162.70 | step: 105.97
 24%|██▍       | 48/200 [05:51<18:45,  7.40s/it]                                                {'loss': 1.839, 'grad_norm': 0.9803797978577685, 'learning_rate': 1.7774855506796497e-05, 'epoch': 1.19}
 24%|██▍       | 48/200 [05:51<18:45,  7.40s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2530
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:16,391] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:16,471] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.37 | forward_fetch_submit: 0.06 | forward_all_gather: 28.66 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.26 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:16,660] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.42 | backward_microstep: 1683.18 | backward_inner_microstep: 1494.39 | backward_allreduce_microstep: 188.72 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2587
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:19,140] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:19,221] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.86 | forward_fetch_submit: 0.03 | forward_all_gather: 24.22 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 46.23 | forward_prefetch_submit: 1.00 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:19,333] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.16
[2024-07-26 15:34:19,334] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 989.69 | backward_microstep: 1565.41 | backward_inner_microstep: 1548.45 | backward_allreduce_microstep: 16.89 | step_microstep: 95.59
[2024-07-26 15:34:19,334] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1742.10 | backward: 3248.60 | backward_inner: 3042.87 | backward_allreduce: 205.61 | step: 95.68
 24%|██▍       | 49/200 [05:56<16:55,  6.72s/it]                                                {'loss': 1.8251, 'grad_norm': 1.0111209300429922, 'learning_rate': 1.767199775670986e-05, 'epoch': 1.21}
 24%|██▍       | 49/200 [05:56<16:55,  6.72s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2512
[2024-07-26 15:34:21,584] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:21,585] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:21,585] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:21,585] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:21,585] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:21,585] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:21,585] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:21,585] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:21,663] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 34.34 | forward_fetch_submit: 0.06 | forward_all_gather: 30.90 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.31 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:34:21,692] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.89 | backward_microstep: 1565.20 | backward_inner_microstep: 1536.94 | backward_allreduce_microstep: 28.19 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2554
[2024-07-26 15:34:23,938] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:23,938] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:23,938] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:23,938] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:23,939] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:23,939] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:23,939] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:23,939] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:24,019] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.40 | forward_fetch_submit: 0.03 | forward_all_gather: 21.98 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 135.73 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:24,137] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.52
[2024-07-26 15:34:24,139] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.09 | backward_microstep: 1557.29 | backward_inner_microstep: 1539.43 | backward_allreduce_microstep: 17.81 | step_microstep: 101.45
[2024-07-26 15:34:24,139] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1531.96 | backward: 3122.50 | backward_inner: 3076.38 | backward_allreduce: 46.00 | step: 101.52
 25%|██▌       | 50/200 [06:01<15:22,  6.15s/it]                                                {'loss': 1.865, 'grad_norm': 0.9979296567567881, 'learning_rate': 1.7567128158176955e-05, 'epoch': 1.23}
 25%|██▌       | 50/200 [06:01<15:22,  6.15s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2642
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:26,419] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:26,498] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.55 | forward_fetch_submit: 0.06 | forward_all_gather: 31.58 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.80 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:34:26,516] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 777.65 | backward_microstep: 1572.85 | backward_inner_microstep: 1555.05 | backward_allreduce_microstep: 17.73 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2610
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:28,779] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:28,861] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.87 | forward_fetch_submit: 0.03 | forward_all_gather: 22.00 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 25.16 | forward_prefetch_submit: 0.79 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:28,975] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.31
[2024-07-26 15:34:28,976] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 782.48 | backward_microstep: 1558.38 | backward_inner_microstep: 1540.71 | backward_allreduce_microstep: 17.61 | step_microstep: 96.91
[2024-07-26 15:34:28,977] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1560.11 | backward: 3131.23 | backward_inner: 3095.78 | backward_allreduce: 35.34 | step: 96.99
 26%|██▌       | 51/200 [06:06<14:17,  5.76s/it]                                                {'loss': 1.8, 'grad_norm': 1.0483577290680233, 'learning_rate': 1.7460274211432463e-05, 'epoch': 1.26}
 26%|██▌       | 51/200 [06:06<14:17,  5.76s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2533
[2024-07-26 15:34:31,207] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:31,208] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:31,208] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:31,208] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:31,208] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:31,208] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:31,208] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:31,208] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:31,288] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.84 | forward_fetch_submit: 0.07 | forward_all_gather: 28.51 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 17.08 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:31,307] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.71 | backward_microstep: 1541.79 | backward_inner_microstep: 1523.07 | backward_allreduce_microstep: 18.65 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2546
[2024-07-26 15:34:33,541] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:33,541] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:33,542] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:33,542] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:33,542] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:33,542] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:33,542] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:33,542] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:33,621] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.45 | forward_fetch_submit: 0.03 | forward_all_gather: 23.26 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 139.42 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.31
[2024-07-26 15:34:33,744] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.30
[2024-07-26 15:34:33,745] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.41 | backward_microstep: 1539.38 | backward_inner_microstep: 1520.20 | backward_allreduce_microstep: 19.13 | step_microstep: 104.88
[2024-07-26 15:34:33,746] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1533.10 | backward: 3081.17 | backward_inner: 3043.28 | backward_allreduce: 37.79 | step: 104.97
 26%|██▌       | 52/200 [06:10<13:27,  5.46s/it]                                                {'loss': 1.8425, 'grad_norm': 0.9137204026908462, 'learning_rate': 1.7351463937072008e-05, 'epoch': 1.28}
 26%|██▌       | 52/200 [06:10<13:27,  5.46s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2528
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:36,167] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.64 | forward_fetch_submit: 0.06 | forward_all_gather: 33.80 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.35 | forward_prefetch_submit: 2.70 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:36,195] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 891.50 | backward_microstep: 1532.16 | backward_inner_microstep: 1504.73 | backward_allreduce_microstep: 27.36 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2542
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:38,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:38,837] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.04 | forward_fetch_submit: 0.03 | forward_all_gather: 21.58 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 25.34 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.31
[2024-07-26 15:34:39,120] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.29
[2024-07-26 15:34:39,121] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 923.70 | backward_microstep: 1886.13 | backward_inner_microstep: 1694.96 | backward_allreduce_microstep: 191.11 | step_microstep: 92.16
[2024-07-26 15:34:39,121] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1815.19 | backward: 3418.30 | backward_inner: 3199.71 | backward_allreduce: 218.47 | step: 92.25
 26%|██▋       | 53/200 [06:16<13:18,  5.43s/it]                                                {'loss': 1.7912, 'grad_norm': 1.0523349321552258, 'learning_rate': 1.7240725868704218e-05, 'epoch': 1.31}
 26%|██▋       | 53/200 [06:16<13:18,  5.43s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2547
[2024-07-26 15:34:41,395] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:41,395] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:41,395] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:41,396] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:41,396] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:41,396] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:41,396] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:41,396] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:41,475] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 34.74 | forward_fetch_submit: 0.06 | forward_all_gather: 32.02 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 16.68 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:41,505] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.25 | backward_microstep: 1581.75 | backward_inner_microstep: 1552.46 | backward_allreduce_microstep: 29.20 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:43,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:43,836] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.65 | forward_fetch_submit: 0.03 | forward_all_gather: 22.46 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 135.47 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:43,956] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.35
[2024-07-26 15:34:43,957] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.15 | backward_microstep: 1554.43 | backward_inner_microstep: 1534.98 | backward_allreduce_microstep: 19.40 | step_microstep: 101.08
[2024-07-26 15:34:43,958] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1549.39 | backward: 3136.18 | backward_inner: 3087.45 | backward_allreduce: 48.61 | step: 101.17
 27%|██▋       | 54/200 [06:20<12:47,  5.25s/it]                                                {'loss': 1.8312, 'grad_norm': 0.8842003952208194, 'learning_rate': 1.7128089045468294e-05, 'epoch': 1.33}
 27%|██▋       | 54/200 [06:20<12:47,  5.25s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2635
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:46,229] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:46,307] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.77 | forward_fetch_submit: 0.06 | forward_all_gather: 31.38 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.52 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:46,326] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.62 | backward_microstep: 1566.16 | backward_inner_microstep: 1548.19 | backward_allreduce_microstep: 17.89 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2575
[2024-07-26 15:34:48,564] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:48,565] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:48,565] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:48,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:48,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:48,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:48,565] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:48,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:48,639] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.06 | forward_fetch_submit: 0.03 | forward_all_gather: 20.25 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 131.09 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:34:48,754] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.42 | backward_microstep: 1547.91 | backward_inner_microstep: 1529.93 | backward_allreduce_microstep: 17.93 | step_microstep: 96.86
[2024-07-26 15:34:48,755] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1537.02 | backward: 3114.08 | backward_inner: 3078.13 | backward_allreduce: 35.83 | step: 96.95
 28%|██▊       | 55/200 [06:25<12:22,  5.12s/it]                                                {'loss': 1.789, 'grad_norm': 1.00872377095192, 'learning_rate': 1.7013583004418994e-05, 'epoch': 1.36}
 28%|██▊       | 55/200 [06:25<12:22,  5.12s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2548
[2024-07-26 15:34:51,001] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:51,002] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:51,002] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:51,002] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:51,002] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:51,002] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:51,002] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:51,002] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:51,077] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.47 | forward_fetch_submit: 0.06 | forward_all_gather: 33.08 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 17.13 | forward_prefetch_submit: 2.01 | backward_prefetch_wait: 0.26
[2024-07-26 15:34:51,106] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.10 | backward_microstep: 1555.84 | backward_inner_microstep: 1528.11 | backward_allreduce_microstep: 27.66 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2573
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:53,364] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:53,444] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 17.99 | forward_fetch_submit: 0.03 | forward_all_gather: 23.16 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 143.76 | forward_prefetch_submit: 0.91 | backward_prefetch_wait: 0.31
[2024-07-26 15:34:53,564] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.55
[2024-07-26 15:34:53,565] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.28 | backward_microstep: 1560.63 | backward_inner_microstep: 1542.74 | backward_allreduce_microstep: 17.84 | step_microstep: 103.43
[2024-07-26 15:34:53,566] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1543.35 | backward: 3116.47 | backward_inner: 3070.86 | backward_allreduce: 45.50 | step: 103.52
 28%|██▊       | 56/200 [06:30<12:03,  5.03s/it]                                                {'loss': 1.8399, 'grad_norm': 1.355238243026855, 'learning_rate': 1.6897237772781046e-05, 'epoch': 1.38}
 28%|██▊       | 56/200 [06:30<12:03,  5.03s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:34:55,978] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:34:55,978] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:34:55,978] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:34:55,978] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:55,978] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:55,978] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:34:55,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:34:55,979] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:34:56,059] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 192.56 | forward_fetch_submit: 0.06 | forward_all_gather: 30.65 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.37 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:34:56,078] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.68 | backward_microstep: 1721.96 | backward_inner_microstep: 1703.81 | backward_allreduce_microstep: 18.07 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2544
[2024-07-26 15:34:58,461] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:34:58,462] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:34:58,462] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:34:58,462] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:34:58,462] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:34:58,462] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:34:58,462] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:34:58,462] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:34:58,543] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.03 | forward_fetch_submit: 0.03 | forward_all_gather: 25.47 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 113.13 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.30
[2024-07-26 15:34:58,853] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.49
[2024-07-26 15:34:58,854] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.47 | backward_microstep: 1883.40 | backward_inner_microstep: 1679.15 | backward_allreduce_microstep: 204.19 | step_microstep: 106.77
[2024-07-26 15:34:58,855] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1526.13 | backward: 3605.36 | backward_inner: 3382.98 | backward_allreduce: 222.27 | step: 106.85
 28%|██▊       | 57/200 [06:35<12:09,  5.10s/it]                                                {'loss': 1.743, 'grad_norm': 1.1398196948097814, 'learning_rate': 1.6779083860075032e-05, 'epoch': 1.41}
 28%|██▊       | 57/200 [06:35<12:09,  5.10s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:35:01,241] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:01,241] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:01,241] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:01,241] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:01,241] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:01,242] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:01,242] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:01,242] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:01,309] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.95 | forward_fetch_submit: 0.06 | forward_all_gather: 27.52 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 17.27 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:35:01,328] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.10 | backward_microstep: 1701.47 | backward_inner_microstep: 1682.94 | backward_allreduce_microstep: 18.44 | step_microstep: 0.09
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2599
[2024-07-26 15:35:03,573] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:03,573] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:03,573] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:03,573] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:03,573] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:03,647] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:03,647] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:03,647] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:03,712] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.05 | forward_fetch_submit: 0.03 | forward_all_gather: 22.03 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 134.15 | forward_prefetch_submit: 1.06 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:03,827] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.39
[2024-07-26 15:35:03,828] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.41 | backward_microstep: 1616.64 | backward_inner_microstep: 1598.96 | backward_allreduce_microstep: 17.62 | step_microstep: 97.47
[2024-07-26 15:35:03,828] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1507.48 | backward: 3318.10 | backward_inner: 3281.92 | backward_allreduce: 36.07 | step: 97.56
 29%|██▉       | 58/200 [06:40<11:59,  5.07s/it]                                                {'loss': 1.7152, 'grad_norm': 3.2245691692902896, 'learning_rate': 1.665915225011681e-05, 'epoch': 1.43}
 29%|██▉       | 58/200 [06:40<11:59,  5.07s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2540
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:06,135] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:06,215] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 34.12 | forward_fetch_submit: 0.06 | forward_all_gather: 27.85 | backward_fetch_wait: 5.67 | backward_fetch_submit: 0.00 | backward_all_gather: 16.12 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:06,265] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 783.23 | backward_microstep: 1626.63 | backward_inner_microstep: 1577.24 | backward_allreduce_microstep: 49.31 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2630
[2024-07-26 15:35:08,537] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:08,538] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:08,538] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:08,538] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:08,538] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:08,538] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:08,538] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:08,538] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:08,617] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.58 | forward_fetch_submit: 0.03 | forward_all_gather: 20.96 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 115.23 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:08,738] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.40
[2024-07-26 15:35:08,739] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.96 | backward_microstep: 1571.02 | backward_inner_microstep: 1553.18 | backward_allreduce_microstep: 17.78 | step_microstep: 103.45
[2024-07-26 15:35:08,739] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1560.17 | backward: 3197.65 | backward_inner: 3130.44 | backward_allreduce: 67.10 | step: 103.53
 30%|██▉       | 59/200 [06:45<11:47,  5.02s/it]                                                {'loss': 1.6244, 'grad_norm': 0.9436577858701182, 'learning_rate': 1.6537474392892527e-05, 'epoch': 1.46}
 30%|██▉       | 59/200 [06:45<11:47,  5.02s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:35:10,984] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:10,985] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:10,985] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:10,985] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:10,985] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:10,985] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:10,985] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:10,985] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:11,065] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.70 | forward_fetch_submit: 0.06 | forward_all_gather: 31.37 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.53 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:11,082] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.48 | backward_microstep: 1548.78 | backward_inner_microstep: 1531.49 | backward_allreduce_microstep: 17.22 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:13,316] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:13,397] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.70 | forward_fetch_submit: 0.03 | forward_all_gather: 19.37 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 123.11 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:13,511] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.32
[2024-07-26 15:35:13,512] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.45 | backward_microstep: 1551.89 | backward_inner_microstep: 1534.09 | backward_allreduce_microstep: 17.73 | step_microstep: 96.39
[2024-07-26 15:35:13,512] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1527.90 | backward: 3100.67 | backward_inner: 3065.60 | backward_allreduce: 34.96 | step: 96.47
 30%|███       | 60/200 [06:50<11:32,  4.95s/it]                                                {'loss': 1.735, 'grad_norm': 1.027311163834137, 'learning_rate': 1.6414082196311402e-05, 'epoch': 1.48}
 30%|███       | 60/200 [06:50<11:32,  4.95s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2556
[2024-07-26 15:35:15,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:15,772] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:15,772] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:15,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:15,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:15,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:15,772] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:15,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:15,853] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.47 | forward_fetch_submit: 0.06 | forward_all_gather: 27.29 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.97 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:15,977] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.83 | backward_microstep: 1678.41 | backward_inner_microstep: 1554.90 | backward_allreduce_microstep: 123.42 | step_microstep: 0.18
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2539
[2024-07-26 15:35:18,218] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:18,218] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:18,218] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:18,218] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:18,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:18,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:18,219] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:18,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:18,298] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 29.18 | forward_fetch_submit: 0.03 | forward_all_gather: 22.50 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 136.48 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:18,648] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.29
[2024-07-26 15:35:18,649] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.94 | backward_microstep: 1780.46 | backward_inner_microstep: 1536.79 | backward_allreduce_microstep: 243.62 | step_microstep: 107.12
[2024-07-26 15:35:18,649] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1521.75 | backward: 3458.88 | backward_inner: 3091.71 | backward_allreduce: 367.05 | step: 107.30
 30%|███       | 61/200 [06:55<11:35,  5.00s/it]                                                {'loss': 1.7422, 'grad_norm': 0.9330284648948073, 'learning_rate': 1.6289008017838447e-05, 'epoch': 1.51}
 30%|███       | 61/200 [06:55<11:35,  5.00s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2588
[2024-07-26 15:35:21,093] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:21,094] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:21,094] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:21,094] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:21,094] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:21,094] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:21,094] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:21,094] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:21,173] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 221.23 | forward_fetch_submit: 0.06 | forward_all_gather: 31.22 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.25 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:21,190] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.90 | backward_microstep: 1746.53 | backward_inner_microstep: 1729.56 | backward_allreduce_microstep: 16.89 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2562
[2024-07-26 15:35:23,609] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:23,609] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:23,609] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:23,609] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:23,610] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:23,610] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:23,610] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:23,610] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:23,689] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.68 | forward_fetch_submit: 0.03 | forward_all_gather: 20.20 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 31.44 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:23,800] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.25
[2024-07-26 15:35:23,801] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 956.40 | backward_microstep: 1539.71 | backward_inner_microstep: 1522.50 | backward_allreduce_microstep: 17.16 | step_microstep: 94.10
[2024-07-26 15:35:23,801] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1720.28 | backward: 3286.24 | backward_inner: 3252.08 | backward_allreduce: 34.05 | step: 94.18
 31%|███       | 62/200 [07:00<11:36,  5.05s/it]                                                {'loss': 1.6854, 'grad_norm': 1.021677100870533, 'learning_rate': 1.6162284656009276e-05, 'epoch': 1.53}
 31%|███       | 62/200 [07:00<11:36,  5.05s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2546
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:26,087] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:26,163] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 39.41 | forward_fetch_submit: 0.06 | forward_all_gather: 31.72 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.23 | forward_prefetch_submit: 2.11 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:26,204] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.10 | backward_microstep: 1598.88 | backward_inner_microstep: 1558.09 | backward_allreduce_microstep: 40.72 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2567
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:28,852] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:28,932] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 247.62 | forward_fetch_submit: 0.03 | forward_all_gather: 23.78 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 20.57 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:29,284] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:35:29,285] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 817.90 | backward_microstep: 2134.39 | backward_inner_microstep: 1889.19 | backward_allreduce_microstep: 245.13 | step_microstep: 107.82
[2024-07-26 15:35:29,286] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1592.96 | backward: 3733.28 | backward_inner: 3447.30 | backward_allreduce: 285.86 | step: 107.90
 32%|███▏      | 63/200 [07:06<11:49,  5.18s/it]                                                {'loss': 1.6994, 'grad_norm': 0.8804089215310221, 'learning_rate': 1.603394534182925e-05, 'epoch': 1.56}
 32%|███▏      | 63/200 [07:06<11:49,  5.18s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2595
[2024-07-26 15:35:31,534] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:31,615] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.96 | forward_fetch_submit: 0.06 | forward_all_gather: 31.61 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.81 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:31,633] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.90 | backward_microstep: 1548.54 | backward_inner_microstep: 1530.76 | backward_allreduce_microstep: 17.70 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2606
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:33,896] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:33,975] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.89 | forward_fetch_submit: 0.03 | forward_all_gather: 20.71 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 19.07 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:34,085] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.16
[2024-07-26 15:35:34,086] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 783.92 | backward_microstep: 1554.74 | backward_inner_microstep: 1537.53 | backward_allreduce_microstep: 17.16 | step_microstep: 93.21
[2024-07-26 15:35:34,086] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1550.80 | backward: 3103.29 | backward_inner: 3068.31 | backward_allreduce: 34.86 | step: 93.28
 32%|███▏      | 64/200 [07:11<11:28,  5.07s/it]                                                {'loss': 1.7639, 'grad_norm': 1.010491526445559, 'learning_rate': 1.5904023730059227e-05, 'epoch': 1.58}
 32%|███▏      | 64/200 [07:11<11:28,  5.07s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2525
[2024-07-26 15:35:36,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:36,287] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:36,287] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:36,287] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:36,287] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:36,287] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:36,287] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:36,287] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:36,366] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.02 | forward_fetch_submit: 0.06 | forward_all_gather: 27.42 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 15.97 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:36,394] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 747.41 | backward_microstep: 1529.30 | backward_inner_microstep: 1502.75 | backward_allreduce_microstep: 26.46 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2569
[2024-07-26 15:35:38,746] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:38,747] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:38,747] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:38,747] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:38,747] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:38,747] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:38,747] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:38,747] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:38,827] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.95 | forward_fetch_submit: 0.03 | forward_all_gather: 24.20 | backward_fetch_wait: 5.50 | backward_fetch_submit: 0.00 | backward_all_gather: 19.23 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:39,027] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.56
[2024-07-26 15:35:39,028] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 793.96 | backward_microstep: 1711.23 | backward_inner_microstep: 1616.77 | backward_allreduce_microstep: 94.40 | step_microstep: 106.40
[2024-07-26 15:35:39,028] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1541.35 | backward: 3240.53 | backward_inner: 3119.54 | backward_allreduce: 120.87 | step: 106.48
 32%|███▎      | 65/200 [07:16<11:18,  5.03s/it]                                                {'loss': 1.6506, 'grad_norm': 0.9490020368820996, 'learning_rate': 1.5772553890390196e-05, 'epoch': 1.6}
 32%|███▎      | 65/200 [07:16<11:18,  5.03s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2651
[2024-07-26 15:35:41,349] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:41,349] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:41,349] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:41,349] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:41,349] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:41,350] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:41,350] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:41,350] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:41,429] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.50 | forward_fetch_submit: 0.06 | forward_all_gather: 31.78 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 18.44 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:41,599] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 778.19 | backward_microstep: 1764.73 | backward_inner_microstep: 1595.67 | backward_allreduce_microstep: 168.99 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:44,000] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:44,080] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.20 | forward_fetch_submit: 0.03 | forward_all_gather: 19.87 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 31.39 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:44,193] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.33
[2024-07-26 15:35:44,195] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 777.43 | backward_microstep: 1699.71 | backward_inner_microstep: 1681.93 | backward_allreduce_microstep: 17.71 | step_microstep: 96.00
[2024-07-26 15:35:44,195] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1555.60 | backward: 3464.44 | backward_inner: 3277.62 | backward_allreduce: 186.71 | step: 96.08
 33%|███▎      | 66/200 [07:21<11:19,  5.07s/it]                                                {'loss': 1.6058, 'grad_norm': 1.2372682071620666, 'learning_rate': 1.5639570298509067e-05, 'epoch': 1.63}
 33%|███▎      | 66/200 [07:21<11:19,  5.07s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2517
[2024-07-26 15:35:46,391] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:46,391] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:46,391] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:46,391] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:46,392] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:46,392] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:46,392] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:46,392] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:46,472] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.08 | forward_fetch_submit: 0.06 | forward_all_gather: 27.46 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 16.04 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:35:46,493] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 747.89 | backward_microstep: 1523.18 | backward_inner_microstep: 1503.12 | backward_allreduce_microstep: 19.94 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2589
[2024-07-26 15:35:48,752] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:48,753] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:48,831] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.89 | forward_fetch_submit: 0.03 | forward_all_gather: 22.98 | backward_fetch_wait: 5.54 | backward_fetch_submit: 0.00 | backward_all_gather: 42.13 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:48,953] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.66
[2024-07-26 15:35:48,955] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.07 | backward_microstep: 1557.92 | backward_inner_microstep: 1539.89 | backward_allreduce_microstep: 17.97 | step_microstep: 104.87
[2024-07-26 15:35:48,955] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1523.94 | backward: 3081.11 | backward_inner: 3043.06 | backward_allreduce: 37.92 | step: 104.96
 34%|███▎      | 67/200 [07:25<11:01,  4.98s/it]                                                {'loss': 1.6473, 'grad_norm': 1.0659625064825569, 'learning_rate': 1.5505107827058038e-05, 'epoch': 1.65}
 34%|███▎      | 67/200 [07:25<11:01,  4.98s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2517
[2024-07-26 15:35:51,148] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:51,148] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:51,216] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.98 | forward_fetch_submit: 0.06 | forward_all_gather: 27.82 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.16 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:51,242] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.86 | backward_microstep: 1507.48 | backward_inner_microstep: 1482.68 | backward_allreduce_microstep: 24.72 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2592
[2024-07-26 15:35:53,526] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:53,526] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:53,607] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 29.81 | forward_fetch_submit: 0.03 | forward_all_gather: 21.06 | backward_fetch_wait: 5.54 | backward_fetch_submit: 0.00 | backward_all_gather: 138.17 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:53,725] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.24
[2024-07-26 15:35:53,727] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.93 | backward_microstep: 1586.02 | backward_inner_microstep: 1568.64 | backward_allreduce_microstep: 17.33 | step_microstep: 102.31
[2024-07-26 15:35:53,727] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1526.78 | backward: 3093.51 | backward_inner: 3051.34 | backward_allreduce: 42.05 | step: 102.40
 34%|███▍      | 68/200 [07:30<10:48,  4.92s/it]                                                {'loss': 1.5706, 'grad_norm': 1.7954442372071227, 'learning_rate': 1.536920173648984e-05, 'epoch': 1.68}
 34%|███▍      | 68/200 [07:30<10:48,  4.92s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2519
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:35:55,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:35:55,995] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.46 | forward_fetch_submit: 0.06 | forward_all_gather: 27.59 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.27 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:35:56,013] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.07 | backward_microstep: 1512.26 | backward_inner_microstep: 1494.14 | backward_allreduce_microstep: 18.05 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:35:58,260] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:35:58,340] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.09 | forward_fetch_submit: 0.03 | forward_all_gather: 19.34 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 117.40 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:35:58,588] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.64
[2024-07-26 15:35:58,590] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.91 | backward_microstep: 1678.89 | backward_inner_microstep: 1537.51 | backward_allreduce_microstep: 141.32 | step_microstep: 107.85
[2024-07-26 15:35:58,590] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1513.96 | backward: 3191.15 | backward_inner: 3031.66 | backward_allreduce: 159.37 | step: 107.94
 34%|███▍      | 69/200 [07:35<10:41,  4.90s/it]                                                {'loss': 1.6998, 'grad_norm': 1.5191308502749226, 'learning_rate': 1.52318876658213e-05, 'epoch': 1.7}
 34%|███▍      | 69/200 [07:35<10:41,  4.90s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2562
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:00,818] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:00,898] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.65 | forward_fetch_submit: 0.06 | forward_all_gather: 31.22 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.26 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:36:01,138] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.23 | backward_microstep: 1757.93 | backward_inner_microstep: 1518.09 | backward_allreduce_microstep: 239.76 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:03,496] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:03,575] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.16 | forward_fetch_submit: 0.03 | forward_all_gather: 21.55 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 19.24 | forward_prefetch_submit: 1.06 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:03,765] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:36:03,767] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 789.54 | backward_microstep: 1711.44 | backward_inner_microstep: 1625.80 | backward_allreduce_microstep: 85.58 | step_microstep: 105.16
[2024-07-26 15:36:03,767] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1552.74 | backward: 3469.38 | backward_inner: 3143.91 | backward_allreduce: 325.35 | step: 105.26
 35%|███▌      | 70/200 [07:40<10:47,  4.98s/it]                                                {'loss': 1.7915, 'grad_norm': 0.9855626008366942, 'learning_rate': 1.5093201623287631e-05, 'epoch': 1.73}
 35%|███▌      | 70/200 [07:40<10:47,  4.98s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2569
[2024-07-26 15:36:06,185] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:06,186] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:06,186] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:06,186] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:06,186] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:06,186] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:06,186] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:06,186] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:06,266] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.62 | forward_fetch_submit: 0.06 | forward_all_gather: 31.21 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 20.25 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:36:06,284] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.82 | backward_microstep: 1726.72 | backward_inner_microstep: 1708.97 | backward_allreduce_microstep: 17.68 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2531
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:08,517] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:08,597] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 30.25 | forward_fetch_submit: 0.03 | forward_all_gather: 20.74 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 136.43 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:08,717] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:36:08,718] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.79 | backward_microstep: 1554.65 | backward_inner_microstep: 1536.90 | backward_allreduce_microstep: 17.70 | step_microstep: 103.10
[2024-07-26 15:36:08,718] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1516.59 | backward: 3281.37 | backward_inner: 3245.89 | backward_allreduce: 35.38 | step: 103.19
 36%|███▌      | 71/200 [07:45<10:41,  4.97s/it]                                                {'loss': 1.8162, 'grad_norm': 1.219720140002764, 'learning_rate': 1.4953179976899878e-05, 'epoch': 1.75}
 36%|███▌      | 71/200 [07:45<10:41,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2607
[2024-07-26 15:36:10,978] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:10,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:10,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:10,979] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:10,979] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:10,979] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:10,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:10,979] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:11,059] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.96 | forward_fetch_submit: 0.06 | forward_all_gather: 33.71 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 20.52 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:36:11,077] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.33 | backward_microstep: 1554.38 | backward_inner_microstep: 1536.88 | backward_allreduce_microstep: 17.42 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2578
[2024-07-26 15:36:13,296] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:13,376] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.54 | forward_fetch_submit: 0.03 | forward_all_gather: 19.66 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 128.41 | forward_prefetch_submit: 0.81 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:13,493] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.30
[2024-07-26 15:36:13,494] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 758.95 | backward_microstep: 1537.46 | backward_inner_microstep: 1519.38 | backward_allreduce_microstep: 18.03 | step_microstep: 99.37
[2024-07-26 15:36:13,494] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1534.26 | backward: 3091.84 | backward_inner: 3056.28 | backward_allreduce: 35.45 | step: 99.45
 36%|███▌      | 72/200 [07:50<10:28,  4.91s/it]                                                {'loss': 1.7031, 'grad_norm': 1.0617280772342832, 'learning_rate': 1.4811859444908053e-05, 'epoch': 1.78}
 36%|███▌      | 72/200 [07:50<10:28,  4.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2526
[2024-07-26 15:36:15,682] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:15,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:15,763] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.37 | forward_fetch_submit: 0.06 | forward_all_gather: 27.15 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.20 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:36:15,782] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.66 | backward_microstep: 1515.18 | backward_inner_microstep: 1496.88 | backward_allreduce_microstep: 18.22 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:18,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:18,098] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.78 | forward_fetch_submit: 0.03 | forward_all_gather: 19.12 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 113.70 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:18,208] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.17
[2024-07-26 15:36:18,209] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.13 | backward_microstep: 1546.59 | backward_inner_microstep: 1529.18 | backward_allreduce_microstep: 17.35 | step_microstep: 93.14
[2024-07-26 15:36:18,209] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1511.77 | backward: 3061.77 | backward_inner: 3026.08 | backward_allreduce: 35.58 | step: 93.23
 36%|███▋      | 73/200 [07:55<10:16,  4.85s/it]                                                {'loss': 1.5734, 'grad_norm': 0.9894667021138034, 'learning_rate': 1.4669277086172406e-05, 'epoch': 1.8}
 36%|███▋      | 73/200 [07:55<10:16,  4.85s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2563
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:20,474] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:20,554] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.10 | forward_fetch_submit: 0.06 | forward_all_gather: 31.14 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.34 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:36:20,701] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.76 | backward_microstep: 1703.31 | backward_inner_microstep: 1556.10 | backward_allreduce_microstep: 147.14 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2535
[2024-07-26 15:36:22,898] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:22,978] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.93 | forward_fetch_submit: 0.03 | forward_all_gather: 21.88 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 135.54 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:23,311] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.33
[2024-07-26 15:36:23,312] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 755.55 | backward_microstep: 1729.29 | backward_inner_microstep: 1500.30 | backward_allreduce_microstep: 228.94 | step_microstep: 104.74
[2024-07-26 15:36:23,313] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1516.30 | backward: 3432.60 | backward_inner: 3056.41 | backward_allreduce: 376.08 | step: 104.83
 37%|███▋      | 74/200 [08:00<10:21,  4.93s/it]                                                {'loss': 1.7116, 'grad_norm': 1.0360750809904133, 'learning_rate': 1.4525470290445392e-05, 'epoch': 1.83}
 37%|███▋      | 74/200 [08:00<10:21,  4.93s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2515
[2024-07-26 15:36:25,527] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:25,608] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.80 | forward_fetch_submit: 0.06 | forward_all_gather: 27.11 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.68 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:36:25,812] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 755.41 | backward_microstep: 1716.34 | backward_inner_microstep: 1512.81 | backward_allreduce_microstep: 203.45 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:36:28,043] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:28,044] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:28,044] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:28,044] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:28,044] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:28,044] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:28,045] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:28,045] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:28,124] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.68 | forward_fetch_submit: 0.03 | forward_all_gather: 19.78 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.50 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:28,242] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:36:28,243] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.07 | backward_microstep: 1549.35 | backward_inner_microstep: 1531.47 | backward_allreduce_microstep: 17.83 | step_microstep: 100.95
[2024-07-26 15:36:28,243] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1515.45 | backward: 3265.69 | backward_inner: 3044.29 | backward_allreduce: 221.29 | step: 101.04
 38%|███▊      | 75/200 [08:05<10:16,  4.93s/it]                                                {'loss': 1.6588, 'grad_norm': 1.1284727787800537, 'learning_rate': 1.4380476768566825e-05, 'epoch': 1.85}
 38%|███▊      | 75/200 [08:05<10:16,  4.93s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2514
[2024-07-26 15:36:30,419] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:30,420] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:30,420] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:30,420] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:30,420] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:30,420] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:30,420] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:30,420] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:30,501] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.40 | forward_fetch_submit: 0.06 | forward_all_gather: 27.27 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 16.27 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:36:30,520] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 743.15 | backward_microstep: 1506.89 | backward_inner_microstep: 1488.69 | backward_allreduce_microstep: 18.13 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:32,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:32,843] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.80 | forward_fetch_submit: 0.03 | forward_all_gather: 20.81 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 117.06 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:32,958] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:36:32,959] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.10 | backward_microstep: 1556.74 | backward_inner_microstep: 1538.11 | backward_allreduce_microstep: 18.57 | step_microstep: 96.63
[2024-07-26 15:36:32,959] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1506.22 | backward: 3063.63 | backward_inner: 3026.81 | backward_allreduce: 36.71 | step: 96.72
 38%|███▊      | 76/200 [08:09<10:03,  4.87s/it]                                                {'loss': 1.6686, 'grad_norm': 1.7850060285372105, 'learning_rate': 1.4234334542574906e-05, 'epoch': 1.88}
 38%|███▊      | 76/200 [08:09<10:03,  4.87s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2552
[2024-07-26 15:36:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:35,160] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:35,240] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.75 | forward_fetch_submit: 0.06 | forward_all_gather: 26.74 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.21 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:36:35,259] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.30 | backward_microstep: 1524.83 | backward_inner_microstep: 1506.09 | backward_allreduce_microstep: 18.67 | step_microstep: 0.10
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2563
[2024-07-26 15:36:37,523] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:37,524] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:37,524] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:37,524] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:37,524] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:37,524] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:37,524] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:37,524] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:37,604] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 27.68 | forward_fetch_submit: 0.03 | forward_all_gather: 21.71 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 137.14 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.31
[2024-07-26 15:36:37,724] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.35
[2024-07-26 15:36:37,725] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.35 | backward_microstep: 1569.34 | backward_inner_microstep: 1551.39 | backward_allreduce_microstep: 17.89 | step_microstep: 102.99
[2024-07-26 15:36:37,725] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1520.63 | backward: 3094.18 | backward_inner: 3057.50 | backward_allreduce: 36.57 | step: 103.07
 38%|███▊      | 77/200 [08:14<09:54,  4.84s/it]                                                {'loss': 1.5914, 'grad_norm': 0.8916468773977015, 'learning_rate': 1.4087081935735565e-05, 'epoch': 1.9}
 38%|███▊      | 77/200 [08:14<09:54,  4.84s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2514
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:39,893] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:39,962] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.04 | forward_fetch_submit: 0.06 | forward_all_gather: 27.92 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.11 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:36:40,128] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 742.85 | backward_microstep: 1634.02 | backward_inner_microstep: 1468.32 | backward_allreduce_microstep: 165.62 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2603
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:42,385] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:42,465] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.00 | forward_fetch_submit: 0.03 | forward_all_gather: 20.81 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 18.88 | forward_prefetch_submit: 1.02 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:42,579] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.29
[2024-07-26 15:36:42,581] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 784.70 | backward_microstep: 1547.27 | backward_inner_microstep: 1529.74 | backward_allreduce_microstep: 17.47 | step_microstep: 97.87
[2024-07-26 15:36:42,581] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1527.53 | backward: 3181.29 | backward_inner: 2998.09 | backward_allreduce: 183.09 | step: 97.97
 39%|███▉      | 78/200 [08:19<09:50,  4.84s/it]                                                {'loss': 1.72, 'grad_norm': 1.1995795032448535, 'learning_rate': 1.3938757562492873e-05, 'epoch': 1.93}
 39%|███▉      | 78/200 [08:19<09:50,  4.84s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2545
[2024-07-26 15:36:44,860] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:44,861] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:44,861] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:44,861] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:44,861] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:44,861] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:44,861] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:44,861] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:44,941] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.61 | forward_fetch_submit: 0.06 | forward_all_gather: 28.09 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.70 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:36:45,170] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.07 | backward_microstep: 1799.74 | backward_inner_microstep: 1570.83 | backward_allreduce_microstep: 228.84 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:36:47,582] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:47,582] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:47,583] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:47,583] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:47,583] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:47,583] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:47,583] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:47,583] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:47,663] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.90 | forward_fetch_submit: 0.03 | forward_all_gather: 21.88 | backward_fetch_wait: 5.65 | backward_fetch_submit: 0.00 | backward_all_gather: 117.85 | forward_prefetch_submit: 0.97 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:47,778] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.48
[2024-07-26 15:36:47,779] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.68 | backward_microstep: 1717.12 | backward_inner_microstep: 1699.32 | backward_allreduce_microstep: 17.75 | step_microstep: 97.92
[2024-07-26 15:36:47,779] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1535.73 | backward: 3516.86 | backward_inner: 3270.16 | backward_allreduce: 246.59 | step: 98.00
 40%|███▉      | 79/200 [08:24<09:58,  4.95s/it]                                                {'loss': 1.7589, 'grad_norm': 1.1839484411297332, 'learning_rate': 1.378940031834307e-05, 'epoch': 1.95}
 40%|███▉      | 79/200 [08:24<09:58,  4.95s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2536
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:49,986] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:50,066] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.72 | forward_fetch_submit: 0.06 | forward_all_gather: 27.30 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.10 | forward_prefetch_submit: 0.94 | backward_prefetch_wait: 0.26
[2024-07-26 15:36:50,084] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 751.18 | backward_microstep: 1519.56 | backward_inner_microstep: 1501.94 | backward_allreduce_microstep: 17.54 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2539
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:52,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:52,392] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 26.40 | forward_fetch_submit: 0.03 | forward_all_gather: 19.07 | backward_fetch_wait: 5.54 | backward_fetch_submit: 0.00 | backward_all_gather: 136.04 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:52,508] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:36:52,509] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.99 | backward_microstep: 1550.73 | backward_inner_microstep: 1532.95 | backward_allreduce_microstep: 17.73 | step_microstep: 99.25
[2024-07-26 15:36:52,510] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1505.15 | backward: 3070.30 | backward_inner: 3034.91 | backward_allreduce: 35.28 | step: 99.34
 40%|████      | 80/200 [08:29<09:45,  4.88s/it]                                                {'loss': 1.7506, 'grad_norm': 1.0382419825594782, 'learning_rate': 1.3639049369634878e-05, 'epoch': 1.98}
 40%|████      | 80/200 [08:29<09:45,  4.88s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2558
[2024-07-26 15:36:54,737] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:36:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:36:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:36:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:36:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:36:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:36:54,818] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.94 | forward_fetch_submit: 0.06 | forward_all_gather: 27.14 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 16.46 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:36:54,837] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.47 | backward_microstep: 1542.04 | backward_inner_microstep: 1524.12 | backward_allreduce_microstep: 17.85 | step_microstep: 0.08
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2551
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:36:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:36:58,334] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.92 | forward_fetch_submit: 0.03 | forward_all_gather: 19.66 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 44.77 | forward_prefetch_submit: 1.17 | backward_prefetch_wait: 0.30
[2024-07-26 15:36:58,468] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 6.01
[2024-07-26 15:36:58,469] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.63 | backward_microstep: 1531.00 | backward_inner_microstep: 1512.84 | backward_allreduce_microstep: 18.11 | step_microstep: 116.99
[2024-07-26 15:36:58,470] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1534.09 | backward: 3073.05 | backward_inner: 3036.98 | backward_allreduce: 35.96 | step: 117.07
 40%|████      | 81/200 [08:35<10:19,  5.21s/it]                                                {'loss': 1.6335, 'grad_norm': 1.3396789842495886, 'learning_rate': 1.3487744143298822e-05, 'epoch': 2.0}
 40%|████      | 81/200 [08:35<10:19,  5.21s/it][INFO|trainer.py:3819] 2024-07-26 15:36:58,490 >> 
***** Running Evaluation *****
[INFO|trainer.py:3821] 2024-07-26 15:36:58,490 >>   Num examples = 160
[INFO|trainer.py:3824] 2024-07-26 15:36:58,490 >>   Batch size = 8
[2024-07-26 15:36:59,677] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:36:59,677] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:36:59,686] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:36:59,695] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:04,109] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:04,120] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:04,240] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:04,371] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:08,449] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:08,474] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:08,815] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:08,930] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:12,945] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:13,037] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:13,227] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:37:13,251] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2605
[2024-07-26 15:37:19,396] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:37:19,396] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:37:19,396] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 101, numel = 7771070464
[2024-07-26 15:37:19,396] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 101, numel = 7771070464
[2024-07-26 15:37:19,419] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 542.74 | forward_fetch_submit: 0.00 | forward_all_gather: 17.78 | forward_prefetch_submit: 1.08

  0%|          | 0/5 [00:00<?, ?it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2618
[2024-07-26 15:37:20,783] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:37:20,783] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:37:20,783] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:37:20,783] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:37:20,807] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.80 | forward_fetch_submit: 0.00 | forward_all_gather: 17.43 | forward_prefetch_submit: 0.70

 40%|████      | 2/5 [00:01<00:02,  1.44it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:37:22,181] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:37:22,181] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:37:22,181] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:37:22,181] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:37:22,205] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.92 | forward_fetch_submit: 0.00 | forward_all_gather: 16.30 | forward_prefetch_submit: 0.81

 60%|██████    | 3/5 [00:02<00:01,  1.01it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:37:23,584] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:37:23,584] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:37:23,584] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:37:23,584] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:37:23,607] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.97 | forward_fetch_submit: 0.00 | forward_all_gather: 17.92 | forward_prefetch_submit: 0.70

 80%|████████  | 4/5 [00:04<00:01,  1.14s/it][Apetrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:37:26,254] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:37:26,254] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:37:26,254] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:37:26,254] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:37:26,278] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 35.46 | forward_fetch_submit: 0.00 | forward_all_gather: 16.87 | forward_prefetch_submit: 0.86

100%|██████████| 5/5 [00:06<00:00,  1.67s/it][A                                                
                                             [A{'eval_loss': 1.7385432720184326, 'eval_runtime': 27.9887, 'eval_samples_per_second': 5.717, 'eval_steps_per_second': 0.179, 'epoch': 2.0}
 40%|████      | 81/200 [09:03<10:19,  5.21s/it]
100%|██████████| 5/5 [00:07<00:00,  1.67s/it][A
                                             [A[INFO|trainer.py:3503] 2024-07-26 15:37:37,567 >> Saving model checkpoint to work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81
[INFO|configuration_utils.py:472] 2024-07-26 15:37:37,570 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/config.json
[INFO|configuration_utils.py:807] 2024-07-26 15:37:37,570 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/generation_config.json
[INFO|modeling_utils.py:2750] 2024-07-26 15:38:05,571 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 4 checkpoint shards. You can find where each parameters has been saved in the index located at work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2702] 2024-07-26 15:38:05,574 >> tokenizer config file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/tokenizer_config.json
[INFO|tokenization_utils_base.py:2711] 2024-07-26 15:38:05,575 >> Special tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/special_tokens_map.json
[INFO|tokenization_utils_base.py:2762] 2024-07-26 15:38:05,575 >> added tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/added_tokens.json
[2024-07-26 15:38:06,845] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step81 is about to be saved!
[2024-07-26 15:38:09,839] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/global_step81/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-07-26 15:38:09,839] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/global_step81/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-07-26 15:38:15,192] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/global_step81/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-07-26 15:38:15,480] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/global_step81/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-07-26 15:38:16,284] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/global_step81/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-07-26 15:38:16,286] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81/global_step81/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-07-26 15:38:16,365] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step81 is ready now!
[2024-07-26 15:38:17,600] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:17,735] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:17,745] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:17,761] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:21,909] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:22,365] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:22,419] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:22,431] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:25,916] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:26,386] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:26,748] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:26,764] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:29,366] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:30,617] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:30,714] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:38:30,945] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2639
[2024-07-26 15:38:36,991] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:38:36,992] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:38:36,992] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:38:36,992] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:36,992] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:36,992] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:38:36,992] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:38:36,992] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:38:37,070] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 2442.36 | forward_fetch_submit: 0.06 | forward_all_gather: 32.21 | backward_fetch_wait: 5.65 | backward_fetch_submit: 0.00 | backward_all_gather: 19.28 | forward_prefetch_submit: 1.24 | backward_prefetch_wait: 0.25
[2024-07-26 15:38:37,185] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 3095.22 | backward_microstep: 1793.82 | backward_inner_microstep: 1680.06 | backward_allreduce_microstep: 113.67 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2592
[2024-07-26 15:38:39,484] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:38:39,485] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:38:39,485] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:38:39,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:39,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:39,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:38:39,485] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:38:39,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:38:39,564] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.74 | forward_fetch_submit: 0.03 | forward_all_gather: 22.99 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 125.95 | forward_prefetch_submit: 1.00 | backward_prefetch_wait: 0.30
[2024-07-26 15:38:39,888] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.51
[2024-07-26 15:38:39,890] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.73 | backward_microstep: 1814.07 | backward_inner_microstep: 1585.02 | backward_allreduce_microstep: 228.99 | step_microstep: 95.45
[2024-07-26 15:38:39,890] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 3867.92 | backward: 3607.90 | backward_inner: 3265.11 | backward_allreduce: 342.67 | step: 95.54
 41%|████      | 82/200 [10:16<1:07:00, 34.07s/it]                                                  {'loss': 1.6994, 'grad_norm': 1.1767709447431625, 'learning_rate': 1.3335524316508208e-05, 'epoch': 2.02}
 41%|████      | 82/200 [10:16<1:07:00, 34.07s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:38:42,365] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:38:42,365] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:38:42,365] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:38:42,365] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:42,365] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:42,365] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:38:42,366] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:38:42,366] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:38:42,445] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 251.77 | forward_fetch_submit: 0.06 | forward_all_gather: 34.99 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.63 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:38:42,463] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 768.56 | backward_microstep: 1775.33 | backward_inner_microstep: 1757.46 | backward_allreduce_microstep: 17.79 | step_microstep: 0.10
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2587
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:38:44,700] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:38:44,780] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.67 | forward_fetch_submit: 0.03 | forward_all_gather: 23.54 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 139.26 | forward_prefetch_submit: 0.96 | backward_prefetch_wait: 0.31
[2024-07-26 15:38:44,902] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.25
[2024-07-26 15:38:44,904] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.86 | backward_microstep: 1540.15 | backward_inner_microstep: 1522.77 | backward_allreduce_microstep: 17.33 | step_microstep: 105.43
[2024-07-26 15:38:44,904] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1541.40 | backward: 3315.49 | backward_inner: 3280.25 | backward_allreduce: 35.13 | step: 105.53
 42%|████▏     | 83/200 [10:21<49:26, 25.35s/it]                                                  {'loss': 1.6301, 'grad_norm': 1.1300753314913334, 'learning_rate': 1.3182429806274442e-05, 'epoch': 2.05}
 42%|████▏     | 83/200 [10:21<49:26, 25.35s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:38:47,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:38:47,205] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.22 | forward_fetch_submit: 0.06 | forward_all_gather: 29.63 | backward_fetch_wait: 5.82 | backward_fetch_submit: 0.00 | backward_all_gather: 19.58 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:38:47,224] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 755.12 | backward_microstep: 1535.40 | backward_inner_microstep: 1517.37 | backward_allreduce_microstep: 17.95 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2559
[2024-07-26 15:38:49,484] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:38:49,484] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:38:49,485] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:38:49,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:49,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:49,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:38:49,485] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:38:49,485] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:38:49,563] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 27.53 | forward_fetch_submit: 0.03 | forward_all_gather: 24.51 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 132.49 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:38:49,706] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.61
[2024-07-26 15:38:49,707] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.34 | backward_microstep: 1583.64 | backward_inner_microstep: 1550.82 | backward_allreduce_microstep: 32.77 | step_microstep: 110.17
[2024-07-26 15:38:49,707] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1521.43 | backward: 3119.04 | backward_inner: 3068.21 | backward_allreduce: 50.72 | step: 110.26
 42%|████▏     | 84/200 [10:26<37:05, 19.19s/it]                                                {'loss': 1.6273, 'grad_norm': 1.000216268567582, 'learning_rate': 1.3028500758979507e-05, 'epoch': 2.07}
 42%|████▏     | 84/200 [10:26<37:05, 19.19s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2591
[2024-07-26 15:38:51,951] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:38:51,951] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:38:51,952] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:38:51,952] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:51,952] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:51,952] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:38:51,952] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:38:51,952] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:38:52,032] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.19 | forward_fetch_submit: 0.06 | forward_all_gather: 31.86 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 19.47 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:38:52,051] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.37 | backward_microstep: 1547.18 | backward_inner_microstep: 1528.69 | backward_allreduce_microstep: 18.41 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:38:54,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:38:54,367] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.04 | forward_fetch_submit: 0.03 | forward_all_gather: 20.82 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 136.44 | forward_prefetch_submit: 0.91 | backward_prefetch_wait: 0.31
[2024-07-26 15:38:54,483] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:38:54,485] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.51 | backward_microstep: 1553.92 | backward_inner_microstep: 1535.71 | backward_allreduce_microstep: 18.16 | step_microstep: 98.88
[2024-07-26 15:38:54,485] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1523.86 | backward: 3101.11 | backward_inner: 3064.41 | backward_allreduce: 36.58 | step: 98.97
 42%|████▎     | 85/200 [10:31<28:29, 14.87s/it]                                                {'loss': 1.6756, 'grad_norm': 1.0793672981017115, 'learning_rate': 1.2873777539848284e-05, 'epoch': 2.1}
 42%|████▎     | 85/200 [10:31<28:29, 14.87s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2579
[2024-07-26 15:38:56,777] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:38:56,777] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:38:56,777] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:38:56,777] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:56,778] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:56,778] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:38:56,778] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:38:56,778] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:38:56,859] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.48 | forward_fetch_submit: 0.06 | forward_all_gather: 32.29 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 18.63 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.26
[2024-07-26 15:38:56,991] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.11 | backward_microstep: 1714.85 | backward_inner_microstep: 1583.34 | backward_allreduce_microstep: 131.43 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:38:59,223] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:38:59,305] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.07 | forward_fetch_submit: 0.03 | forward_all_gather: 21.90 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 133.39 | forward_prefetch_submit: 1.96 | backward_prefetch_wait: 0.30
[2024-07-26 15:38:59,424] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.46
[2024-07-26 15:38:59,426] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.51 | backward_microstep: 1547.62 | backward_inner_microstep: 1528.71 | backward_allreduce_microstep: 18.85 | step_microstep: 101.72
[2024-07-26 15:38:59,426] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1527.60 | backward: 3262.47 | backward_inner: 3112.07 | backward_allreduce: 150.29 | step: 101.81
 43%|████▎     | 86/200 [10:36<22:35, 11.89s/it]                                                {'loss': 1.7348, 'grad_norm': 1.1048238312912537, 'learning_rate': 1.2718300722363431e-05, 'epoch': 2.12}
 43%|████▎     | 86/200 [10:36<22:35, 11.89s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2562
[2024-07-26 15:39:01,949] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:01,950] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:01,950] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:01,950] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:01,950] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:01,950] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:01,950] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:01,950] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:02,030] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.68 | forward_fetch_submit: 0.06 | forward_all_gather: 32.40 | backward_fetch_wait: 5.68 | backward_fetch_submit: 0.00 | backward_all_gather: 16.53 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:39:02,105] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 786.10 | backward_microstep: 1865.13 | backward_inner_microstep: 1790.83 | backward_allreduce_microstep: 74.22 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2514
[2024-07-26 15:39:04,291] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:04,371] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.94 | forward_fetch_submit: 0.03 | forward_all_gather: 20.84 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 135.48 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:04,490] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.30
[2024-07-26 15:39:04,491] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.94 | backward_microstep: 1508.92 | backward_inner_microstep: 1491.08 | backward_allreduce_microstep: 17.79 | step_microstep: 101.18
[2024-07-26 15:39:04,491] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1539.01 | backward: 3374.05 | backward_inner: 3281.93 | backward_allreduce: 92.01 | step: 101.27
 44%|████▎     | 87/200 [10:41<18:32,  9.84s/it]                                                {'loss': 1.6383, 'grad_norm': 1.0265088529522954, 'learning_rate': 1.2562111077625723e-05, 'epoch': 2.15}
 44%|████▎     | 87/200 [10:41<18:32,  9.84s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2599
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:06,823] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.67 | forward_fetch_submit: 0.06 | forward_all_gather: 30.97 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.61 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:06,842] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.45 | backward_microstep: 1550.79 | backward_inner_microstep: 1532.80 | backward_allreduce_microstep: 17.92 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2536
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:09,032] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:09,112] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.88 | forward_fetch_submit: 0.03 | forward_all_gather: 21.45 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 136.41 | forward_prefetch_submit: 0.79 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:09,228] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:39:09,229] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.07 | backward_microstep: 1517.29 | backward_inner_microstep: 1499.41 | backward_allreduce_microstep: 17.83 | step_microstep: 98.69
[2024-07-26 15:39:09,229] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1516.50 | backward: 3068.09 | backward_inner: 3032.22 | backward_allreduce: 35.75 | step: 98.78
 44%|████▍     | 88/200 [10:46<15:30,  8.31s/it]                                                {'loss': 1.7027, 'grad_norm': 1.1867511318204729, 'learning_rate': 1.2405249563662539e-05, 'epoch': 2.17}
 44%|████▍     | 88/200 [10:46<15:30,  8.31s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2616
[2024-07-26 15:39:11,483] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:11,484] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:11,484] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:11,484] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:11,484] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:11,484] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:11,484] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:11,484] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:11,562] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.59 | forward_fetch_submit: 0.06 | forward_all_gather: 31.73 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.94 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:11,582] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.55 | backward_microstep: 1555.67 | backward_inner_microstep: 1536.90 | backward_allreduce_microstep: 18.69 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2534
[2024-07-26 15:39:13,779] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:13,780] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:13,780] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:13,780] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:13,780] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:13,780] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:13,780] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:13,780] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:13,860] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.24 | forward_fetch_submit: 0.03 | forward_all_gather: 20.76 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 134.70 | forward_prefetch_submit: 0.92 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:13,978] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.40
[2024-07-26 15:39:13,980] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 748.74 | backward_microstep: 1524.52 | backward_inner_microstep: 1506.51 | backward_allreduce_microstep: 17.95 | step_microstep: 101.17
[2024-07-26 15:39:13,980] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1518.27 | backward: 3080.19 | backward_inner: 3043.43 | backward_allreduce: 36.65 | step: 101.27
 44%|████▍     | 89/200 [10:51<13:23,  7.24s/it]                                                {'loss': 1.6069, 'grad_norm': 1.3317546273234249, 'learning_rate': 1.2247757314687296e-05, 'epoch': 2.2}
 44%|████▍     | 89/200 [10:51<13:23,  7.24s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2524
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:16,192] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:16,273] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.19 | forward_fetch_submit: 0.06 | forward_all_gather: 27.82 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 16.11 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:16,488] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.11 | backward_microstep: 1729.82 | backward_inner_microstep: 1515.13 | backward_allreduce_microstep: 214.60 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2651
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:18,778] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:18,858] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.70 | forward_fetch_submit: 0.03 | forward_all_gather: 19.82 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 19.91 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:18,975] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.43
[2024-07-26 15:39:18,977] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 794.32 | backward_microstep: 1570.63 | backward_inner_microstep: 1552.89 | backward_allreduce_microstep: 17.68 | step_microstep: 101.18
[2024-07-26 15:39:18,977] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1546.41 | backward: 3300.45 | backward_inner: 3068.04 | backward_allreduce: 232.30 | step: 101.27
 45%|████▌     | 90/200 [10:56<12:02,  6.57s/it]                                                {'loss': 1.6048, 'grad_norm': 1.5310994221006067, 'learning_rate': 1.2089675630312755e-05, 'epoch': 2.22}
 45%|████▌     | 90/200 [10:56<12:02,  6.57s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2564
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:21,221] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:21,302] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.50 | forward_fetch_submit: 0.06 | forward_all_gather: 33.65 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.40 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:21,488] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 768.59 | backward_microstep: 1716.36 | backward_inner_microstep: 1530.78 | backward_allreduce_microstep: 185.50 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2552
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:24,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:24,189] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.70 | forward_fetch_submit: 0.03 | forward_all_gather: 28.26 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 25.61 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:24,421] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.23
[2024-07-26 15:39:24,422] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 998.24 | backward_microstep: 1809.70 | backward_inner_microstep: 1679.90 | backward_allreduce_microstep: 129.75 | step_microstep: 102.65
[2024-07-26 15:39:24,422] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1766.81 | backward: 3526.07 | backward_inner: 3210.69 | backward_allreduce: 315.26 | step: 102.74
 46%|████▌     | 91/200 [11:01<11:19,  6.23s/it]                                                {'loss': 1.6088, 'grad_norm': 2.1673178665461696, 'learning_rate': 1.1931045964720882e-05, 'epoch': 2.25}
 46%|████▌     | 91/200 [11:01<11:19,  6.23s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2564
[2024-07-26 15:39:26,664] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:26,664] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:26,664] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:26,664] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:26,665] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:26,665] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:26,665] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:26,665] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:26,742] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.95 | forward_fetch_submit: 0.06 | forward_all_gather: 30.93 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.88 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:26,760] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.88 | backward_microstep: 1547.69 | backward_inner_microstep: 1530.20 | backward_allreduce_microstep: 17.41 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2556
[2024-07-26 15:39:29,399] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:29,400] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:29,400] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:29,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:29,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:29,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:29,400] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:29,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:29,479] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 144.69 | forward_fetch_submit: 0.03 | forward_all_gather: 26.19 | backward_fetch_wait: 5.54 | backward_fetch_submit: 0.00 | backward_all_gather: 23.90 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:29,808] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.51
[2024-07-26 15:39:29,809] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 903.51 | backward_microstep: 2015.12 | backward_inner_microstep: 1794.04 | backward_allreduce_microstep: 221.02 | step_microstep: 108.20
[2024-07-26 15:39:29,809] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1668.37 | backward: 3562.82 | backward_inner: 3324.26 | backward_allreduce: 238.44 | step: 108.28
 46%|████▌     | 92/200 [11:06<10:45,  5.98s/it]                                                {'loss': 1.6816, 'grad_norm': 1.1634679808942952, 'learning_rate': 1.177190991579223e-05, 'epoch': 2.27}
 46%|████▌     | 92/200 [11:06<10:45,  5.98s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2538
[2024-07-26 15:39:32,488] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:32,489] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:32,489] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:32,489] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:32,489] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:32,489] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:32,489] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:32,489] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:32,569] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 169.04 | forward_fetch_submit: 0.06 | forward_all_gather: 29.88 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 18.93 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:32,744] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 889.71 | backward_microstep: 2017.49 | backward_inner_microstep: 1843.05 | backward_allreduce_microstep: 174.37 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2583
[2024-07-26 15:39:35,012] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:35,012] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:35,013] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:35,013] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:35,013] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:35,013] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:35,013] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:35,013] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:35,092] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 17.51 | forward_fetch_submit: 0.03 | forward_all_gather: 22.49 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 145.34 | forward_prefetch_submit: 0.91 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:35,217] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.44
[2024-07-26 15:39:35,219] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 777.37 | backward_microstep: 1568.04 | backward_inner_microstep: 1549.37 | backward_allreduce_microstep: 18.61 | step_microstep: 106.82
[2024-07-26 15:39:35,219] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1667.07 | backward: 3585.54 | backward_inner: 3392.44 | backward_allreduce: 192.98 | step: 106.91
 46%|████▋     | 93/200 [11:12<10:21,  5.81s/it]                                                {'loss': 1.5714, 'grad_norm': 1.1068233626519615, 'learning_rate': 1.1612309214197599e-05, 'epoch': 2.3}
 46%|████▋     | 93/200 [11:12<10:21,  5.81s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2587
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:37,490] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:37,569] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.18 | forward_fetch_submit: 0.06 | forward_all_gather: 34.18 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 19.32 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:37,592] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.70 | backward_microstep: 1569.64 | backward_inner_microstep: 1547.55 | backward_allreduce_microstep: 22.01 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2508
[2024-07-26 15:39:39,956] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:39,956] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:39,956] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:39,956] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:39,956] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:39,956] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:39,956] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:39,957] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:40,037] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 173.46 | forward_fetch_submit: 0.03 | forward_all_gather: 21.52 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 137.92 | forward_prefetch_submit: 0.83 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:40,193] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:39:40,194] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.04 | backward_microstep: 1702.86 | backward_inner_microstep: 1661.30 | backward_allreduce_microstep: 41.50 | step_microstep: 115.14
[2024-07-26 15:39:40,195] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1537.72 | backward: 3272.50 | backward_inner: 3208.86 | backward_allreduce: 63.52 | step: 115.22
 47%|████▋     | 94/200 [11:17<09:49,  5.56s/it]                                                {'loss': 1.4889, 'grad_norm': 1.551622485463498, 'learning_rate': 1.1452285712454905e-05, 'epoch': 2.32}
 47%|████▋     | 94/200 [11:17<09:49,  5.56s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2589
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:42,527] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.06 | forward_fetch_submit: 0.06 | forward_all_gather: 32.04 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.33 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:39:42,545] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.48 | backward_microstep: 1546.43 | backward_inner_microstep: 1528.40 | backward_allreduce_microstep: 17.96 | step_microstep: 0.08
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2544
[2024-07-26 15:39:45,070] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:45,071] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:45,071] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:45,071] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:45,071] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:45,071] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:45,071] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:45,071] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:45,138] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.18 | forward_fetch_submit: 0.03 | forward_all_gather: 23.70 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 120.56 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:45,252] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:39:45,253] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.08 | backward_microstep: 1821.36 | backward_inner_microstep: 1803.44 | backward_allreduce_microstep: 17.86 | step_microstep: 97.04
[2024-07-26 15:39:45,254] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1541.54 | backward: 3367.80 | backward_inner: 3331.86 | backward_allreduce: 35.83 | step: 97.12
 48%|████▊     | 95/200 [11:22<09:27,  5.41s/it]                                                {'loss': 1.5575, 'grad_norm': 1.04719476054582, 'learning_rate': 1.1291881373954066e-05, 'epoch': 2.35}
 48%|████▊     | 95/200 [11:22<09:27,  5.41s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2565
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:47,598] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.78 | forward_fetch_submit: 0.06 | forward_all_gather: 33.33 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.74 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:39:47,616] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.64 | backward_microstep: 1559.61 | backward_inner_microstep: 1542.53 | backward_allreduce_microstep: 17.01 | step_microstep: 0.07
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2569
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:49,905] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:49,972] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 17.21 | forward_fetch_submit: 0.03 | forward_all_gather: 21.50 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 137.31 | forward_prefetch_submit: 1.00 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:50,094] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.61
[2024-07-26 15:39:50,097] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 827.19 | backward_microstep: 1527.89 | backward_inner_microstep: 1508.70 | backward_allreduce_microstep: 19.14 | step_microstep: 104.55
[2024-07-26 15:39:50,097] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1602.81 | backward: 3087.50 | backward_inner: 3051.24 | backward_allreduce: 36.15 | step: 104.63
 48%|████▊     | 96/200 [11:27<09:04,  5.24s/it]                                                {'loss': 1.6172, 'grad_norm': 1.0363375948473716, 'learning_rate': 1.1131138261952845e-05, 'epoch': 2.37}
 48%|████▊     | 96/200 [11:27<09:04,  5.24s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2568
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:52,432] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.49 | forward_fetch_submit: 0.06 | forward_all_gather: 34.61 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 20.03 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:39:52,451] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.65 | backward_microstep: 1553.60 | backward_inner_microstep: 1535.59 | backward_allreduce_microstep: 17.93 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2523
[2024-07-26 15:39:54,657] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:54,738] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.61 | forward_fetch_submit: 0.03 | forward_all_gather: 20.93 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 134.23 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:54,855] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.46
[2024-07-26 15:39:54,856] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 748.25 | backward_microstep: 1534.89 | backward_inner_microstep: 1516.83 | backward_allreduce_microstep: 18.00 | step_microstep: 99.88
[2024-07-26 15:39:54,857] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1520.87 | backward: 3088.49 | backward_inner: 3052.44 | backward_allreduce: 35.93 | step: 99.96
 48%|████▊     | 97/200 [11:31<08:44,  5.10s/it]                                                {'loss': 1.6824, 'grad_norm': 1.1029514198717696, 'learning_rate': 1.0970098528546482e-05, 'epoch': 2.4}
 48%|████▊     | 97/200 [11:31<08:44,  5.10s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2568
[2024-07-26 15:39:57,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:39:57,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:39:57,110] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:39:57,110] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:57,111] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:57,111] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:39:57,111] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:39:57,111] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:39:57,191] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.56 | forward_fetch_submit: 0.06 | forward_all_gather: 34.38 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.27 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.25
[2024-07-26 15:39:57,209] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.86 | backward_microstep: 1553.21 | backward_inner_microstep: 1535.26 | backward_allreduce_microstep: 17.87 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2524
[2024-07-26 15:39:59,422] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:39:59,422] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:39:59,423] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:39:59,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:39:59,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:39:59,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:39:59,423] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:39:59,423] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:39:59,504] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.53 | forward_fetch_submit: 0.03 | forward_all_gather: 20.43 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 135.58 | forward_prefetch_submit: 0.92 | backward_prefetch_wait: 0.30
[2024-07-26 15:39:59,625] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:39:59,626] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.04 | backward_microstep: 1534.98 | backward_inner_microstep: 1515.63 | backward_allreduce_microstep: 19.28 | step_microstep: 101.97
[2024-07-26 15:39:59,626] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1528.89 | backward: 3088.19 | backward_inner: 3050.91 | backward_allreduce: 37.17 | step: 102.05
 49%|████▉     | 98/200 [11:36<08:29,  5.00s/it]                                                {'loss': 1.6966, 'grad_norm': 1.2509903751863405, 'learning_rate': 1.0808804403614044e-05, 'epoch': 2.42}
 49%|████▉     | 98/200 [11:36<08:29,  5.00s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2537
[2024-07-26 15:40:02,043] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:02,044] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:02,044] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:02,044] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:02,044] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:02,044] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:02,044] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:02,044] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:02,121] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 128.21 | forward_fetch_submit: 0.06 | forward_all_gather: 30.48 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 16.80 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:40:02,140] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 919.40 | backward_microstep: 1567.40 | backward_inner_microstep: 1549.21 | backward_allreduce_microstep: 18.09 | step_microstep: 0.18
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2508
[2024-07-26 15:40:04,335] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:04,336] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:04,336] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:04,336] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:04,336] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:04,336] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:04,336] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:04,336] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:04,418] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.03 | forward_fetch_submit: 0.03 | forward_all_gather: 21.07 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 135.46 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:04,775] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.82
[2024-07-26 15:40:04,777] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 744.97 | backward_microstep: 1758.35 | backward_inner_microstep: 1511.12 | backward_allreduce_microstep: 247.16 | step_microstep: 110.85
[2024-07-26 15:40:04,777] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1664.36 | backward: 3325.76 | backward_inner: 3060.36 | backward_allreduce: 265.27 | step: 111.02
 50%|████▉     | 99/200 [11:41<08:29,  5.04s/it]                                                {'loss': 1.5735, 'grad_norm': 1.1758909149925305, 'learning_rate': 1.0647298183744359e-05, 'epoch': 2.44}
 50%|████▉     | 99/200 [11:41<08:29,  5.04s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2575
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:07,460] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:07,539] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 190.12 | forward_fetch_submit: 0.06 | forward_all_gather: 34.64 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 20.43 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:40:07,558] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 895.15 | backward_microstep: 1857.06 | backward_inner_microstep: 1839.14 | backward_allreduce_microstep: 17.84 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2549
[2024-07-26 15:40:09,764] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:09,845] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.73 | forward_fetch_submit: 0.03 | forward_all_gather: 21.07 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 135.47 | forward_prefetch_submit: 1.02 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:09,972] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.45
[2024-07-26 15:40:09,973] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.41 | backward_microstep: 1531.50 | backward_inner_microstep: 1512.81 | backward_allreduce_microstep: 18.63 | step_microstep: 108.68
[2024-07-26 15:40:09,973] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1648.55 | backward: 3388.56 | backward_inner: 3351.97 | backward_allreduce: 36.48 | step: 108.77
 50%|█████     | 100/200 [11:47<08:28,  5.09s/it]                                                 {'loss': 1.658, 'grad_norm': 1.1412864032744328, 'learning_rate': 1.0485622221144485e-05, 'epoch': 2.47}
 50%|█████     | 100/200 [11:47<08:28,  5.09s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:12,294] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.25 | forward_fetch_submit: 0.06 | forward_all_gather: 31.68 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.32 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:40:12,313] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.59 | backward_microstep: 1544.01 | backward_inner_microstep: 1525.87 | backward_allreduce_microstep: 18.07 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2558
[2024-07-26 15:40:14,554] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:14,635] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.33 | forward_fetch_submit: 0.03 | forward_all_gather: 20.66 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 47.96 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:14,759] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:40:14,761] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.49 | backward_microstep: 1553.94 | backward_inner_microstep: 1536.10 | backward_allreduce_microstep: 17.78 | step_microstep: 107.52
[2024-07-26 15:40:14,761] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1532.05 | backward: 3097.95 | backward_inner: 3061.99 | backward_allreduce: 35.85 | step: 107.61
 50%|█████     | 101/200 [11:51<08:14,  5.00s/it]                                                 {'loss': 1.5443, 'grad_norm': 1.0569025721298415, 'learning_rate': 1.0323818912533561e-05, 'epoch': 2.49}
 50%|█████     | 101/200 [11:51<08:14,  5.00s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2532
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:16,994] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:17,073] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.13 | forward_fetch_submit: 0.06 | forward_all_gather: 26.20 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.35 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:40:17,095] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.31 | backward_microstep: 1544.24 | backward_inner_microstep: 1523.22 | backward_allreduce_microstep: 20.94 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2532
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:19,286] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:19,365] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.73 | forward_fetch_submit: 0.03 | forward_all_gather: 20.54 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.53 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:19,478] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:40:19,479] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.63 | backward_microstep: 1511.95 | backward_inner_microstep: 1494.38 | backward_allreduce_microstep: 17.51 | step_microstep: 96.03
[2024-07-26 15:40:19,480] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1515.91 | backward: 3056.21 | backward_inner: 3017.62 | backward_allreduce: 38.45 | step: 96.12
 51%|█████     | 102/200 [11:56<08:01,  4.91s/it]                                                 {'loss': 1.6243, 'grad_norm': 1.1780941729701921, 'learning_rate': 1.0161930688025018e-05, 'epoch': 2.52}
 51%|█████     | 102/200 [11:56<08:01,  4.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2583
[2024-07-26 15:40:21,759] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:21,759] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:21,760] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:21,760] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:21,760] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:21,760] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:21,760] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:21,760] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:21,841] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.74 | forward_fetch_submit: 0.06 | forward_all_gather: 33.31 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.46 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:40:22,008] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 778.60 | backward_microstep: 1723.64 | backward_inner_microstep: 1556.56 | backward_allreduce_microstep: 167.00 | step_microstep: 0.10
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2510
[2024-07-26 15:40:24,195] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:24,196] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:24,196] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:24,196] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:24,196] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:24,196] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:24,196] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:24,196] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:24,263] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.90 | forward_fetch_submit: 0.03 | forward_all_gather: 21.90 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 134.89 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:24,413] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.37
[2024-07-26 15:40:24,415] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.43 | backward_microstep: 1514.56 | backward_inner_microstep: 1484.95 | backward_allreduce_microstep: 29.55 | step_microstep: 121.58
[2024-07-26 15:40:24,415] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1525.01 | backward: 3238.21 | backward_inner: 3041.53 | backward_allreduce: 196.56 | step: 121.68
 52%|█████▏    | 103/200 [12:01<07:57,  4.92s/it]                                                 {'loss': 1.5189, 'grad_norm': 1.6053278405811071, 'learning_rate': 1e-05, 'epoch': 2.54}
 52%|█████▏    | 103/200 [12:01<07:57,  4.92s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2535
[2024-07-26 15:40:26,966] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:26,966] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:26,966] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:26,966] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:26,967] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:26,967] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:26,967] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:26,967] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:27,034] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 189.60 | forward_fetch_submit: 0.06 | forward_all_gather: 28.63 | backward_fetch_wait: 5.68 | backward_fetch_submit: 0.00 | backward_all_gather: 16.22 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:40:27,053] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.23 | backward_microstep: 1862.56 | backward_inner_microstep: 1844.16 | backward_allreduce_microstep: 18.33 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2659
[2024-07-26 15:40:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:29,349] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:29,428] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.51 | forward_fetch_submit: 0.03 | forward_all_gather: 19.70 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 20.84 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:29,547] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.55
[2024-07-26 15:40:29,548] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 794.05 | backward_microstep: 1577.93 | backward_inner_microstep: 1559.28 | backward_allreduce_microstep: 18.59 | step_microstep: 100.56
[2024-07-26 15:40:29,548] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1543.27 | backward: 3440.50 | backward_inner: 3403.46 | backward_allreduce: 36.93 | step: 100.65
 52%|█████▏    | 104/200 [12:06<07:58,  4.98s/it]                                                 {'loss': 1.5368, 'grad_norm': 1.1448501161370286, 'learning_rate': 9.838069311974986e-06, 'epoch': 2.57}
 52%|█████▏    | 104/200 [12:06<07:58,  4.98s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2595
[2024-07-26 15:40:31,790] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:31,790] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:31,790] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:31,791] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:31,791] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:31,791] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:31,791] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:31,791] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:31,870] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.63 | forward_fetch_submit: 0.06 | forward_all_gather: 31.30 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.86 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:40:31,889] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.43 | backward_microstep: 1546.70 | backward_inner_microstep: 1528.76 | backward_allreduce_microstep: 17.86 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2510
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:34,149] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:34,230] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 40.86 | forward_fetch_submit: 0.03 | forward_all_gather: 25.66 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 136.01 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:34,368] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.61
[2024-07-26 15:40:34,369] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.80 | backward_microstep: 1588.48 | backward_inner_microstep: 1558.90 | backward_allreduce_microstep: 29.52 | step_microstep: 109.26
[2024-07-26 15:40:34,369] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1529.21 | backward: 3135.18 | backward_inner: 3087.68 | backward_allreduce: 47.38 | step: 109.34
 52%|█████▎    | 105/200 [12:11<07:48,  4.94s/it]                                                 {'loss': 1.612, 'grad_norm': 1.2181861335899042, 'learning_rate': 9.676181087466444e-06, 'epoch': 2.59}
 52%|█████▎    | 105/200 [12:11<07:48,  4.94s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2563
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:36,607] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:36,687] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.95 | forward_fetch_submit: 0.06 | forward_all_gather: 30.98 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.19 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.25
[2024-07-26 15:40:36,705] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.28 | backward_microstep: 1545.82 | backward_inner_microstep: 1528.02 | backward_allreduce_microstep: 17.72 | step_microstep: 0.08
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2504
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:38,909] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:38,977] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.15 | forward_fetch_submit: 0.03 | forward_all_gather: 22.97 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.68 | forward_prefetch_submit: 0.91 | backward_prefetch_wait: 0.31
[2024-07-26 15:40:39,122] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:40:39,123] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.29 | backward_microstep: 1536.67 | backward_inner_microstep: 1497.76 | backward_allreduce_microstep: 38.86 | step_microstep: 107.09
[2024-07-26 15:40:39,124] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1516.54 | backward: 3082.49 | backward_inner: 3025.80 | backward_allreduce: 56.58 | step: 107.18
 53%|█████▎    | 106/200 [12:16<07:38,  4.88s/it]                                                 {'loss': 1.5715, 'grad_norm': 1.1783327053593275, 'learning_rate': 9.514377778855521e-06, 'epoch': 2.62}
 53%|█████▎    | 106/200 [12:16<07:38,  4.88s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:40:41,351] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:41,432] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.10 | forward_fetch_submit: 0.06 | forward_all_gather: 30.92 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.14 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:40:41,450] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.29 | backward_microstep: 1538.51 | backward_inner_microstep: 1520.50 | backward_allreduce_microstep: 17.93 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:40:43,784] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:43,784] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:43,784] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:43,784] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:43,784] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:43,784] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:43,785] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:43,785] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:43,864] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.43 | forward_fetch_submit: 0.03 | forward_all_gather: 21.96 | backward_fetch_wait: 5.53 | backward_fetch_submit: 0.00 | backward_all_gather: 119.31 | forward_prefetch_submit: 1.06 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:44,008] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:40:44,009] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.03 | backward_microstep: 1682.14 | backward_inner_microstep: 1642.85 | backward_allreduce_microstep: 39.23 | step_microstep: 105.07
[2024-07-26 15:40:44,009] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1511.30 | backward: 3220.65 | backward_inner: 3163.38 | backward_allreduce: 57.17 | step: 105.16
 54%|█████▎    | 107/200 [12:21<07:34,  4.88s/it]                                                 {'loss': 1.5478, 'grad_norm': 1.320594463697376, 'learning_rate': 9.352701816255643e-06, 'epoch': 2.64}
 54%|█████▎    | 107/200 [12:21<07:34,  4.88s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2562
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:46,330] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:46,397] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 41.76 | forward_fetch_submit: 0.06 | forward_all_gather: 33.79 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.43 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:40:46,607] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 782.01 | backward_microstep: 1789.85 | backward_inner_microstep: 1580.27 | backward_allreduce_microstep: 209.51 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2539
[2024-07-26 15:40:49,090] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:49,090] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:49,091] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:49,091] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:49,091] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:49,091] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:49,091] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:49,091] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:49,171] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.92 | forward_fetch_submit: 0.03 | forward_all_gather: 20.95 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 116.95 | forward_prefetch_submit: 0.97 | backward_prefetch_wait: 0.84
[2024-07-26 15:40:49,374] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:40:49,376] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.34 | backward_microstep: 1877.77 | backward_inner_microstep: 1780.36 | backward_allreduce_microstep: 97.36 | step_microstep: 107.25
[2024-07-26 15:40:49,376] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1543.33 | backward: 3667.63 | backward_inner: 3360.64 | backward_allreduce: 306.88 | step: 107.34
 54%|█████▍    | 108/200 [12:26<07:42,  5.03s/it]                                                 {'loss': 1.5023, 'grad_norm': 1.1617953347290455, 'learning_rate': 9.19119559638596e-06, 'epoch': 2.67}
 54%|█████▍    | 108/200 [12:26<07:42,  5.03s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2570
[2024-07-26 15:40:51,621] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:51,621] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:51,622] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:51,622] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:51,622] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:51,622] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:51,622] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:51,622] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:51,696] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.46 | forward_fetch_submit: 0.06 | forward_all_gather: 31.14 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.27 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:40:51,716] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.47 | backward_microstep: 1550.91 | backward_inner_microstep: 1531.99 | backward_allreduce_microstep: 18.83 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2520
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:53,919] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:53,998] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.44 | forward_fetch_submit: 0.03 | forward_all_gather: 21.09 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 136.04 | forward_prefetch_submit: 1.19 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:54,112] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.31
[2024-07-26 15:40:54,113] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 747.81 | backward_microstep: 1530.10 | backward_inner_microstep: 1512.44 | backward_allreduce_microstep: 17.61 | step_microstep: 96.91
[2024-07-26 15:40:54,114] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1510.26 | backward: 3081.02 | backward_inner: 3044.45 | backward_allreduce: 36.45 | step: 97.00
 55%|█████▍    | 109/200 [12:31<07:29,  4.94s/it]                                                 {'loss': 1.5198, 'grad_norm': 1.292539720738421, 'learning_rate': 9.02990147145352e-06, 'epoch': 2.69}
 55%|█████▍    | 109/200 [12:31<07:29,  4.94s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2603
[2024-07-26 15:40:56,376] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:40:56,377] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:40:56,377] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:40:56,377] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:56,377] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:56,377] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:40:56,377] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:40:56,377] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:40:56,457] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.88 | forward_fetch_submit: 0.06 | forward_all_gather: 34.33 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.17 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:40:56,475] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.87 | backward_microstep: 1558.80 | backward_inner_microstep: 1540.90 | backward_allreduce_microstep: 17.81 | step_microstep: 0.08
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2518
[2024-07-26 15:40:58,673] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:40:58,674] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:40:58,674] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:40:58,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:40:58,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:40:58,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:40:58,674] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:40:58,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:40:58,742] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.08 | forward_fetch_submit: 0.03 | forward_all_gather: 23.17 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 130.23 | forward_prefetch_submit: 0.78 | backward_prefetch_wait: 0.30
[2024-07-26 15:40:58,876] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:40:58,878] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 744.56 | backward_microstep: 1527.61 | backward_inner_microstep: 1501.09 | backward_allreduce_microstep: 26.47 | step_microstep: 108.97
[2024-07-26 15:40:58,878] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1519.40 | backward: 3086.41 | backward_inner: 3042.00 | backward_allreduce: 44.30 | step: 109.06
 55%|█████▌    | 110/200 [12:35<07:19,  4.89s/it]                                                 {'loss': 1.5071, 'grad_norm': 1.1670681474784763, 'learning_rate': 8.868861738047158e-06, 'epoch': 2.72}
 55%|█████▌    | 110/200 [12:35<07:19,  4.89s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2548
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:01,108] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:01,190] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.67 | forward_fetch_submit: 0.06 | forward_all_gather: 27.61 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.28 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:01,230] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.51 | backward_microstep: 1564.17 | backward_inner_microstep: 1525.39 | backward_allreduce_microstep: 38.68 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:41:03,474] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:03,474] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:03,474] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:03,474] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:03,475] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:03,475] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:03,475] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:03,475] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:03,556] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.61 | forward_fetch_submit: 0.03 | forward_all_gather: 20.91 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 118.09 | forward_prefetch_submit: 1.05 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:03,805] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:41:03,807] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.17 | backward_microstep: 1679.73 | backward_inner_microstep: 1532.13 | backward_allreduce_microstep: 147.54 | step_microstep: 102.88
[2024-07-26 15:41:03,807] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1530.66 | backward: 3243.90 | backward_inner: 3057.55 | backward_allreduce: 186.23 | step: 102.97
 56%|█████▌    | 111/200 [12:40<07:16,  4.90s/it]                                                 {'loss': 1.4852, 'grad_norm': 1.2399043263275504, 'learning_rate': 8.708118626045939e-06, 'epoch': 2.74}
 56%|█████▌    | 111/200 [12:40<07:16,  4.90s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:41:06,059] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:06,059] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:06,059] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:06,059] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:06,059] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:06,059] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:06,060] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:06,060] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:06,140] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.66 | forward_fetch_submit: 0.06 | forward_all_gather: 33.09 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.16 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:06,159] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.55 | backward_microstep: 1554.76 | backward_inner_microstep: 1536.71 | backward_allreduce_microstep: 17.97 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2570
[2024-07-26 15:41:08,707] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:08,707] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:08,707] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:08,707] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:08,707] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:08,708] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:08,708] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:08,708] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:08,775] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.55 | forward_fetch_submit: 0.03 | forward_all_gather: 20.30 | backward_fetch_wait: 5.65 | backward_fetch_submit: 0.00 | backward_all_gather: 21.08 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:08,926] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.90
[2024-07-26 15:41:08,927] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.74 | backward_microstep: 1873.94 | backward_inner_microstep: 1834.17 | backward_allreduce_microstep: 39.71 | step_microstep: 111.76
[2024-07-26 15:41:08,928] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1531.27 | backward: 3428.70 | backward_inner: 3370.90 | backward_allreduce: 57.69 | step: 111.85
 56%|█████▌    | 112/200 [12:45<07:17,  4.97s/it]                                                 {'loss': 1.5794, 'grad_norm': 1.2423576799050686, 'learning_rate': 8.5477142875451e-06, 'epoch': 2.77}
 56%|█████▌    | 112/200 [12:45<07:17,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2571
[2024-07-26 15:41:11,181] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:11,262] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.42 | forward_fetch_submit: 0.06 | forward_all_gather: 34.46 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.31 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:11,280] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.30 | backward_microstep: 1554.77 | backward_inner_microstep: 1536.92 | backward_allreduce_microstep: 17.77 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:41:13,479] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:13,480] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:13,480] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:13,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:13,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:13,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:13,480] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:13,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:13,560] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.46 | forward_fetch_submit: 0.03 | forward_all_gather: 20.47 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 135.71 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:13,675] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:41:13,676] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.13 | backward_microstep: 1526.49 | backward_inner_microstep: 1508.81 | backward_allreduce_microstep: 17.62 | step_microstep: 97.95
[2024-07-26 15:41:13,677] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1519.41 | backward: 3081.25 | backward_inner: 3045.75 | backward_allreduce: 35.40 | step: 98.04
 56%|█████▋    | 113/200 [12:50<07:06,  4.90s/it]                                                 {'loss': 1.6737, 'grad_norm': 1.1264129559662934, 'learning_rate': 8.387690785802403e-06, 'epoch': 2.79}
 56%|█████▋    | 113/200 [12:50<07:06,  4.90s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2572
[2024-07-26 15:41:15,914] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:15,914] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:15,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:15,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:15,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:15,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:15,915] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:15,915] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:15,995] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.03 | forward_fetch_submit: 0.06 | forward_all_gather: 32.47 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.50 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:16,013] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.03 | backward_microstep: 1543.74 | backward_inner_microstep: 1526.16 | backward_allreduce_microstep: 17.50 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2535
[2024-07-26 15:41:18,251] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:18,251] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:18,251] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:18,251] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:18,251] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:18,251] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:18,252] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:18,252] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:18,332] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.34 | forward_fetch_submit: 0.03 | forward_all_gather: 22.72 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 137.69 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:18,464] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.42
[2024-07-26 15:41:18,465] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.43 | backward_microstep: 1561.28 | backward_inner_microstep: 1537.34 | backward_allreduce_microstep: 23.89 | step_microstep: 109.46
[2024-07-26 15:41:18,466] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1527.45 | backward: 3105.02 | backward_inner: 3063.52 | backward_allreduce: 41.40 | step: 109.54
 57%|█████▋    | 114/200 [12:55<06:58,  4.87s/it]                                                 {'loss': 1.4945, 'grad_norm': 1.1413560133203053, 'learning_rate': 8.228090084207773e-06, 'epoch': 2.81}
 57%|█████▋    | 114/200 [12:55<06:58,  4.87s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2567
[2024-07-26 15:41:20,724] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:20,725] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:20,725] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:20,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:20,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:20,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:20,725] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:20,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:20,804] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.39 | forward_fetch_submit: 0.06 | forward_all_gather: 34.25 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.78 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:20,851] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.60 | backward_microstep: 1588.45 | backward_inner_microstep: 1542.35 | backward_allreduce_microstep: 46.02 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2545
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:23,075] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:23,155] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.57 | forward_fetch_submit: 0.03 | forward_all_gather: 20.31 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 48.34 | forward_prefetch_submit: 1.02 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:23,272] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:41:23,273] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.02 | backward_microstep: 1532.78 | backward_inner_microstep: 1514.95 | backward_allreduce_microstep: 17.78 | step_microstep: 99.55
[2024-07-26 15:41:23,273] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1537.60 | backward: 3121.24 | backward_inner: 3057.32 | backward_allreduce: 63.81 | step: 99.64
 57%|█████▊    | 115/200 [13:00<06:52,  4.85s/it]                                                 {'loss': 1.6815, 'grad_norm': 1.1885341814118815, 'learning_rate': 8.068954035279121e-06, 'epoch': 2.84}
 57%|█████▊    | 115/200 [13:00<06:52,  4.85s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2550
[2024-07-26 15:41:25,513] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:25,513] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:25,513] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:25,513] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:25,513] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:25,514] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:25,514] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:25,514] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:25,593] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.06 | forward_fetch_submit: 0.06 | forward_all_gather: 27.37 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.38 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:25,755] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.13 | backward_microstep: 1697.42 | backward_inner_microstep: 1536.81 | backward_allreduce_microstep: 160.53 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2567
[2024-07-26 15:41:27,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:27,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:27,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:27,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:27,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:27,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:27,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:27,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:28,060] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.32 | forward_fetch_submit: 0.03 | forward_all_gather: 19.86 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 134.28 | forward_prefetch_submit: 0.90 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:28,337] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.23
[2024-07-26 15:41:28,339] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.08 | backward_microstep: 1694.59 | backward_inner_microstep: 1519.90 | backward_allreduce_microstep: 174.63 | step_microstep: 103.89
[2024-07-26 15:41:28,339] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1519.19 | backward: 3392.01 | backward_inner: 3056.73 | backward_allreduce: 335.17 | step: 103.98
 58%|█████▊    | 116/200 [13:05<06:52,  4.91s/it]                                                 {'loss': 1.5621, 'grad_norm': 1.223868336640778, 'learning_rate': 7.91032436968725e-06, 'epoch': 2.86}
 58%|█████▊    | 116/200 [13:05<06:52,  4.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2578
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:30,837] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.76 | forward_fetch_submit: 0.06 | forward_all_gather: 33.85 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.40 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:31,032] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 945.37 | backward_microstep: 1721.29 | backward_inner_microstep: 1527.33 | backward_allreduce_microstep: 193.88 | step_microstep: 0.10
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2537
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:33,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:33,324] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.14 | forward_fetch_submit: 0.03 | forward_all_gather: 21.25 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 137.33 | forward_prefetch_submit: 1.11 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:33,438] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.19
[2024-07-26 15:41:33,439] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 754.62 | backward_microstep: 1529.87 | backward_inner_microstep: 1512.10 | backward_allreduce_microstep: 17.71 | step_microstep: 97.17
[2024-07-26 15:41:33,439] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1699.97 | backward: 3251.17 | backward_inner: 3039.45 | backward_allreduce: 211.60 | step: 97.28
 58%|█████▊    | 117/200 [13:10<06:52,  4.97s/it]                                                 {'loss': 1.483, 'grad_norm': 1.2394634520463488, 'learning_rate': 7.752242685312709e-06, 'epoch': 2.89}
 58%|█████▊    | 117/200 [13:10<06:52,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2606
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:35,772] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.48 | forward_fetch_submit: 0.06 | forward_all_gather: 30.68 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 19.92 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:35,791] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.83 | backward_microstep: 1555.99 | backward_inner_microstep: 1538.10 | backward_allreduce_microstep: 17.82 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2522
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:38,007] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:38,087] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.80 | forward_fetch_submit: 0.03 | forward_all_gather: 22.24 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.21 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:38,216] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:41:38,218] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.21 | backward_microstep: 1545.56 | backward_inner_microstep: 1522.08 | backward_allreduce_microstep: 23.42 | step_microstep: 106.64
[2024-07-26 15:41:38,218] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1520.01 | backward: 3101.55 | backward_inner: 3060.21 | backward_allreduce: 41.24 | step: 106.72
 59%|█████▉    | 118/200 [13:15<06:42,  4.91s/it]                                                 {'loss': 1.6171, 'grad_norm': 1.2365539328346289, 'learning_rate': 7.594750436337467e-06, 'epoch': 2.91}
 59%|█████▉    | 118/200 [13:15<06:42,  4.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2555
[2024-07-26 15:41:40,434] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:40,434] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:40,434] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:40,434] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:40,435] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:40,435] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:40,435] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:40,435] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:40,515] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.62 | forward_fetch_submit: 0.06 | forward_all_gather: 27.04 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.33 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:41:40,534] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 754.87 | backward_microstep: 1535.45 | backward_inner_microstep: 1517.12 | backward_allreduce_microstep: 18.26 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2516
[2024-07-26 15:41:42,732] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:42,732] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:42,732] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:42,732] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:42,732] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:42,733] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:42,733] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:42,733] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:42,812] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.89 | forward_fetch_submit: 0.03 | forward_all_gather: 20.94 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 137.29 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:42,951] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:41:42,952] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 745.83 | backward_microstep: 1541.50 | backward_inner_microstep: 1509.71 | backward_allreduce_microstep: 31.74 | step_microstep: 107.97
[2024-07-26 15:41:42,952] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1500.68 | backward: 3076.96 | backward_inner: 3026.84 | backward_allreduce: 50.01 | step: 108.05
 60%|█████▉    | 119/200 [13:19<06:33,  4.86s/it]                                                 {'loss': 1.591, 'grad_norm': 1.4450012344496332, 'learning_rate': 7.4378889223742766e-06, 'epoch': 2.94}
 60%|█████▉    | 119/200 [13:19<06:33,  4.86s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2539
[2024-07-26 15:41:45,192] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:45,193] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:45,193] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:45,193] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:45,193] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:45,193] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:45,193] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:45,193] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:45,273] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 27.00 | forward_fetch_submit: 0.06 | forward_all_gather: 29.16 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.41 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:41:45,314] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.28 | backward_microstep: 1570.93 | backward_inner_microstep: 1531.31 | backward_allreduce_microstep: 39.55 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2573
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:47,640] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:47,720] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.26 | forward_fetch_submit: 0.03 | forward_all_gather: 20.95 | backward_fetch_wait: 5.51 | backward_fetch_submit: 0.00 | backward_all_gather: 117.00 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:47,911] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.40
[2024-07-26 15:41:47,913] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.07 | backward_microstep: 1704.96 | backward_inner_microstep: 1617.46 | backward_allreduce_microstep: 87.44 | step_microstep: 104.88
[2024-07-26 15:41:47,913] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1531.33 | backward: 3275.90 | backward_inner: 3148.79 | backward_allreduce: 127.00 | step: 104.97
 60%|██████    | 120/200 [13:24<06:31,  4.89s/it]                                                 {'loss': 1.4469, 'grad_norm': 1.3150936854418573, 'learning_rate': 7.2816992776365714e-06, 'epoch': 2.96}
 60%|██████    | 120/200 [13:24<06:31,  4.89s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:50,354] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:50,434] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.70 | forward_fetch_submit: 0.06 | forward_all_gather: 30.96 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 18.54 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:41:50,498] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.62 | backward_microstep: 1788.28 | backward_inner_microstep: 1725.02 | backward_allreduce_microstep: 63.19 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2510
[2024-07-26 15:41:52,807] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:41:52,807] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:41:52,808] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:41:52,808] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:52,808] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:52,808] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:41:52,808] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:41:52,808] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:41:52,889] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.72 | forward_fetch_submit: 0.03 | forward_all_gather: 19.56 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 28.43 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.30
[2024-07-26 15:41:53,127] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.27
[2024-07-26 15:41:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.08 | backward_microstep: 1728.71 | backward_inner_microstep: 1599.05 | backward_allreduce_microstep: 129.60 | step_microstep: 108.96
[2024-07-26 15:41:53,128] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1540.67 | backward: 3517.00 | backward_inner: 3324.09 | backward_allreduce: 192.79 | step: 109.05
 60%|██████    | 121/200 [13:30<06:34,  4.99s/it]                                                 {'loss': 1.6834, 'grad_norm': 1.294830773785177, 'learning_rate': 7.126222460151719e-06, 'epoch': 2.99}
 60%|██████    | 121/200 [13:30<06:34,  4.99s/it]petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2550
[2024-07-26 15:41:57,101] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:41:57,102] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:41:57,102] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:41:57,102] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:41:57,102] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:41:57,102] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:41:57,102] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:41:57,103] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:41:57,231] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 221.47 | forward_fetch_submit: 1.73 | forward_all_gather: 42.89 | backward_fetch_wait: 21.52 | backward_fetch_submit: 0.00 | backward_all_gather: 31.24 | forward_prefetch_submit: 2.30 | backward_prefetch_wait: 0.26
[2024-07-26 15:41:57,273] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 980.25 | backward_microstep: 1921.88 | backward_inner_microstep: 1880.82 | backward_allreduce_microstep: 40.89 | step_microstep: 0.24
[INFO|trainer.py:3819] 2024-07-26 15:41:57,302 >> 
***** Running Evaluation *****
[INFO|trainer.py:3821] 2024-07-26 15:41:57,302 >>   Num examples = 160
[INFO|trainer.py:3824] 2024-07-26 15:41:57,303 >>   Batch size = 8
[2024-07-26 15:41:58,473] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:41:58,473] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:41:58,544] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:41:58,645] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:03,014] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:03,067] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:03,136] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:03,230] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:07,128] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:07,363] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:07,555] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:07,597] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:10,787] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:11,202] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:11,586] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:42:11,612] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2605
[2024-07-26 15:42:16,947] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1847993344
[2024-07-26 15:42:16,947] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:42:16,947] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 93, numel = 7391973376
[2024-07-26 15:42:16,947] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 93, numel = 7391973376
[2024-07-26 15:42:16,970] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 5.70 | forward_fetch_submit: 0.00 | forward_all_gather: 21.04 | forward_prefetch_submit: 0.99

  0%|          | 0/5 [00:00<?, ?it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2618
[2024-07-26 15:42:18,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:42:18,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:42:18,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:42:18,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:42:18,355] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.63 | forward_fetch_submit: 0.00 | forward_all_gather: 17.52 | forward_prefetch_submit: 0.69

 40%|████      | 2/5 [00:01<00:02,  1.44it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:42:19,721] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:42:19,721] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:42:19,721] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:42:19,721] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:42:19,745] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.73 | forward_fetch_submit: 0.00 | forward_all_gather: 16.37 | forward_prefetch_submit: 0.69

 60%|██████    | 3/5 [00:02<00:01,  1.02it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:42:21,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:42:21,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:42:21,130] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:42:21,130] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:42:21,153] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.48 | forward_fetch_submit: 0.00 | forward_all_gather: 16.66 | forward_prefetch_submit: 0.70

 80%|████████  | 4/5 [00:04<00:01,  1.14s/it][Apetrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:42:23,883] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:42:23,884] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:42:23,884] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:42:23,884] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:42:23,907] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.28 | forward_fetch_submit: 0.00 | forward_all_gather: 17.28 | forward_prefetch_submit: 0.93

100%|██████████| 5/5 [00:06<00:00,  1.70s/it][A                                                 
                                             [A{'eval_loss': 1.661785364151001, 'eval_runtime': 26.8079, 'eval_samples_per_second': 5.968, 'eval_steps_per_second': 0.187, 'epoch': 2.99}
 60%|██████    | 121/200 [14:01<06:34,  4.99s/it]
100%|██████████| 5/5 [00:07<00:00,  1.70s/it][A
                                             [A[INFO|trainer.py:3503] 2024-07-26 15:42:35,537 >> Saving model checkpoint to work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121
[INFO|configuration_utils.py:472] 2024-07-26 15:42:35,539 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/config.json
[INFO|configuration_utils.py:807] 2024-07-26 15:42:35,539 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/generation_config.json
[INFO|modeling_utils.py:2750] 2024-07-26 15:42:57,745 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 4 checkpoint shards. You can find where each parameters has been saved in the index located at work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2702] 2024-07-26 15:42:57,748 >> tokenizer config file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/tokenizer_config.json
[INFO|tokenization_utils_base.py:2711] 2024-07-26 15:42:57,749 >> Special tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/special_tokens_map.json
[INFO|tokenization_utils_base.py:2762] 2024-07-26 15:42:57,749 >> added tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/added_tokens.json
[2024-07-26 15:42:58,880] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step121 is about to be saved!
[2024-07-26 15:43:01,927] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/global_step121/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-07-26 15:43:01,927] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/global_step121/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-07-26 15:43:05,843] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/global_step121/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-07-26 15:43:06,317] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/global_step121/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-07-26 15:43:07,291] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/global_step121/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-07-26 15:43:07,292] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-121/global_step121/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-07-26 15:43:07,397] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step121 is ready now!
[2024-07-26 15:43:08,643] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:08,671] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:08,674] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:08,674] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:13,142] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:13,162] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:13,219] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:13,365] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:17,237] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:17,432] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:17,492] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:17,704] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:21,232] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:21,487] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:21,609] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:43:21,925] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2589
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 117, numel = 7989174272
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 112, numel = 6737661952
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7989174272
[2024-07-26 15:43:27,659] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 112, numel = 6737661952
[2024-07-26 15:43:27,738] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 142.02 | forward_fetch_submit: 0.00 | forward_all_gather: 25.70 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 109.07 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.35
[2024-07-26 15:43:27,852] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.20
[2024-07-26 15:43:27,853] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 893.16 | backward_microstep: 1548.53 | backward_inner_microstep: 1530.84 | backward_allreduce_microstep: 17.62 | step_microstep: 97.17
[2024-07-26 15:43:27,854] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1873.38 | backward: 3470.40 | backward_inner: 3411.68 | backward_allreduce: 58.58 | step: 97.36
 61%|██████    | 122/200 [15:04<41:28, 31.91s/it]                                                 {'loss': 1.5115, 'grad_norm': 1.3730617491982948, 'learning_rate': 6.971499241020495e-06, 'epoch': 3.01}
 61%|██████    | 122/200 [15:04<41:28, 31.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2512
[2024-07-26 15:43:30,036] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:30,036] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:43:30,037] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:43:30,037] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:30,037] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:30,037] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:43:30,037] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:43:30,037] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:43:30,115] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.90 | forward_fetch_submit: 0.06 | forward_all_gather: 26.96 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.29 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:43:30,134] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 742.40 | backward_microstep: 1510.28 | backward_inner_microstep: 1492.03 | backward_allreduce_microstep: 18.17 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2583
[2024-07-26 15:43:32,373] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:43:32,373] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:43:32,374] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:43:32,374] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:32,374] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:32,374] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:43:32,374] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:43:32,374] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:43:32,453] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.55 | forward_fetch_submit: 0.03 | forward_all_gather: 20.93 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 130.12 | forward_prefetch_submit: 0.94 | backward_prefetch_wait: 0.30
[2024-07-26 15:43:32,563] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.20
[2024-07-26 15:43:32,564] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.18 | backward_microstep: 1550.24 | backward_inner_microstep: 1533.17 | backward_allreduce_microstep: 17.01 | step_microstep: 93.17
[2024-07-26 15:43:32,564] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1506.57 | backward: 3060.52 | backward_inner: 3025.22 | backward_allreduce: 35.18 | step: 93.26
 62%|██████▏   | 123/200 [15:09<30:28, 23.75s/it]                                                 {'loss': 1.4573, 'grad_norm': 1.201728893982135, 'learning_rate': 6.8175701937255645e-06, 'epoch': 3.04}
 62%|██████▏   | 123/200 [15:09<30:28, 23.75s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2501
[2024-07-26 15:43:34,856] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:34,857] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:43:34,857] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:43:34,857] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:34,857] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:34,857] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:43:34,857] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:43:34,857] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:43:34,931] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.38 | forward_fetch_submit: 0.06 | forward_all_gather: 27.11 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 18.34 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:43:35,040] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 743.19 | backward_microstep: 1707.06 | backward_inner_microstep: 1598.50 | backward_allreduce_microstep: 108.48 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2613
[2024-07-26 15:43:37,467] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:43:37,468] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:43:37,468] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:43:37,468] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:37,468] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:37,468] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:43:37,468] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:43:37,468] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:43:37,547] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.35 | forward_fetch_submit: 0.03 | forward_all_gather: 20.09 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 127.00 | forward_prefetch_submit: 0.99 | backward_prefetch_wait: 0.30
[2024-07-26 15:43:37,691] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.46
[2024-07-26 15:43:37,693] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.07 | backward_microstep: 1754.13 | backward_inner_microstep: 1717.32 | backward_allreduce_microstep: 36.75 | step_microstep: 108.28
[2024-07-26 15:43:37,693] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1512.24 | backward: 3461.19 | backward_inner: 3315.84 | backward_allreduce: 145.24 | step: 108.36
 62%|██████▏   | 124/200 [15:14<23:00, 18.16s/it]                                                 {'loss': 1.5937, 'grad_norm': 1.4558058192824415, 'learning_rate': 6.664475683491797e-06, 'epoch': 3.06}
 62%|██████▏   | 124/200 [15:14<23:00, 18.16s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2532
[2024-07-26 15:43:39,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:39,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:43:39,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:43:39,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:39,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:39,891] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:43:39,891] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:43:39,891] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:43:39,970] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.71 | forward_fetch_submit: 0.06 | forward_all_gather: 26.58 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.64 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:43:40,189] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 754.10 | backward_microstep: 1715.79 | backward_inner_microstep: 1497.84 | backward_allreduce_microstep: 217.87 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2548
[2024-07-26 15:43:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:43:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:43:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:43:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:43:42,415] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:43:42,415] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:43:42,495] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.25 | forward_fetch_submit: 0.03 | forward_all_gather: 21.58 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 134.29 | forward_prefetch_submit: 1.11 | backward_prefetch_wait: 0.30
[2024-07-26 15:43:42,619] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.41
[2024-07-26 15:43:42,620] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.12 | backward_microstep: 1544.28 | backward_inner_microstep: 1526.41 | backward_allreduce_microstep: 17.81 | step_microstep: 107.24
[2024-07-26 15:43:42,621] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1511.19 | backward: 3260.08 | backward_inner: 3024.27 | backward_allreduce: 235.69 | step: 107.34
 62%|██████▎   | 125/200 [15:19<17:44, 14.19s/it]                                                 {'loss': 1.4391, 'grad_norm': 1.379538326686862, 'learning_rate': 6.5122558567011775e-06, 'epoch': 3.09}
 62%|██████▎   | 125/200 [15:19<17:44, 14.19s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2571
[2024-07-26 15:43:44,854] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:44,854] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:43:44,854] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:43:44,854] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:44,854] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:44,854] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:43:44,854] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:43:44,855] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:43:44,933] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.08 | forward_fetch_submit: 0.06 | forward_all_gather: 31.12 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.70 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.26
[2024-07-26 15:43:44,951] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.99 | backward_microstep: 1537.26 | backward_inner_microstep: 1519.99 | backward_allreduce_microstep: 17.19 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2531
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:43:47,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:43:47,251] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.80 | forward_fetch_submit: 0.03 | forward_all_gather: 21.36 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 134.70 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.30
[2024-07-26 15:43:47,373] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.27
[2024-07-26 15:43:47,375] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.44 | backward_microstep: 1540.58 | backward_inner_microstep: 1523.06 | backward_allreduce_microstep: 17.46 | step_microstep: 105.35
[2024-07-26 15:43:47,375] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1520.41 | backward: 3077.85 | backward_inner: 3043.08 | backward_allreduce: 34.66 | step: 105.44
 63%|██████▎   | 126/200 [15:24<14:00, 11.36s/it]                                                 {'loss': 1.5588, 'grad_norm': 1.1576902488095344, 'learning_rate': 6.360950630365126e-06, 'epoch': 3.11}
 63%|██████▎   | 126/200 [15:24<14:00, 11.36s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2569
[2024-07-26 15:43:49,602] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:49,602] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:43:49,602] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:43:49,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:49,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:49,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:43:49,602] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:43:49,603] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:43:49,681] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.35 | forward_fetch_submit: 0.06 | forward_all_gather: 30.90 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 19.51 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:43:49,700] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.66 | backward_microstep: 1537.37 | backward_inner_microstep: 1519.81 | backward_allreduce_microstep: 17.49 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:43:51,969] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:43:51,970] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:43:51,970] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:43:51,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:51,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:51,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:43:51,970] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:43:51,970] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:43:52,049] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 26.36 | forward_fetch_submit: 0.03 | forward_all_gather: 23.46 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 50.70 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:43:52,169] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.18
[2024-07-26 15:43:52,170] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.72 | backward_microstep: 1570.09 | backward_inner_microstep: 1552.91 | backward_allreduce_microstep: 17.13 | step_microstep: 103.42
[2024-07-26 15:43:52,171] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1538.36 | backward: 3107.46 | backward_inner: 3072.73 | backward_allreduce: 34.62 | step: 103.50
 64%|██████▎   | 127/200 [15:29<11:25,  9.39s/it]                                                 {'loss': 1.561, 'grad_norm': 1.315937597424219, 'learning_rate': 6.210599681656933e-06, 'epoch': 3.14}
 64%|██████▎   | 127/200 [15:29<11:25,  9.39s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2535
[2024-07-26 15:43:54,403] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:54,404] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:43:54,404] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:43:54,404] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:54,404] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:54,404] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:43:54,404] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:43:54,404] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:43:54,483] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.35 | forward_fetch_submit: 0.06 | forward_all_gather: 27.16 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.31 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:43:54,504] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.11 | backward_microstep: 1541.80 | backward_inner_microstep: 1521.12 | backward_allreduce_microstep: 20.60 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2555
[2024-07-26 15:43:56,925] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:43:56,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:43:56,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:43:56,926] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:56,926] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:56,926] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:43:56,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:43:56,926] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:43:57,000] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 144.57 | forward_fetch_submit: 0.03 | forward_all_gather: 20.77 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 46.98 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:43:57,121] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:43:57,122] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 873.51 | backward_microstep: 1618.67 | backward_inner_microstep: 1601.12 | backward_allreduce_microstep: 17.50 | step_microstep: 104.34
[2024-07-26 15:43:57,123] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1637.60 | backward: 3160.48 | backward_inner: 3122.26 | backward_allreduce: 38.11 | step: 104.42
 64%|██████▍   | 128/200 [15:34<09:40,  8.06s/it]                                                 {'loss': 1.4195, 'grad_norm': 1.1163885242750955, 'learning_rate': 6.061242437507131e-06, 'epoch': 3.16}
 64%|██████▍   | 128/200 [15:34<09:40,  8.06s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2632
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:43:59,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:43:59,765] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 68.86 | forward_fetch_submit: 0.06 | forward_all_gather: 32.66 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.47 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:43:59,783] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1060.01 | backward_microstep: 1574.11 | backward_inner_microstep: 1557.04 | backward_allreduce_microstep: 16.99 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:44:02,218] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:02,219] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:02,219] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:02,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:02,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:02,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:02,219] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:02,219] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:02,293] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 205.15 | forward_fetch_submit: 0.03 | forward_all_gather: 19.89 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 47.79 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:02,404] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.28
[2024-07-26 15:44:02,405] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.78 | backward_microstep: 1730.34 | backward_inner_microstep: 1713.13 | backward_allreduce_microstep: 17.16 | step_microstep: 94.77
[2024-07-26 15:44:02,406] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1836.78 | backward: 3304.46 | backward_inner: 3270.20 | backward_allreduce: 34.16 | step: 94.84
 64%|██████▍   | 129/200 [15:39<08:33,  7.23s/it]                                                 {'loss': 1.4785, 'grad_norm': 1.2388978448613082, 'learning_rate': 5.912918064264441e-06, 'epoch': 3.19}
 64%|██████▍   | 129/200 [15:39<08:33,  7.23s/it]dynamic ViT batch size: 32, images per sample: 8.0, dynamic token length: 2512
[2024-07-26 15:44:05,095] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:05,095] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:05,095] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:05,095] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:05,095] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:05,095] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:05,096] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:05,096] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:05,162] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 205.93 | forward_fetch_submit: 0.06 | forward_all_gather: 30.59 | backward_fetch_wait: 5.76 | backward_fetch_submit: 0.00 | backward_all_gather: 18.86 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:44:05,349] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 877.81 | backward_microstep: 2040.66 | backward_inner_microstep: 1854.02 | backward_allreduce_microstep: 186.56 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2578
[2024-07-26 15:44:07,601] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:07,601] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:07,601] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:07,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:07,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:07,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:07,602] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:07,602] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:07,681] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.06 | forward_fetch_submit: 0.03 | forward_all_gather: 21.13 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 136.93 | forward_prefetch_submit: 1.10 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:07,803] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.19
[2024-07-26 15:44:07,805] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.95 | backward_microstep: 1557.47 | backward_inner_microstep: 1540.12 | backward_allreduce_microstep: 17.30 | step_microstep: 105.39
[2024-07-26 15:44:07,805] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1647.75 | backward: 3598.14 | backward_inner: 3394.16 | backward_allreduce: 203.87 | step: 105.49
 65%|██████▌   | 130/200 [15:44<07:47,  6.68s/it]                                                 {'loss': 1.5557, 'grad_norm': 1.1253993221185103, 'learning_rate': 5.765665457425102e-06, 'epoch': 3.21}
 65%|██████▌   | 130/200 [15:44<07:47,  6.68s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2596
[2024-07-26 15:44:10,060] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:10,060] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:10,060] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:10,060] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:10,060] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:10,061] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:10,061] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:10,061] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:10,139] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.83 | forward_fetch_submit: 0.06 | forward_all_gather: 32.35 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.69 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:44:10,157] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.01 | backward_microstep: 1548.09 | backward_inner_microstep: 1530.68 | backward_allreduce_microstep: 17.33 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:44:12,399] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:12,400] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:12,400] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:12,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:12,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:12,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:12,400] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:12,400] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:12,476] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.55 | forward_fetch_submit: 0.03 | forward_all_gather: 21.26 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 33.64 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:12,587] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.21
[2024-07-26 15:44:12,588] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 779.26 | backward_microstep: 1536.90 | backward_inner_microstep: 1519.41 | backward_allreduce_microstep: 17.44 | step_microstep: 94.23
[2024-07-26 15:44:12,589] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1553.24 | backward: 3084.99 | backward_inner: 3050.11 | backward_allreduce: 34.78 | step: 94.31
 66%|██████▌   | 131/200 [15:49<07:01,  6.11s/it]                                                 {'loss': 1.5637, 'grad_norm': 1.210003767180461, 'learning_rate': 5.619523231433177e-06, 'epoch': 3.23}
 66%|██████▌   | 131/200 [15:49<07:01,  6.11s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2506
[2024-07-26 15:44:14,803] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:14,804] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:14,882] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 27.54 | forward_fetch_submit: 0.06 | forward_all_gather: 26.92 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.48 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:44:14,903] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 754.76 | backward_microstep: 1532.50 | backward_inner_microstep: 1512.68 | backward_allreduce_microstep: 19.74 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2540
[2024-07-26 15:44:17,275] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:17,276] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:17,276] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:17,276] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:17,276] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:17,276] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:17,276] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:17,276] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:17,353] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.32 | forward_fetch_submit: 0.03 | forward_all_gather: 21.66 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 116.21 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:17,509] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.16
[2024-07-26 15:44:17,511] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.19 | backward_microstep: 1722.26 | backward_inner_microstep: 1667.67 | backward_allreduce_microstep: 54.53 | step_microstep: 102.64
[2024-07-26 15:44:17,511] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1516.94 | backward: 3254.77 | backward_inner: 3180.38 | backward_allreduce: 74.28 | step: 102.72
 66%|██████▌   | 132/200 [15:54<06:31,  5.75s/it]                                                 {'loss': 1.4142, 'grad_norm': 1.310261176041717, 'learning_rate': 5.4745297095546125e-06, 'epoch': 3.26}
 66%|██████▌   | 132/200 [15:54<06:31,  5.75s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2499
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:20,142] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:20,221] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 147.17 | forward_fetch_submit: 0.06 | forward_all_gather: 31.64 | backward_fetch_wait: 5.68 | backward_fetch_submit: 0.00 | backward_all_gather: 16.61 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:44:20,238] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 850.01 | backward_microstep: 1851.29 | backward_inner_microstep: 1834.31 | backward_allreduce_microstep: 16.91 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:44:22,478] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:22,479] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:22,480] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:22,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:22,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:22,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:22,480] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:22,480] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:22,558] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.19 | forward_fetch_submit: 0.03 | forward_all_gather: 21.40 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 123.57 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:22,667] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.18
[2024-07-26 15:44:22,668] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.86 | backward_microstep: 1549.82 | backward_inner_microstep: 1532.80 | backward_allreduce_microstep: 16.97 | step_microstep: 92.65
[2024-07-26 15:44:22,668] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1616.85 | backward: 3401.12 | backward_inner: 3367.13 | backward_allreduce: 33.89 | step: 92.73
 66%|██████▋   | 133/200 [15:59<06:13,  5.57s/it]                                                 {'loss': 1.5239, 'grad_norm': 1.1532096986317508, 'learning_rate': 5.330722913827594e-06, 'epoch': 3.28}
 66%|██████▋   | 133/200 [15:59<06:13,  5.57s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2532
[2024-07-26 15:44:25,073] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:25,074] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:25,074] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:25,074] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:25,074] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:25,074] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:25,074] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:25,074] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:25,151] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 131.13 | forward_fetch_submit: 0.06 | forward_all_gather: 31.32 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.84 | forward_prefetch_submit: 0.71 | backward_prefetch_wait: 0.26
[2024-07-26 15:44:25,169] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 878.68 | backward_microstep: 1594.94 | backward_inner_microstep: 1577.85 | backward_allreduce_microstep: 17.02 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:27,913] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 221.07 | forward_fetch_submit: 0.03 | forward_all_gather: 24.53 | backward_fetch_wait: 5.51 | backward_fetch_submit: 0.00 | backward_all_gather: 21.28 | forward_prefetch_submit: 0.91 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:28,245] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.28
[2024-07-26 15:44:28,247] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 807.66 | backward_microstep: 2086.03 | backward_inner_microstep: 1857.04 | backward_allreduce_microstep: 228.93 | step_microstep: 103.65
[2024-07-26 15:44:28,247] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1686.32 | backward: 3680.98 | backward_inner: 3434.91 | backward_allreduce: 245.95 | step: 103.74
 67%|██████▋   | 134/200 [16:05<06:08,  5.58s/it]                                                 {'loss': 1.4321, 'grad_norm': 1.403425045660936, 'learning_rate': 5.18814055509195e-06, 'epoch': 3.31}
 67%|██████▋   | 134/200 [16:05<06:08,  5.58s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:44:30,496] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:30,497] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:30,497] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:30,497] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:30,497] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:30,497] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:30,497] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:30,497] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:30,576] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.97 | forward_fetch_submit: 0.06 | forward_all_gather: 32.43 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.80 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:44:30,594] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.36 | backward_microstep: 1550.74 | backward_inner_microstep: 1533.04 | backward_allreduce_microstep: 17.63 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:44:32,855] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:32,935] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.66 | forward_fetch_submit: 0.03 | forward_all_gather: 20.04 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 40.67 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:33,050] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.21
[2024-07-26 15:44:33,052] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 784.18 | backward_microstep: 1553.16 | backward_inner_microstep: 1535.84 | backward_allreduce_microstep: 17.26 | step_microstep: 98.79
[2024-07-26 15:44:33,052] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1554.52 | backward: 3103.90 | backward_inner: 3068.89 | backward_allreduce: 34.90 | step: 98.88
 68%|██████▊   | 135/200 [16:10<05:47,  5.34s/it]                                                 {'loss': 1.6773, 'grad_norm': 1.210188414155423, 'learning_rate': 5.046820023100129e-06, 'epoch': 3.33}
 68%|██████▊   | 135/200 [16:10<05:47,  5.34s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2528
[2024-07-26 15:44:35,242] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:35,322] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.97 | forward_fetch_submit: 0.06 | forward_all_gather: 27.42 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.42 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:44:35,340] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.25 | backward_microstep: 1512.90 | backward_inner_microstep: 1495.59 | backward_allreduce_microstep: 17.23 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2553
[2024-07-26 15:44:37,566] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:37,566] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:37,566] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:37,566] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:37,566] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:37,567] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:37,567] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:37,567] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:37,648] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.27 | forward_fetch_submit: 0.03 | forward_all_gather: 22.30 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 138.36 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:37,896] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:44:37,897] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.18 | backward_microstep: 1670.17 | backward_inner_microstep: 1524.38 | backward_allreduce_microstep: 145.74 | step_microstep: 103.17
[2024-07-26 15:44:37,898] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1509.41 | backward: 3183.07 | backward_inner: 3019.99 | backward_allreduce: 162.98 | step: 103.25
 68%|██████▊   | 136/200 [16:14<05:32,  5.20s/it]                                                 {'loss': 1.5422, 'grad_norm': 1.342394088120631, 'learning_rate': 4.9067983767123736e-06, 'epoch': 3.36}
 68%|██████▊   | 136/200 [16:14<05:32,  5.20s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2544
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:40,215] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:40,296] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 30.06 | forward_fetch_submit: 0.06 | forward_all_gather: 32.19 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 18.01 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:44:40,446] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 773.02 | backward_microstep: 1748.60 | backward_inner_microstep: 1599.49 | backward_allreduce_microstep: 149.03 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2564
[2024-07-26 15:44:42,850] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:42,851] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:42,851] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:42,851] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:42,851] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:42,851] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:42,851] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:42,851] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:42,931] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.54 | forward_fetch_submit: 0.03 | forward_all_gather: 23.50 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 133.42 | forward_prefetch_submit: 1.00 | backward_prefetch_wait: 0.31
[2024-07-26 15:44:43,047] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.44
[2024-07-26 15:44:43,048] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 777.05 | backward_microstep: 1704.58 | backward_inner_microstep: 1686.69 | backward_allreduce_microstep: 17.83 | step_microstep: 98.90
[2024-07-26 15:44:43,049] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1550.05 | backward: 3453.18 | backward_inner: 3286.20 | backward_allreduce: 166.86 | step: 98.98
 68%|██████▊   | 137/200 [16:20<05:26,  5.18s/it]                                                 {'loss': 1.4798, 'grad_norm': 1.620580190162106, 'learning_rate': 4.7681123341787e-06, 'epoch': 3.38}
 68%|██████▊   | 137/200 [16:20<05:26,  5.18s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2524
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:45,231] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:45,309] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.38 | forward_fetch_submit: 0.06 | forward_all_gather: 27.25 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 16.27 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:44:45,517] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 744.47 | backward_microstep: 1697.76 | backward_inner_microstep: 1490.49 | backward_allreduce_microstep: 207.20 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:44:47,755] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:47,755] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:47,756] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:47,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:47,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:47,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:47,756] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:47,756] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:47,837] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.40 | forward_fetch_submit: 0.03 | forward_all_gather: 20.13 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 36.47 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:47,957] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.51
[2024-07-26 15:44:47,958] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 777.48 | backward_microstep: 1539.54 | backward_inner_microstep: 1521.12 | backward_allreduce_microstep: 18.36 | step_microstep: 102.01
[2024-07-26 15:44:47,958] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1521.93 | backward: 3237.31 | backward_inner: 3011.63 | backward_allreduce: 225.57 | step: 102.10
 69%|██████▉   | 138/200 [16:24<05:16,  5.10s/it]                                                 {'loss': 1.523, 'grad_norm': 1.2639318331653575, 'learning_rate': 4.630798263510162e-06, 'epoch': 3.41}
 69%|██████▉   | 138/200 [16:24<05:16,  5.10s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2532
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:50,169] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:50,250] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.36 | forward_fetch_submit: 0.06 | forward_all_gather: 27.68 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.21 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.25
[2024-07-26 15:44:50,268] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 755.58 | backward_microstep: 1527.91 | backward_inner_microstep: 1509.82 | backward_allreduce_microstep: 18.02 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2608
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:52,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:52,601] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.18 | forward_fetch_submit: 0.03 | forward_all_gather: 18.71 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 114.50 | forward_prefetch_submit: 0.94 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:52,715] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.32
[2024-07-26 15:44:52,716] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.40 | backward_microstep: 1563.71 | backward_inner_microstep: 1545.96 | backward_allreduce_microstep: 17.70 | step_microstep: 96.95
[2024-07-26 15:44:52,717] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1519.96 | backward: 3091.63 | backward_inner: 3055.80 | backward_allreduce: 35.72 | step: 97.04
 70%|██████▉   | 139/200 [16:29<05:04,  5.00s/it]                                                 {'loss': 1.5468, 'grad_norm': 1.303560383456045, 'learning_rate': 4.494892172941965e-06, 'epoch': 3.43}
 70%|██████▉   | 139/200 [16:29<05:04,  5.00s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2579
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:54,945] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:55,025] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.13 | forward_fetch_submit: 0.06 | forward_all_gather: 31.55 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.69 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:44:55,044] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.36 | backward_microstep: 1539.80 | backward_inner_microstep: 1521.32 | backward_allreduce_microstep: 18.41 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2636
[2024-07-26 15:44:57,341] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:44:57,342] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:44:57,342] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:44:57,342] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:57,342] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:57,342] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:44:57,342] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:44:57,342] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:44:57,418] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.15 | forward_fetch_submit: 0.03 | forward_all_gather: 19.73 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 44.10 | forward_prefetch_submit: 0.92 | backward_prefetch_wait: 0.30
[2024-07-26 15:44:57,533] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.19
[2024-07-26 15:44:57,534] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 789.98 | backward_microstep: 1580.33 | backward_inner_microstep: 1562.86 | backward_allreduce_microstep: 17.41 | step_microstep: 98.07
[2024-07-26 15:44:57,534] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1551.32 | backward: 3120.13 | backward_inner: 3084.20 | backward_allreduce: 35.82 | step: 98.16
 70%|███████   | 140/200 [16:34<04:56,  4.94s/it]                                                 {'loss': 1.5596, 'grad_norm': 1.215315334588509, 'learning_rate': 4.360429701490935e-06, 'epoch': 3.46}
 70%|███████   | 140/200 [16:34<04:56,  4.94s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2511
[2024-07-26 15:44:59,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:44:59,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:44:59,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:44:59,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:44:59,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:44:59,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:44:59,772] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:44:59,772] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:44:59,838] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.27 | forward_fetch_submit: 0.06 | forward_all_gather: 27.33 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 17.47 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:00,011] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 748.53 | backward_microstep: 1697.14 | backward_inner_microstep: 1524.16 | backward_allreduce_microstep: 172.90 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2568
[2024-07-26 15:45:02,523] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:02,523] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:02,523] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:02,523] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:02,523] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:02,523] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:02,524] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:02,524] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:02,600] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 206.98 | forward_fetch_submit: 0.03 | forward_all_gather: 23.25 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 46.69 | forward_prefetch_submit: 1.04 | backward_prefetch_wait: 0.31
[2024-07-26 15:45:02,718] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.29
[2024-07-26 15:45:02,720] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 947.46 | backward_microstep: 1636.94 | backward_inner_microstep: 1619.22 | backward_allreduce_microstep: 17.66 | step_microstep: 101.65
[2024-07-26 15:45:02,720] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1695.97 | backward: 3334.09 | backward_inner: 3143.40 | backward_allreduce: 190.57 | step: 101.74
 70%|███████   | 141/200 [16:39<04:55,  5.02s/it]                                                 {'loss': 1.378, 'grad_norm': 1.1451203805718901, 'learning_rate': 4.2274461096098085e-06, 'epoch': 3.48}
 70%|███████   | 141/200 [16:39<04:55,  5.02s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2605
[2024-07-26 15:45:05,165] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:05,165] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:05,165] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:05,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:05,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:05,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:05,166] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:05,166] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:05,246] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.92 | forward_fetch_submit: 0.06 | forward_all_gather: 32.34 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 20.30 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:45:05,264] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.38 | backward_microstep: 1747.06 | backward_inner_microstep: 1729.06 | backward_allreduce_microstep: 17.92 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2549
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:07,580] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:07,660] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.55 | forward_fetch_submit: 0.03 | forward_all_gather: 20.25 | backward_fetch_wait: 5.73 | backward_fetch_submit: 0.00 | backward_all_gather: 116.38 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.31
[2024-07-26 15:45:07,796] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.28
[2024-07-26 15:45:07,798] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 748.64 | backward_microstep: 1660.08 | backward_inner_microstep: 1625.34 | backward_allreduce_microstep: 34.69 | step_microstep: 102.14
[2024-07-26 15:45:07,798] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1520.00 | backward: 3407.14 | backward_inner: 3354.42 | backward_allreduce: 52.61 | step: 102.22
 71%|███████   | 142/200 [16:44<04:52,  5.03s/it]                                                 {'loss': 1.4969, 'grad_norm': 1.2591372641543044, 'learning_rate': 4.095976269940777e-06, 'epoch': 3.51}
 71%|███████   | 142/200 [16:44<04:52,  5.03s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2532
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:10,042] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:10,122] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 34.09 | forward_fetch_submit: 0.06 | forward_all_gather: 28.00 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.28 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:45:10,151] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.25 | backward_microstep: 1563.64 | backward_inner_microstep: 1535.46 | backward_allreduce_microstep: 28.11 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:45:12,409] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:12,410] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:12,410] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:12,410] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:12,410] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:12,410] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:12,410] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:12,410] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:12,484] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.01 | forward_fetch_submit: 0.03 | forward_all_gather: 20.12 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 121.90 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:12,600] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.43
[2024-07-26 15:45:12,602] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.59 | backward_microstep: 1559.34 | backward_inner_microstep: 1541.48 | backward_allreduce_microstep: 17.81 | step_microstep: 98.80
[2024-07-26 15:45:12,602] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1533.82 | backward: 3122.99 | backward_inner: 3076.96 | backward_allreduce: 45.92 | step: 98.89
 72%|███████▏  | 143/200 [16:49<04:43,  4.97s/it]                                                 {'loss': 1.534, 'grad_norm': 1.175319667806722, 'learning_rate': 3.966054658170754e-06, 'epoch': 3.53}
 72%|███████▏  | 143/200 [16:49<04:43,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2570
[2024-07-26 15:45:14,831] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:14,832] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:14,832] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:14,832] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:14,832] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:14,832] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:14,832] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:14,832] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:14,911] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.77 | forward_fetch_submit: 0.06 | forward_all_gather: 31.26 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.63 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:14,930] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.25 | backward_microstep: 1538.97 | backward_inner_microstep: 1520.72 | backward_allreduce_microstep: 18.18 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2579
[2024-07-26 15:45:17,177] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:17,178] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:17,178] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:17,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:17,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:17,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:17,178] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:17,178] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:17,257] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.28 | forward_fetch_submit: 0.03 | forward_all_gather: 20.47 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 38.58 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:17,378] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.37
[2024-07-26 15:45:17,379] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 782.60 | backward_microstep: 1540.75 | backward_inner_microstep: 1522.73 | backward_allreduce_microstep: 17.97 | step_microstep: 103.45
[2024-07-26 15:45:17,380] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1545.83 | backward: 3079.72 | backward_inner: 3043.46 | backward_allreduce: 36.15 | step: 103.54
 72%|███████▏  | 144/200 [16:54<04:34,  4.91s/it]                                                 {'loss': 1.5869, 'grad_norm': 1.2015747152161698, 'learning_rate': 3.837715343990727e-06, 'epoch': 3.56}
 72%|███████▏  | 144/200 [16:54<04:34,  4.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:19,617] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:19,698] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.94 | forward_fetch_submit: 0.06 | forward_all_gather: 32.47 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.55 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:45:19,853] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.33 | backward_microstep: 1680.66 | backward_inner_microstep: 1526.00 | backward_allreduce_microstep: 154.58 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2569
[2024-07-26 15:45:22,287] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:22,368] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 218.63 | forward_fetch_submit: 0.03 | forward_all_gather: 18.95 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 130.33 | forward_prefetch_submit: 0.98 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:22,485] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.46
[2024-07-26 15:45:22,486] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.98 | backward_microstep: 1752.31 | backward_inner_microstep: 1733.76 | backward_allreduce_microstep: 18.50 | step_microstep: 98.99
[2024-07-26 15:45:22,486] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1526.29 | backward: 3432.97 | backward_inner: 3259.77 | backward_allreduce: 173.09 | step: 99.08
 72%|███████▎  | 145/200 [16:59<04:33,  4.97s/it]                                                 {'loss': 1.4175, 'grad_norm': 1.2492907021174346, 'learning_rate': 3.7109919821615546e-06, 'epoch': 3.58}
 72%|███████▎  | 145/200 [16:59<04:33,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2537
[2024-07-26 15:45:24,716] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:24,716] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:24,717] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:24,717] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:24,717] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:24,717] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:24,717] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:24,717] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:24,795] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 26.07 | forward_fetch_submit: 0.06 | forward_all_gather: 28.25 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.47 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:24,999] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.19 | backward_microstep: 1726.78 | backward_inner_microstep: 1523.66 | backward_allreduce_microstep: 203.05 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:45:27,303] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:27,304] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:27,304] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:27,304] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:27,304] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:27,304] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:27,304] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:27,304] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:27,384] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 45.44 | forward_fetch_submit: 0.03 | forward_all_gather: 23.35 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 139.78 | forward_prefetch_submit: 0.90 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:27,727] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.56
[2024-07-26 15:45:27,729] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 773.76 | backward_microstep: 1829.06 | backward_inner_microstep: 1591.72 | backward_allreduce_microstep: 237.28 | step_microstep: 107.13
[2024-07-26 15:45:27,729] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1532.93 | backward: 3555.85 | backward_inner: 3115.40 | backward_allreduce: 440.34 | step: 107.22
 73%|███████▎  | 146/200 [17:04<04:32,  5.05s/it]                                                 {'loss': 1.4876, 'grad_norm': 1.2066936412512848, 'learning_rate': 3.585917803688603e-06, 'epoch': 3.6}
 73%|███████▎  | 146/200 [17:04<04:32,  5.05s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2596
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:29,972] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:30,052] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.84 | forward_fetch_submit: 0.06 | forward_all_gather: 31.25 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.46 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:30,074] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.92 | backward_microstep: 1551.07 | backward_inner_microstep: 1529.85 | backward_allreduce_microstep: 21.14 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2548
[2024-07-26 15:45:32,306] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:32,306] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:32,306] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:32,306] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:32,306] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:32,306] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:32,307] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:32,307] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:32,384] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.00 | forward_fetch_submit: 0.03 | forward_all_gather: 20.92 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 132.02 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:32,501] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.23
[2024-07-26 15:45:32,503] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.42 | backward_microstep: 1549.40 | backward_inner_microstep: 1532.29 | backward_allreduce_microstep: 17.05 | step_microstep: 100.91
[2024-07-26 15:45:32,503] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1523.32 | backward: 3100.47 | backward_inner: 3062.16 | backward_allreduce: 38.20 | step: 101.00
 74%|███████▎  | 147/200 [17:09<04:23,  4.97s/it]                                                 {'loss': 1.4884, 'grad_norm': 1.267499625370334, 'learning_rate': 3.4625256071074776e-06, 'epoch': 3.63}
 74%|███████▎  | 147/200 [17:09<04:23,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2514
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:34,683] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:34,762] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.35 | forward_fetch_submit: 0.06 | forward_all_gather: 27.64 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.29 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:34,781] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 747.70 | backward_microstep: 1505.01 | backward_inner_microstep: 1486.99 | backward_allreduce_microstep: 17.95 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:45:37,030] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:37,031] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:37,031] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:37,031] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:37,031] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:37,031] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:37,031] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:37,031] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:37,111] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.68 | forward_fetch_submit: 0.03 | forward_all_gather: 20.66 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 132.34 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:37,248] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.45
[2024-07-26 15:45:37,250] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.93 | backward_microstep: 1569.76 | backward_inner_microstep: 1547.18 | backward_allreduce_microstep: 22.53 | step_microstep: 115.25
[2024-07-26 15:45:37,250] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1509.61 | backward: 3074.78 | backward_inner: 3034.19 | backward_allreduce: 40.48 | step: 115.34
 74%|███████▍  | 148/200 [17:14<04:14,  4.90s/it]                                                 {'loss': 1.4297, 'grad_norm': 1.347063019869636, 'learning_rate': 3.3408477498831917e-06, 'epoch': 3.65}
 74%|███████▍  | 148/200 [17:14<04:14,  4.90s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2517
[2024-07-26 15:45:39,439] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:39,440] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:39,440] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:39,440] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:39,440] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:39,440] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:39,440] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:39,440] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:39,521] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.56 | forward_fetch_submit: 0.06 | forward_all_gather: 27.35 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.22 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:39,541] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 751.26 | backward_microstep: 1512.43 | backward_inner_microstep: 1493.18 | backward_allreduce_microstep: 19.17 | step_microstep: 0.09
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2565
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:41,769] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:41,837] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.12 | forward_fetch_submit: 0.03 | forward_all_gather: 21.92 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 139.80 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:42,144] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.44
[2024-07-26 15:45:42,146] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.78 | backward_microstep: 1717.87 | backward_inner_microstep: 1517.29 | backward_allreduce_microstep: 200.52 | step_microstep: 107.61
[2024-07-26 15:45:42,146] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1508.02 | backward: 3230.30 | backward_inner: 3010.48 | backward_allreduce: 219.70 | step: 107.70
 74%|███████▍  | 149/200 [17:19<04:09,  4.90s/it]                                                 {'loss': 1.4547, 'grad_norm': 1.4016778043941753, 'learning_rate': 3.2209161399249677e-06, 'epoch': 3.68}
 74%|███████▍  | 149/200 [17:19<04:09,  4.90s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2617
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:44,402] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:44,482] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.43 | forward_fetch_submit: 0.06 | forward_all_gather: 30.69 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 19.68 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:44,500] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.70 | backward_microstep: 1556.72 | backward_inner_microstep: 1538.78 | backward_allreduce_microstep: 17.86 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:45:46,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:46,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:46,927] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:46,927] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:46,927] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:46,927] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:46,927] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:46,927] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:47,006] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.88 | forward_fetch_submit: 0.03 | forward_all_gather: 20.17 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 34.79 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:47,121] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.33
[2024-07-26 15:45:47,122] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 957.78 | backward_microstep: 1545.29 | backward_inner_microstep: 1527.53 | backward_allreduce_microstep: 17.70 | step_microstep: 97.60
[2024-07-26 15:45:47,123] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1729.46 | backward: 3102.01 | backward_inner: 3066.33 | backward_allreduce: 35.57 | step: 97.68
 75%|███████▌  | 150/200 [17:24<04:06,  4.92s/it]                                                 {'loss': 1.5621, 'grad_norm': 1.3733905859680475, 'learning_rate': 3.1027622272189572e-06, 'epoch': 3.7}
 75%|███████▌  | 150/200 [17:24<04:06,  4.92s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2564
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:49,493] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.49 | forward_fetch_submit: 0.06 | forward_all_gather: 35.29 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.75 | forward_prefetch_submit: 2.93 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:49,702] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.93 | backward_microstep: 1776.05 | backward_inner_microstep: 1567.75 | backward_allreduce_microstep: 208.22 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2603
[2024-07-26 15:45:51,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:51,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:51,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:51,979] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:51,979] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:51,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:51,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:51,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:52,060] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 17.23 | forward_fetch_submit: 0.03 | forward_all_gather: 22.57 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 136.43 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.31
[2024-07-26 15:45:52,191] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.49
[2024-07-26 15:45:52,193] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 784.32 | backward_microstep: 1569.29 | backward_inner_microstep: 1550.93 | backward_allreduce_microstep: 18.30 | step_microstep: 113.99
[2024-07-26 15:45:52,193] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1561.24 | backward: 3345.34 | backward_inner: 3118.70 | backward_allreduce: 226.53 | step: 114.08
 76%|███████▌  | 151/200 [17:29<04:03,  4.97s/it]                                                 {'loss': 1.4166, 'grad_norm': 1.284066485759768, 'learning_rate': 2.9864169955810085e-06, 'epoch': 3.73}
 76%|███████▌  | 151/200 [17:29<04:03,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2503
[2024-07-26 15:45:54,420] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:54,420] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:54,420] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:54,420] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:54,420] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:54,421] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:54,421] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:54,421] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:54,501] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.55 | forward_fetch_submit: 0.06 | forward_all_gather: 28.90 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.27 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:45:54,525] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.64 | backward_microstep: 1543.38 | backward_inner_microstep: 1519.79 | backward_allreduce_microstep: 23.51 | step_microstep: 0.10
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2549
[2024-07-26 15:45:56,724] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:45:56,725] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:45:56,725] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:45:56,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:56,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:56,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:45:56,725] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:45:56,725] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:45:56,805] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.57 | forward_fetch_submit: 0.03 | forward_all_gather: 20.47 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 135.45 | forward_prefetch_submit: 1.01 | backward_prefetch_wait: 0.30
[2024-07-26 15:45:56,922] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.33
[2024-07-26 15:45:56,924] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.96 | backward_microstep: 1521.11 | backward_inner_microstep: 1502.76 | backward_allreduce_microstep: 18.30 | step_microstep: 100.30
[2024-07-26 15:45:56,924] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1516.58 | backward: 3064.50 | backward_inner: 3022.56 | backward_allreduce: 41.82 | step: 100.40
 76%|███████▌  | 152/200 [17:33<03:55,  4.90s/it]                                                 {'loss': 1.3526, 'grad_norm': 1.3663531639017799, 'learning_rate': 2.8719109545317102e-06, 'epoch': 3.75}
 76%|███████▌  | 152/200 [17:33<03:55,  4.90s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2578
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:45:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:45:59,233] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.63 | forward_fetch_submit: 0.06 | forward_all_gather: 30.67 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 19.65 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:45:59,252] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.00 | backward_microstep: 1538.86 | backward_inner_microstep: 1520.90 | backward_allreduce_microstep: 17.89 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2611
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:01,515] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:01,594] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 17.23 | forward_fetch_submit: 0.03 | forward_all_gather: 19.75 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 124.89 | forward_prefetch_submit: 0.81 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:01,709] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:46:01,710] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.28 | backward_microstep: 1567.67 | backward_inner_microstep: 1549.86 | backward_allreduce_microstep: 17.75 | step_microstep: 98.56
[2024-07-26 15:46:01,711] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1532.26 | backward: 3106.53 | backward_inner: 3070.78 | backward_allreduce: 35.64 | step: 98.64
 76%|███████▋  | 153/200 [17:38<03:48,  4.86s/it]                                                 {'loss': 1.5783, 'grad_norm': 1.3897722218834678, 'learning_rate': 2.759274131295787e-06, 'epoch': 3.78}
 76%|███████▋  | 153/200 [17:38<03:48,  4.86s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2529
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:04,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:04,210] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 153.69 | forward_fetch_submit: 0.06 | forward_all_gather: 27.95 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.76 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:04,365] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 778.89 | backward_microstep: 1845.48 | backward_inner_microstep: 1691.50 | backward_allreduce_microstep: 153.90 | step_microstep: 0.09
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2610
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:06,771] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:06,838] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.58 | forward_fetch_submit: 0.03 | forward_all_gather: 22.62 | backward_fetch_wait: 5.65 | backward_fetch_submit: 0.00 | backward_all_gather: 27.16 | forward_prefetch_submit: 1.08 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:06,952] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:46:06,953] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 782.16 | backward_microstep: 1687.44 | backward_inner_microstep: 1669.60 | backward_allreduce_microstep: 17.79 | step_microstep: 96.98
[2024-07-26 15:46:06,953] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1561.03 | backward: 3532.93 | backward_inner: 3361.11 | backward_allreduce: 171.69 | step: 97.08
 77%|███████▋  | 154/200 [17:43<03:48,  4.98s/it]                                                 {'loss': 1.5565, 'grad_norm': 1.3424692710632444, 'learning_rate': 2.648536062927999e-06, 'epoch': 3.8}
 77%|███████▋  | 154/200 [17:43<03:48,  4.98s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2539
[2024-07-26 15:46:09,138] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:09,139] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:09,139] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:09,139] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:09,139] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:09,139] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:09,139] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:09,139] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:09,205] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.63 | forward_fetch_submit: 0.06 | forward_all_gather: 27.99 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.29 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:09,236] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 751.35 | backward_microstep: 1504.10 | backward_inner_microstep: 1473.94 | backward_allreduce_microstep: 30.08 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2551
[2024-07-26 15:46:11,675] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:11,676] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:11,676] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:11,676] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:11,676] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:11,676] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:11,676] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:11,676] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:11,755] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 135.80 | forward_fetch_submit: 0.03 | forward_all_gather: 23.35 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 45.39 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:11,869] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.31
[2024-07-26 15:46:11,870] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 912.61 | backward_microstep: 1602.66 | backward_inner_microstep: 1584.88 | backward_allreduce_microstep: 17.72 | step_microstep: 96.75
[2024-07-26 15:46:11,870] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1663.94 | backward: 3106.76 | backward_inner: 3058.84 | backward_allreduce: 47.81 | step: 96.83
 78%|███████▊  | 155/200 [17:48<03:43,  4.96s/it]                                                 {'loss': 1.5032, 'grad_norm': 1.3504862766228054, 'learning_rate': 2.5397257885675396e-06, 'epoch': 3.83}
 78%|███████▊  | 155/200 [17:48<03:43,  4.96s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2591
[2024-07-26 15:46:14,117] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:14,117] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:14,117] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:14,117] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:14,117] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:14,117] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:14,118] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:14,118] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:14,195] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.92 | forward_fetch_submit: 0.06 | forward_all_gather: 31.98 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 24.62 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:14,214] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.74 | backward_microstep: 1545.14 | backward_inner_microstep: 1526.96 | backward_allreduce_microstep: 18.10 | step_microstep: 0.08
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2628
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:16,470] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:16,537] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 15.14 | forward_fetch_submit: 0.03 | forward_all_gather: 20.39 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 127.46 | forward_prefetch_submit: 0.81 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:16,661] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.37
[2024-07-26 15:46:16,662] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.94 | backward_microstep: 1552.42 | backward_inner_microstep: 1533.77 | backward_allreduce_microstep: 18.59 | step_microstep: 106.16
[2024-07-26 15:46:16,662] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1534.66 | backward: 3097.56 | backward_inner: 3060.74 | backward_allreduce: 36.70 | step: 106.24
 78%|███████▊  | 156/200 [17:53<03:35,  4.91s/it]                                                 {'loss': 1.4498, 'grad_norm': 1.3028315797128263, 'learning_rate': 2.432871841823047e-06, 'epoch': 3.85}
 78%|███████▊  | 156/200 [17:53<03:35,  4.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2802
[2024-07-26 15:46:19,000] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:19,081] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.28 | forward_fetch_submit: 0.06 | forward_all_gather: 28.18 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.39 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:19,100] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 795.90 | backward_microstep: 1614.40 | backward_inner_microstep: 1596.29 | backward_allreduce_microstep: 18.04 | step_microstep: 0.46
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2540
[2024-07-26 15:46:21,307] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:21,308] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:21,308] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:21,308] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:21,308] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:21,308] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:21,308] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:21,308] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:21,388] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.49 | forward_fetch_submit: 0.03 | forward_all_gather: 20.40 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 136.35 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:21,510] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:46:21,511] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 748.57 | backward_microstep: 1535.63 | backward_inner_microstep: 1517.65 | backward_allreduce_microstep: 17.91 | step_microstep: 104.99
[2024-07-26 15:46:21,512] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1544.45 | backward: 3150.03 | backward_inner: 3113.96 | backward_allreduce: 35.96 | step: 105.47
 78%|███████▊  | 157/200 [17:58<03:30,  4.89s/it]                                                 {'loss': 1.4887, 'grad_norm': 3.285525540493088, 'learning_rate': 2.328002243290138e-06, 'epoch': 3.88}
 78%|███████▊  | 157/200 [17:58<03:30,  4.89s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2545
[2024-07-26 15:46:23,780] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:23,781] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:23,781] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:23,781] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:23,781] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:23,781] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:23,781] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:23,781] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:23,860] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.36 | forward_fetch_submit: 0.06 | forward_all_gather: 28.77 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 17.10 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:23,967] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 751.69 | backward_microstep: 1677.25 | backward_inner_microstep: 1571.06 | backward_allreduce_microstep: 106.11 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2562
[2024-07-26 15:46:26,570] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:26,570] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:26,570] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:26,571] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:26,571] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:26,571] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:26,571] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:26,571] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:26,636] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 132.06 | forward_fetch_submit: 0.03 | forward_all_gather: 21.37 | backward_fetch_wait: 5.65 | backward_fetch_submit: 0.00 | backward_all_gather: 38.45 | forward_prefetch_submit: 1.02 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:26,752] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.37
[2024-07-26 15:46:26,753] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 835.42 | backward_microstep: 1828.72 | backward_inner_microstep: 1811.16 | backward_allreduce_microstep: 17.51 | step_microstep: 98.67
[2024-07-26 15:46:26,754] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1587.09 | backward: 3505.97 | backward_inner: 3382.24 | backward_allreduce: 123.62 | step: 98.76
 79%|███████▉  | 158/200 [18:03<03:29,  5.00s/it]                                                 {'loss': 1.6714, 'grad_norm': 1.3621295937727553, 'learning_rate': 2.2251444932035094e-06, 'epoch': 3.9}
 79%|███████▉  | 158/200 [18:03<03:29,  5.00s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2615
[2024-07-26 15:46:29,005] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:29,006] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:29,006] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:29,006] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:29,006] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:29,006] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:29,006] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:29,006] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:29,086] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.16 | forward_fetch_submit: 0.06 | forward_all_gather: 31.05 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.75 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.25
[2024-07-26 15:46:29,106] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.52 | backward_microstep: 1555.30 | backward_inner_microstep: 1536.30 | backward_allreduce_microstep: 18.92 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2540
[2024-07-26 15:46:31,367] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:31,367] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:31,367] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:31,367] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:31,367] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:31,367] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:31,368] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:31,368] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:31,446] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.88 | forward_fetch_submit: 0.03 | forward_all_gather: 25.12 | backward_fetch_wait: 5.66 | backward_fetch_submit: 0.00 | backward_all_gather: 48.45 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:31,748] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.56
[2024-07-26 15:46:31,749] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.54 | backward_microstep: 1744.19 | backward_inner_microstep: 1549.67 | backward_allreduce_microstep: 194.46 | step_microstep: 108.09
[2024-07-26 15:46:31,750] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1541.04 | backward: 3299.50 | backward_inner: 3085.99 | backward_allreduce: 213.39 | step: 108.18
 80%|███████▉  | 159/200 [18:08<03:24,  5.00s/it]                                                 {'loss': 1.4843, 'grad_norm': 2.6280511150776804, 'learning_rate': 2.124325564225458e-06, 'epoch': 3.93}
 80%|███████▉  | 159/200 [18:08<03:24,  5.00s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2510
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:34,053] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.02 | forward_fetch_submit: 0.06 | forward_all_gather: 28.03 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.29 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:34,074] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.90 | backward_microstep: 1540.80 | backward_inner_microstep: 1520.18 | backward_allreduce_microstep: 20.55 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2591
[2024-07-26 15:46:36,310] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:36,310] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:36,310] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:36,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:36,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:36,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:36,311] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:36,311] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:36,390] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.94 | forward_fetch_submit: 0.03 | forward_all_gather: 20.36 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 37.78 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:36,504] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.19
[2024-07-26 15:46:36,505] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.92 | backward_microstep: 1544.46 | backward_inner_microstep: 1527.06 | backward_allreduce_microstep: 17.34 | step_microstep: 96.90
[2024-07-26 15:46:36,505] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1524.80 | backward: 3085.26 | backward_inner: 3047.26 | backward_allreduce: 37.90 | step: 96.99
 80%|████████  | 160/200 [18:13<03:16,  4.92s/it]                                                 {'loss': 1.4412, 'grad_norm': 1.4266023139561734, 'learning_rate': 2.025571894372794e-06, 'epoch': 3.95}
 80%|████████  | 160/200 [18:13<03:16,  4.92s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2510
[2024-07-26 15:46:38,730] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:38,730] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:38,730] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:38,730] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:38,731] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:38,731] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:38,731] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:38,731] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:38,810] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.39 | forward_fetch_submit: 0.06 | forward_all_gather: 27.82 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.19 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:38,834] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.49 | backward_microstep: 1545.91 | backward_inner_microstep: 1522.24 | backward_allreduce_microstep: 23.60 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2660
[2024-07-26 15:46:41,122] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:41,122] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:41,122] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:41,123] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:41,123] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:41,123] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:41,123] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:41,123] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:41,202] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.86 | forward_fetch_submit: 0.03 | forward_all_gather: 20.88 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 18.87 | forward_prefetch_submit: 0.81 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:41,318] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.37
[2024-07-26 15:46:41,320] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 783.84 | backward_microstep: 1580.12 | backward_inner_microstep: 1562.42 | backward_allreduce_microstep: 17.65 | step_microstep: 99.17
[2024-07-26 15:46:41,320] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1541.31 | backward: 3126.04 | backward_inner: 3084.68 | backward_allreduce: 41.25 | step: 99.25
 80%|████████  | 161/200 [18:18<03:10,  4.89s/it]                                                 {'loss': 1.5911, 'grad_norm': 1.6667379108076346, 'learning_rate': 1.9289093800839067e-06, 'epoch': 3.98}
 80%|████████  | 161/200 [18:18<03:10,  4.89s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2528
[2024-07-26 15:46:43,520] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:46:43,521] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:46:43,521] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:46:43,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:43,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:43,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:46:43,521] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:46:43,521] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:46:43,596] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.78 | forward_fetch_submit: 0.06 | forward_all_gather: 27.72 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 16.30 | forward_prefetch_submit: 0.72 | backward_prefetch_wait: 0.26
[2024-07-26 15:46:43,615] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.56 | backward_microstep: 1516.37 | backward_inner_microstep: 1498.21 | backward_allreduce_microstep: 18.09 | step_microstep: 0.18
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2560
[2024-07-26 15:46:47,282] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:46:47,283] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:46:47,283] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:46:47,283] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:46:47,283] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:46:47,283] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:46:47,283] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:46:47,283] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:46:47,362] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 53.44 | forward_fetch_submit: 0.03 | forward_all_gather: 25.35 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 26.87 | forward_prefetch_submit: 1.32 | backward_prefetch_wait: 0.30
[2024-07-26 15:46:47,521] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.57
[2024-07-26 15:46:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 926.00 | backward_microstep: 1746.81 | backward_inner_microstep: 1694.11 | backward_allreduce_microstep: 52.65 | step_microstep: 106.68
[2024-07-26 15:46:47,522] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1678.54 | backward: 3263.19 | backward_inner: 3192.34 | backward_allreduce: 70.74 | step: 106.87
 81%|████████  | 162/200 [18:24<03:20,  5.28s/it]                                                 {'loss': 1.6015, 'grad_norm': 1.2485104353529906, 'learning_rate': 1.8343633694278895e-06, 'epoch': 4.0}
 81%|████████  | 162/200 [18:24<03:20,  5.28s/it][INFO|trainer.py:3819] 2024-07-26 15:46:47,538 >> 
***** Running Evaluation *****
[INFO|trainer.py:3821] 2024-07-26 15:46:47,538 >>   Num examples = 160
[INFO|trainer.py:3824] 2024-07-26 15:46:47,538 >>   Batch size = 8
[2024-07-26 15:46:48,698] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:48,700] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:48,755] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:48,772] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:53,187] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:53,225] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:53,265] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:53,280] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:57,307] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:57,674] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:57,700] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:46:57,707] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:47:01,342] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:47:01,688] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:47:01,893] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:47:01,954] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2605
[2024-07-26 15:47:07,596] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:47:07,597] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:47:07,597] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 101, numel = 7771070464
[2024-07-26 15:47:07,597] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 101, numel = 7771070464
[2024-07-26 15:47:07,619] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 215.64 | forward_fetch_submit: 0.00 | forward_all_gather: 17.78 | forward_prefetch_submit: 1.03

  0%|          | 0/5 [00:00<?, ?it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2618
[2024-07-26 15:47:08,985] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:47:08,985] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:47:08,985] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:47:08,985] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:47:09,008] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.28 | forward_fetch_submit: 0.00 | forward_all_gather: 17.71 | forward_prefetch_submit: 0.70

 40%|████      | 2/5 [00:01<00:02,  1.44it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:47:10,378] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:47:10,378] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:47:10,378] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:47:10,378] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:47:10,401] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.87 | forward_fetch_submit: 0.00 | forward_all_gather: 15.67 | forward_prefetch_submit: 0.69

 60%|██████    | 3/5 [00:02<00:01,  1.01it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:47:11,925] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:47:11,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:47:11,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:47:11,926] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:47:11,948] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.88 | forward_fetch_submit: 0.00 | forward_all_gather: 17.61 | forward_prefetch_submit: 0.68

 80%|████████  | 4/5 [00:04<00:01,  1.20s/it][Apetrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:47:14,526] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:47:14,526] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:47:14,526] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:47:14,526] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:47:14,550] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.28 | forward_fetch_submit: 0.00 | forward_all_gather: 17.89 | forward_prefetch_submit: 0.87

100%|██████████| 5/5 [00:06<00:00,  1.68s/it][A                                                 
                                             [A{'eval_loss': 1.6329867839813232, 'eval_runtime': 27.212, 'eval_samples_per_second': 5.88, 'eval_steps_per_second': 0.184, 'epoch': 4.0}
 81%|████████  | 162/200 [18:51<03:20,  5.28s/it]
100%|██████████| 5/5 [00:07<00:00,  1.68s/it][A
                                             [A[INFO|trainer.py:3503] 2024-07-26 15:47:26,080 >> Saving model checkpoint to work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162
[INFO|configuration_utils.py:472] 2024-07-26 15:47:26,082 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/config.json
[INFO|configuration_utils.py:807] 2024-07-26 15:47:26,083 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/generation_config.json
[INFO|modeling_utils.py:2750] 2024-07-26 15:47:49,071 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 4 checkpoint shards. You can find where each parameters has been saved in the index located at work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2702] 2024-07-26 15:47:49,073 >> tokenizer config file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/tokenizer_config.json
[INFO|tokenization_utils_base.py:2711] 2024-07-26 15:47:49,073 >> Special tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/special_tokens_map.json
[INFO|tokenization_utils_base.py:2762] 2024-07-26 15:47:49,073 >> added tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/added_tokens.json
[2024-07-26 15:47:49,190] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step162 is about to be saved!
[2024-07-26 15:47:52,074] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/global_step162/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-07-26 15:47:52,074] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/global_step162/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-07-26 15:47:56,671] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/global_step162/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-07-26 15:47:56,708] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/global_step162/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-07-26 15:47:57,802] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/global_step162/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-07-26 15:47:57,803] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-162/global_step162/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-07-26 15:47:57,911] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step162 is ready now!
[INFO|trainer.py:3595] 2024-07-26 15:47:57,924 >> Deleting older checkpoint [work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-40] due to args.save_total_limit
[2024-07-26 15:47:59,178] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:47:59,178] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:47:59,187] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:03,164] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:03,645] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:03,747] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:06,757] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:07,620] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:07,720] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:08,799] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:10,477] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:11,651] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:12,021] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:12,490] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:16,249] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:48:19,641] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2543
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:48:24,903] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:48:24,982] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 35.07 | forward_fetch_submit: 0.06 | forward_all_gather: 31.59 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 16.55 | forward_prefetch_submit: 1.07 | backward_prefetch_wait: 0.26
[2024-07-26 15:48:25,230] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 775.18 | backward_microstep: 1786.85 | backward_inner_microstep: 1539.02 | backward_allreduce_microstep: 247.75 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2528
[2024-07-26 15:48:27,415] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:48:27,416] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:48:27,416] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:48:27,416] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:27,416] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:27,416] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:48:27,416] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:48:27,416] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:48:27,495] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.40 | forward_fetch_submit: 0.03 | forward_all_gather: 20.94 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 133.31 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:48:27,634] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.45
[2024-07-26 15:48:27,635] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.82 | backward_microstep: 1516.98 | backward_inner_microstep: 1493.81 | backward_allreduce_microstep: 23.12 | step_microstep: 116.34
[2024-07-26 15:48:27,636] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1524.98 | backward: 3303.85 | backward_inner: 3032.85 | backward_allreduce: 270.88 | step: 116.42
 82%|████████▏ | 163/200 [20:04<20:48, 33.73s/it]                                                 {'loss': 1.5005, 'grad_norm': 1.2311801456853166, 'learning_rate': 1.7419586554574364e-06, 'epoch': 4.02}
 82%|████████▏ | 163/200 [20:04<20:48, 33.73s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2591
[2024-07-26 15:48:29,879] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:48:29,879] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:48:29,880] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:48:29,880] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:29,880] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:29,880] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:48:29,880] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:48:29,880] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:48:29,960] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.44 | forward_fetch_submit: 0.06 | forward_all_gather: 32.79 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.51 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.26
[2024-07-26 15:48:29,984] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.08 | backward_microstep: 1547.98 | backward_inner_microstep: 1525.01 | backward_allreduce_microstep: 22.89 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2550
[2024-07-26 15:48:32,247] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:48:32,248] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:48:32,248] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:48:32,248] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:32,248] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:32,248] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:48:32,248] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:48:32,248] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:48:32,324] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.92 | forward_fetch_submit: 0.03 | forward_all_gather: 23.98 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 135.81 | forward_prefetch_submit: 1.04 | backward_prefetch_wait: 0.31
[2024-07-26 15:48:32,460] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.49
[2024-07-26 15:48:32,461] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 777.76 | backward_microstep: 1570.14 | backward_inner_microstep: 1540.62 | backward_allreduce_microstep: 29.47 | step_microstep: 107.07
[2024-07-26 15:48:32,462] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1548.81 | backward: 3118.13 | backward_inner: 3065.65 | backward_allreduce: 52.36 | step: 107.16
 82%|████████▏ | 164/200 [20:09<15:02, 25.06s/it]                                                 {'loss': 1.4527, 'grad_norm': 1.085973173990506, 'learning_rate': 1.6517194697072903e-06, 'epoch': 4.05}
 82%|████████▏ | 164/200 [20:09<15:02, 25.06s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2608
[2024-07-26 15:48:34,701] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:48:34,702] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:48:34,702] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:48:34,702] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:34,702] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:34,702] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:48:34,702] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:48:34,702] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:48:34,782] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.08 | forward_fetch_submit: 0.06 | forward_all_gather: 31.72 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.91 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.25
[2024-07-26 15:48:34,801] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.79 | backward_microstep: 1546.51 | backward_inner_microstep: 1528.44 | backward_allreduce_microstep: 17.99 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2545
[2024-07-26 15:48:37,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:48:37,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:48:37,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:48:37,032] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:37,032] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:37,032] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:48:37,032] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:48:37,033] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:48:37,111] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 17.55 | forward_fetch_submit: 0.03 | forward_all_gather: 22.08 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 135.10 | forward_prefetch_submit: 0.90 | backward_prefetch_wait: 0.30
[2024-07-26 15:48:37,466] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.68
[2024-07-26 15:48:37,467] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 761.27 | backward_microstep: 1771.55 | backward_inner_microstep: 1527.03 | backward_allreduce_microstep: 244.45 | step_microstep: 110.75
[2024-07-26 15:48:37,467] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1527.04 | backward: 3318.06 | backward_inner: 3055.49 | backward_allreduce: 262.45 | step: 110.84
 82%|████████▎ | 165/200 [20:14<11:06, 19.04s/it]                                                 {'loss': 1.5137, 'grad_norm': 1.4869965964606149, 'learning_rate': 1.5636694758399563e-06, 'epoch': 4.07}
 82%|████████▎ | 165/200 [20:14<11:06, 19.04s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2531
[2024-07-26 15:48:39,661] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:48:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:48:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:48:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:48:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:48:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:48:39,741] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.94 | forward_fetch_submit: 0.06 | forward_all_gather: 28.39 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 16.28 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:48:39,954] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 749.23 | backward_microstep: 1709.77 | backward_inner_microstep: 1497.37 | backward_allreduce_microstep: 212.32 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2513
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:48:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:48:43,235] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.66 | forward_fetch_submit: 0.03 | forward_all_gather: 21.43 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 132.80 | forward_prefetch_submit: 0.99 | backward_prefetch_wait: 0.30
[2024-07-26 15:48:43,350] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.52
[2024-07-26 15:48:43,351] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.94 | backward_microstep: 2515.06 | backward_inner_microstep: 2497.06 | backward_allreduce_microstep: 17.95 | step_microstep: 97.54
[2024-07-26 15:48:43,351] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1510.15 | backward: 4224.83 | backward_inner: 3994.44 | backward_allreduce: 230.28 | step: 97.64
 83%|████████▎ | 166/200 [20:20<08:33, 15.10s/it]                                                 {'loss': 1.5089, 'grad_norm': 1.249629816637584, 'learning_rate': 1.4778317634403082e-06, 'epoch': 4.1}
 83%|████████▎ | 166/200 [20:20<08:33, 15.10s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2562
[2024-07-26 15:48:45,612] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:48:45,613] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:48:45,613] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:48:45,613] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:45,613] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:45,613] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:48:45,613] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:48:45,613] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:48:45,693] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.04 | forward_fetch_submit: 0.06 | forward_all_gather: 32.45 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.73 | forward_prefetch_submit: 1.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:48:45,716] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.32 | backward_microstep: 1568.95 | backward_inner_microstep: 1546.57 | backward_allreduce_microstep: 22.30 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2611
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:48:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:48:48,212] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 176.05 | forward_fetch_submit: 0.03 | forward_all_gather: 19.40 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 123.26 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:48:48,327] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:48:48,328] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.77 | backward_microstep: 1721.47 | backward_inner_microstep: 1703.75 | backward_allreduce_microstep: 17.66 | step_microstep: 97.70
[2024-07-26 15:48:48,329] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1540.06 | backward: 3290.42 | backward_inner: 3250.34 | backward_allreduce: 39.97 | step: 97.78
 84%|████████▎ | 167/200 [20:25<06:37, 12.06s/it]                                                 {'loss': 1.5396, 'grad_norm': 1.4596960921556856, 'learning_rate': 1.3942288419607476e-06, 'epoch': 4.12}
 84%|████████▎ | 167/200 [20:25<06:37, 12.06s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2570
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:48:50,565] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:48:50,646] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.98 | forward_fetch_submit: 0.06 | forward_all_gather: 30.89 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.52 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:48:50,665] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.85 | backward_microstep: 1546.26 | backward_inner_microstep: 1527.76 | backward_allreduce_microstep: 18.43 | step_microstep: 0.08
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2533
[2024-07-26 15:48:52,889] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:48:52,889] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:48:52,889] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:48:52,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:52,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:52,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:48:52,890] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:48:52,890] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:48:52,956] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.60 | forward_fetch_submit: 0.03 | forward_all_gather: 22.84 | backward_fetch_wait: 5.53 | backward_fetch_submit: 0.00 | backward_all_gather: 136.08 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.31
[2024-07-26 15:48:53,102] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:48:53,103] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.32 | backward_microstep: 1554.28 | backward_inner_microstep: 1515.54 | backward_allreduce_microstep: 38.69 | step_microstep: 107.99
[2024-07-26 15:48:53,103] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1518.16 | backward: 3100.55 | backward_inner: 3043.32 | backward_allreduce: 57.12 | step: 108.08
 84%|████████▍ | 168/200 [20:30<05:15,  9.87s/it]                                                 {'loss': 1.5147, 'grad_norm': 1.1801882640508587, 'learning_rate': 1.3128826348184886e-06, 'epoch': 4.15}
 84%|████████▍ | 168/200 [20:30<05:15,  9.87s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2547
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:48:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:48:55,412] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.84 | forward_fetch_submit: 0.06 | forward_all_gather: 27.69 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.29 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:48:55,431] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.22 | backward_microstep: 1532.99 | backward_inner_microstep: 1514.80 | backward_allreduce_microstep: 18.12 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2522
[2024-07-26 15:48:57,670] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:48:57,670] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:48:57,670] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:48:57,670] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:48:57,670] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:48:57,670] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:48:57,670] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:48:57,671] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:48:57,744] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.24 | forward_fetch_submit: 0.03 | forward_all_gather: 21.59 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 129.62 | forward_prefetch_submit: 0.86 | backward_prefetch_wait: 0.30
[2024-07-26 15:48:57,867] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:48:57,868] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 756.95 | backward_microstep: 1553.57 | backward_inner_microstep: 1534.98 | backward_allreduce_microstep: 18.53 | step_microstep: 104.76
[2024-07-26 15:48:57,868] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1521.15 | backward: 3086.57 | backward_inner: 3049.80 | backward_allreduce: 36.66 | step: 104.84
 84%|████████▍ | 169/200 [20:34<04:18,  8.34s/it]                                                 {'loss': 1.4801, 'grad_norm': 1.2741416411819657, 'learning_rate': 1.233814473646524e-06, 'epoch': 4.17}
 84%|████████▍ | 169/200 [20:34<04:18,  8.34s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2569
[2024-07-26 15:49:00,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:00,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:00,155] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:00,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:00,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:00,155] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:00,156] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:00,156] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:00,224] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.62 | forward_fetch_submit: 0.06 | forward_all_gather: 32.03 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 17.97 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:49:00,393] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 758.49 | backward_microstep: 1740.10 | backward_inner_microstep: 1571.51 | backward_allreduce_microstep: 168.52 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2577
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:02,955] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 16.82 | forward_fetch_submit: 0.03 | forward_all_gather: 22.20 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 118.02 | forward_prefetch_submit: 0.96 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:03,069] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.35
[2024-07-26 15:49:03,070] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.75 | backward_microstep: 1780.27 | backward_inner_microstep: 1762.07 | backward_allreduce_microstep: 18.15 | step_microstep: 97.07
[2024-07-26 15:49:03,071] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1535.23 | backward: 3520.38 | backward_inner: 3333.59 | backward_allreduce: 186.67 | step: 97.16
 85%|████████▌ | 170/200 [20:40<03:41,  7.40s/it]                                                 {'loss': 1.4865, 'grad_norm': 1.3041454145836955, 'learning_rate': 1.1570450926997657e-06, 'epoch': 4.2}
 85%|████████▌ | 170/200 [20:40<03:41,  7.40s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2578
[2024-07-26 15:49:05,355] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:05,356] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:05,436] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 29.45 | forward_fetch_submit: 0.06 | forward_all_gather: 33.40 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.37 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.26
[2024-07-26 15:49:05,461] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 780.09 | backward_microstep: 1582.66 | backward_inner_microstep: 1558.30 | backward_allreduce_microstep: 24.29 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2502
[2024-07-26 15:49:07,653] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:07,654] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:07,654] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:07,654] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:07,654] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:07,654] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:07,654] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:07,654] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:07,730] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.37 | forward_fetch_submit: 0.03 | forward_all_gather: 20.76 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.00 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:08,043] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.57
[2024-07-26 15:49:08,045] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 753.51 | backward_microstep: 1701.59 | backward_inner_microstep: 1493.71 | backward_allreduce_microstep: 207.82 | step_microstep: 106.34
[2024-07-26 15:49:08,045] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1533.58 | backward: 3284.25 | backward_inner: 3052.02 | backward_allreduce: 232.12 | step: 106.42
 86%|████████▌ | 171/200 [20:45<03:13,  6.67s/it]                                                 {'loss': 1.4724, 'grad_norm': 1.2936243037400805, 'learning_rate': 1.0825946234178575e-06, 'epoch': 4.22}
 86%|████████▌ | 171/200 [20:45<03:13,  6.67s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2536
[2024-07-26 15:49:10,321] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:10,321] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:10,321] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:10,321] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:10,321] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:10,322] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:10,322] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:10,322] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:10,400] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.04 | forward_fetch_submit: 0.06 | forward_all_gather: 26.82 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.18 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.25
[2024-07-26 15:49:10,419] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 750.15 | backward_microstep: 1521.23 | backward_inner_microstep: 1503.22 | backward_allreduce_microstep: 17.94 | step_microstep: 0.08
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2526
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:12,616] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:12,683] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.89 | forward_fetch_submit: 0.03 | forward_all_gather: 23.42 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 131.98 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:12,840] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.36
[2024-07-26 15:49:12,842] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 758.70 | backward_microstep: 1529.34 | backward_inner_microstep: 1484.74 | backward_allreduce_microstep: 44.54 | step_microstep: 113.34
[2024-07-26 15:49:12,842] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1508.83 | backward: 3050.57 | backward_inner: 2987.97 | backward_allreduce: 62.49 | step: 113.43
 86%|████████▌ | 172/200 [20:49<02:51,  6.11s/it]                                                 {'loss': 1.3905, 'grad_norm': 1.3384501104194597, 'learning_rate': 1.010482589146048e-06, 'epoch': 4.25}
 86%|████████▌ | 172/200 [20:49<02:51,  6.11s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2568
[2024-07-26 15:49:15,079] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:15,079] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:15,080] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:15,080] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:15,080] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:15,080] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:15,080] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:15,080] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:15,158] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.77 | forward_fetch_submit: 0.06 | forward_all_gather: 30.44 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.85 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:49:15,188] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.97 | backward_microstep: 1553.25 | backward_inner_microstep: 1523.70 | backward_allreduce_microstep: 29.48 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2510
[2024-07-26 15:49:17,389] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:17,389] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:17,389] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:17,389] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:17,389] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:17,389] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:17,390] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:17,390] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:17,470] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.39 | forward_fetch_submit: 0.03 | forward_all_gather: 20.35 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 136.07 | forward_prefetch_submit: 0.96 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:17,588] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.40
[2024-07-26 15:49:17,590] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.51 | backward_microstep: 1515.58 | backward_inner_microstep: 1497.13 | backward_allreduce_microstep: 18.39 | step_microstep: 100.54
[2024-07-26 15:49:17,590] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1528.46 | backward: 3068.84 | backward_inner: 3020.85 | backward_allreduce: 47.88 | step: 100.62
 86%|████████▋ | 173/200 [20:54<02:33,  5.70s/it]                                                 {'loss': 1.2772, 'grad_norm': 1.5432655160297477, 'learning_rate': 9.407279000155311e-07, 'epoch': 4.27}
 86%|████████▋ | 173/200 [20:54<02:33,  5.70s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2565
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:19,925] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.18 | forward_fetch_submit: 0.06 | forward_all_gather: 33.92 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.61 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:49:20,095] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.30 | backward_microstep: 1707.75 | backward_inner_microstep: 1538.48 | backward_allreduce_microstep: 169.18 | step_microstep: 0.11
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2556
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:22,421] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.20 | forward_fetch_submit: 0.03 | forward_all_gather: 22.65 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 137.59 | forward_prefetch_submit: 1.05 | backward_prefetch_wait: 0.31
[2024-07-26 15:49:22,708] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.49
[2024-07-26 15:49:22,709] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.64 | backward_microstep: 1713.58 | backward_inner_microstep: 1531.26 | backward_allreduce_microstep: 182.25 | step_microstep: 105.49
[2024-07-26 15:49:22,710] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1542.92 | backward: 3421.33 | backward_inner: 3069.77 | backward_allreduce: 351.45 | step: 105.60
 87%|████████▋ | 174/200 [20:59<02:23,  5.53s/it]                                                 {'loss': 1.5808, 'grad_norm': 1.5209595609832913, 'learning_rate': 8.733488479845997e-07, 'epoch': 4.3}
 87%|████████▋ | 174/200 [20:59<02:23,  5.53s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2600
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:25,162] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:25,242] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.72 | forward_fetch_submit: 0.06 | forward_all_gather: 227.89 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 19.80 | forward_prefetch_submit: 189.24 | backward_prefetch_wait: 0.26
[2024-07-26 15:49:25,261] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 971.07 | backward_microstep: 1553.85 | backward_inner_microstep: 1535.83 | backward_allreduce_microstep: 17.94 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2520
[2024-07-26 15:49:27,441] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:27,441] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:27,442] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:27,442] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:27,442] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:27,442] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:27,442] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:27,442] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:27,521] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.25 | forward_fetch_submit: 0.03 | forward_all_gather: 21.87 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 131.77 | forward_prefetch_submit: 0.79 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:27,635] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.30
[2024-07-26 15:49:27,637] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 745.37 | backward_microstep: 1510.81 | backward_inner_microstep: 1493.64 | backward_allreduce_microstep: 17.12 | step_microstep: 97.56
[2024-07-26 15:49:27,638] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1716.42 | backward: 3064.66 | backward_inner: 3029.49 | backward_allreduce: 35.06 | step: 97.64
 88%|████████▊ | 175/200 [21:04<02:13,  5.35s/it]                                                 {'loss': 1.5705, 'grad_norm': 1.612999044721127, 'learning_rate': 8.083631020418792e-07, 'epoch': 4.32}
 88%|████████▊ | 175/200 [21:04<02:13,  5.35s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2539
[2024-07-26 15:49:30,015] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:30,015] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:30,015] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:30,015] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:30,015] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:30,015] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:30,015] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:30,016] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:30,095] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 147.46 | forward_fetch_submit: 0.06 | forward_all_gather: 27.87 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.73 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:49:30,114] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.38 | backward_microstep: 1682.17 | backward_inner_microstep: 1663.96 | backward_allreduce_microstep: 18.13 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2601
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:32,379] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:32,459] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.65 | forward_fetch_submit: 0.03 | forward_all_gather: 21.48 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 35.46 | forward_prefetch_submit: 0.82 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:32,586] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.42
[2024-07-26 15:49:32,587] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 789.34 | backward_microstep: 1551.96 | backward_inner_microstep: 1534.19 | backward_allreduce_microstep: 17.71 | step_microstep: 109.81
[2024-07-26 15:49:32,587] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1556.69 | backward: 3234.13 | backward_inner: 3198.18 | backward_allreduce: 35.84 | step: 109.89
 88%|████████▊ | 176/200 [21:09<02:05,  5.23s/it]                                                 {'loss': 1.447, 'grad_norm': 4.29309118907957, 'learning_rate': 7.457877035729588e-07, 'epoch': 4.35}
 88%|████████▊ | 176/200 [21:09<02:05,  5.23s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2548
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:34,821] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:34,902] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.88 | forward_fetch_submit: 0.06 | forward_all_gather: 27.46 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.37 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:49:34,922] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.26 | backward_microstep: 1541.07 | backward_inner_microstep: 1521.56 | backward_allreduce_microstep: 19.43 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2542
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:37,122] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:37,203] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.36 | forward_fetch_submit: 0.03 | forward_all_gather: 20.54 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 133.11 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:37,322] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.46
[2024-07-26 15:49:37,323] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.72 | backward_microstep: 1517.12 | backward_inner_microstep: 1499.11 | backward_allreduce_microstep: 17.95 | step_microstep: 102.04
[2024-07-26 15:49:37,324] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1526.96 | backward: 3058.19 | backward_inner: 3020.69 | backward_allreduce: 37.39 | step: 102.13
 88%|████████▊ | 177/200 [21:14<01:56,  5.08s/it]                                                 {'loss': 1.5286, 'grad_norm': 1.4339439097674298, 'learning_rate': 6.856390618915775e-07, 'epoch': 4.37}
 88%|████████▊ | 177/200 [21:14<01:56,  5.08s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2578
[2024-07-26 15:49:39,567] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:39,568] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:39,568] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:39,568] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:39,568] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:39,568] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:39,568] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:39,568] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:39,649] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.40 | forward_fetch_submit: 0.06 | forward_all_gather: 32.64 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.85 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:49:39,668] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 768.20 | backward_microstep: 1549.18 | backward_inner_microstep: 1530.74 | backward_allreduce_microstep: 18.37 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2510
[2024-07-26 15:49:42,097] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:42,098] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:42,179] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 215.92 | forward_fetch_submit: 0.03 | forward_all_gather: 23.06 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 135.88 | forward_prefetch_submit: 0.94 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:42,315] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.47
[2024-07-26 15:49:42,316] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.71 | backward_microstep: 1755.76 | backward_inner_microstep: 1727.37 | backward_allreduce_microstep: 28.32 | step_microstep: 107.59
[2024-07-26 15:49:42,316] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1530.89 | backward: 3304.94 | backward_inner: 3258.14 | backward_allreduce: 46.69 | step: 107.68
 89%|████████▉ | 178/200 [21:19<01:51,  5.05s/it]                                                 {'loss': 1.5922, 'grad_norm': 1.3727744934944421, 'learning_rate': 6.279329499365649e-07, 'epoch': 4.4}
 89%|████████▉ | 178/200 [21:19<01:51,  5.05s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2591
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:44,763] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:44,840] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.74 | forward_fetch_submit: 0.06 | forward_all_gather: 31.79 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 20.10 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:49:44,904] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.76 | backward_microstep: 1791.00 | backward_inner_microstep: 1727.76 | backward_allreduce_microstep: 63.16 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2545
[2024-07-26 15:49:47,106] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:47,106] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:47,106] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:47,106] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:47,106] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:47,107] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:47,107] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:47,107] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:47,187] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.36 | forward_fetch_submit: 0.03 | forward_all_gather: 21.65 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 134.11 | forward_prefetch_submit: 0.94 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:47,311] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.27
[2024-07-26 15:49:47,312] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 759.26 | backward_microstep: 1522.52 | backward_inner_microstep: 1501.76 | backward_allreduce_microstep: 20.70 | step_microstep: 103.58
[2024-07-26 15:49:47,312] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1530.00 | backward: 3313.52 | backward_inner: 3229.53 | backward_allreduce: 83.87 | step: 103.68
 90%|████████▉ | 179/200 [21:24<01:45,  5.04s/it]                                                 {'loss': 1.5526, 'grad_norm': 1.1626845065478235, 'learning_rate': 5.726845001356573e-07, 'epoch': 4.42}
 90%|████████▉ | 179/200 [21:24<01:45,  5.04s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2553
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:49,620] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:49,700] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.30 | forward_fetch_submit: 0.06 | forward_all_gather: 27.77 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 18.21 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:49:49,828] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.95 | backward_microstep: 1725.99 | backward_inner_microstep: 1597.75 | backward_allreduce_microstep: 128.17 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:49:52,076] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:52,077] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:52,157] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.88 | forward_fetch_submit: 0.03 | forward_all_gather: 21.02 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 45.08 | forward_prefetch_submit: 0.92 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:52,269] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.34
[2024-07-26 15:49:52,271] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 784.12 | backward_microstep: 1541.49 | backward_inner_microstep: 1523.50 | backward_allreduce_microstep: 17.93 | step_microstep: 95.36
[2024-07-26 15:49:52,271] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1547.05 | backward: 3267.48 | backward_inner: 3121.27 | backward_allreduce: 146.11 | step: 95.44
 90%|█████████ | 180/200 [21:29<01:40,  5.01s/it]                                                 {'loss': 1.4439, 'grad_norm': 1.7759742216223324, 'learning_rate': 5.199082004372958e-07, 'epoch': 4.44}
 90%|█████████ | 180/200 [21:29<01:40,  5.01s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2606
[2024-07-26 15:49:54,549] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:54,549] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:54,549] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:54,549] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:54,550] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:54,550] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:54,550] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:54,550] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:54,630] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 25.65 | forward_fetch_submit: 0.06 | forward_all_gather: 32.95 | backward_fetch_wait: 5.64 | backward_fetch_submit: 0.00 | backward_all_gather: 19.55 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:49:54,650] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.50 | backward_microstep: 1574.56 | backward_inner_microstep: 1555.92 | backward_allreduce_microstep: 18.56 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2518
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:49:56,837] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:49:56,917] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.96 | forward_fetch_submit: 0.03 | forward_all_gather: 21.96 | backward_fetch_wait: 5.55 | backward_fetch_submit: 0.00 | backward_all_gather: 135.44 | forward_prefetch_submit: 0.95 | backward_prefetch_wait: 0.30
[2024-07-26 15:49:57,031] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.20
[2024-07-26 15:49:57,033] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 750.39 | backward_microstep: 1513.36 | backward_inner_microstep: 1495.24 | backward_allreduce_microstep: 18.06 | step_microstep: 97.01
[2024-07-26 15:49:57,033] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1526.87 | backward: 3087.92 | backward_inner: 3051.18 | backward_allreduce: 36.63 | step: 97.09
 90%|█████████ | 181/200 [21:34<01:33,  4.94s/it]                                                 {'loss': 1.4988, 'grad_norm': 1.2036977558504536, 'learning_rate': 4.696178905113913e-07, 'epoch': 4.47}
 90%|█████████ | 181/200 [21:34<01:33,  4.94s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2548
[2024-07-26 15:49:59,234] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:49:59,234] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:49:59,234] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:49:59,234] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:49:59,235] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:49:59,235] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:49:59,235] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:49:59,235] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:49:59,315] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.16 | forward_fetch_submit: 0.06 | forward_all_gather: 27.43 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 16.53 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:49:59,333] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.48 | backward_microstep: 1518.35 | backward_inner_microstep: 1500.53 | backward_allreduce_microstep: 17.76 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2777
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:01,752] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.48 | forward_fetch_submit: 0.03 | forward_all_gather: 18.97 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 23.22 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:02,050] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.26
[2024-07-26 15:50:02,052] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 806.58 | backward_microstep: 1784.19 | backward_inner_microstep: 1590.91 | backward_allreduce_microstep: 193.23 | step_microstep: 106.20
[2024-07-26 15:50:02,052] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1559.03 | backward: 3302.55 | backward_inner: 3091.45 | backward_allreduce: 210.99 | step: 106.28
 91%|█████████ | 182/200 [21:39<01:29,  4.96s/it]                                                 {'loss': 1.3705, 'grad_norm': 1.286771134090653, 'learning_rate': 4.218267581201296e-07, 'epoch': 4.49}
 91%|█████████ | 182/200 [21:39<01:29,  4.96s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2546
[2024-07-26 15:50:04,458] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:04,459] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:04,459] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:04,459] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:04,459] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:04,459] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:04,459] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:04,459] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:04,529] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.69 | forward_fetch_submit: 0.06 | forward_all_gather: 28.00 | backward_fetch_wait: 5.66 | backward_fetch_submit: 0.00 | backward_all_gather: 16.42 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:50:04,549] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 762.53 | backward_microstep: 1705.80 | backward_inner_microstep: 1686.31 | backward_allreduce_microstep: 19.41 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2498
[2024-07-26 15:50:06,873] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:06,873] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:06,873] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:06,873] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:06,873] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:06,873] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:06,874] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:06,874] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:06,952] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.05 | forward_fetch_submit: 0.03 | forward_all_gather: 22.18 | backward_fetch_wait: 5.53 | backward_fetch_submit: 0.00 | backward_all_gather: 118.56 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:07,114] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.49
[2024-07-26 15:50:07,115] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 752.23 | backward_microstep: 1681.59 | backward_inner_microstep: 1627.42 | backward_allreduce_microstep: 54.12 | step_microstep: 108.21
[2024-07-26 15:50:07,115] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1514.74 | backward: 3387.39 | backward_inner: 3313.75 | backward_allreduce: 73.53 | step: 108.30
 92%|█████████▏| 183/200 [21:44<01:24,  4.99s/it]                                                 {'loss': 1.5433, 'grad_norm': 1.3712285450000057, 'learning_rate': 3.7654733565969826e-07, 'epoch': 4.52}
 92%|█████████▏| 183/200 [21:44<01:24,  4.99s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2609
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:09,370] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:09,449] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.85 | forward_fetch_submit: 0.06 | forward_all_gather: 31.35 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.48 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:50:09,467] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.90 | backward_microstep: 1549.86 | backward_inner_microstep: 1531.71 | backward_allreduce_microstep: 18.08 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:50:12,208] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:12,208] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:12,208] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:12,208] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:12,209] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:12,209] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:12,209] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:12,209] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:12,287] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 356.91 | forward_fetch_submit: 0.03 | forward_all_gather: 22.60 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 112.68 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.31
[2024-07-26 15:50:12,634] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.39
[2024-07-26 15:50:12,635] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 902.01 | backward_microstep: 2140.06 | backward_inner_microstep: 1896.14 | backward_allreduce_microstep: 243.85 | step_microstep: 103.37
[2024-07-26 15:50:12,635] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1674.90 | backward: 3689.92 | backward_inner: 3427.87 | backward_allreduce: 261.94 | step: 103.46
 92%|█████████▏| 184/200 [21:49<01:22,  5.15s/it]                                                 {'loss': 1.4698, 'grad_norm': 1.7214992715892414, 'learning_rate': 3.3379149687388866e-07, 'epoch': 4.54}
 92%|█████████▏| 184/200 [21:49<01:22,  5.15s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2566
[2024-07-26 15:50:14,861] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:14,862] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:14,862] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:14,862] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:14,862] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:14,862] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:14,862] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:14,862] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:14,943] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.84 | forward_fetch_submit: 0.06 | forward_all_gather: 31.07 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.58 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:50:14,962] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.12 | backward_microstep: 1537.81 | backward_inner_microstep: 1519.07 | backward_allreduce_microstep: 18.66 | step_microstep: 0.09
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2583
[2024-07-26 15:50:17,199] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:17,199] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:17,200] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:17,200] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:17,200] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:17,200] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:17,200] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:17,200] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:17,266] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.42 | forward_fetch_submit: 0.03 | forward_all_gather: 23.15 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 142.82 | forward_prefetch_submit: 0.96 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:17,416] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.53
[2024-07-26 15:50:17,418] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 758.73 | backward_microstep: 1562.48 | backward_inner_microstep: 1522.53 | backward_allreduce_microstep: 39.89 | step_microstep: 111.05
[2024-07-26 15:50:17,418] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1521.82 | backward: 3100.29 | backward_inner: 3041.61 | backward_allreduce: 58.56 | step: 111.14
 92%|█████████▎| 185/200 [21:54<01:15,  5.04s/it]                                                 {'loss': 1.3898, 'grad_norm': 1.868107455472464, 'learning_rate': 2.935704537404083e-07, 'epoch': 4.57}
 92%|█████████▎| 185/200 [21:54<01:15,  5.04s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2596
[2024-07-26 15:50:19,684] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:19,685] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:19,685] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:19,685] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:19,685] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:19,685] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:19,685] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:19,685] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:19,764] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.12 | forward_fetch_submit: 0.06 | forward_all_gather: 31.19 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.81 | forward_prefetch_submit: 0.77 | backward_prefetch_wait: 0.25
[2024-07-26 15:50:19,782] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.56 | backward_microstep: 1564.67 | backward_inner_microstep: 1547.42 | backward_allreduce_microstep: 17.18 | step_microstep: 0.07
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2529
[2024-07-26 15:50:21,979] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:22,059] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.67 | forward_fetch_submit: 0.03 | forward_all_gather: 20.84 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 134.18 | forward_prefetch_submit: 1.17 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:22,195] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.35
[2024-07-26 15:50:22,196] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 755.74 | backward_microstep: 1528.45 | backward_inner_microstep: 1502.07 | backward_allreduce_microstep: 26.32 | step_microstep: 110.32
[2024-07-26 15:50:22,197] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1528.29 | backward: 3093.12 | backward_inner: 3049.51 | backward_allreduce: 43.51 | step: 110.40
 93%|█████████▎| 186/200 [21:59<01:09,  4.96s/it]                                                 {'loss': 1.4977, 'grad_norm': 1.2690065414049168, 'learning_rate': 2.5589475353073987e-07, 'epoch': 4.59}
 93%|█████████▎| 186/200 [21:59<01:09,  4.96s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2564
[2024-07-26 15:50:24,605] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:24,605] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:24,606] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:24,606] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:24,606] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:24,606] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:24,606] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:24,606] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:24,686] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 160.52 | forward_fetch_submit: 0.06 | forward_all_gather: 31.85 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 20.16 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:50:24,704] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 779.97 | backward_microstep: 1696.98 | backward_inner_microstep: 1678.77 | backward_allreduce_microstep: 18.13 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2510
[2024-07-26 15:50:27,056] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:27,057] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:27,057] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:27,057] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:27,057] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:27,057] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:27,057] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:27,057] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:27,138] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.95 | forward_fetch_submit: 0.03 | forward_all_gather: 21.19 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 133.10 | forward_prefetch_submit: 0.81 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:27,301] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.45
[2024-07-26 15:50:27,303] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 746.34 | backward_microstep: 1722.73 | backward_inner_microstep: 1665.94 | backward_allreduce_microstep: 56.73 | step_microstep: 106.70
[2024-07-26 15:50:27,303] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1526.30 | backward: 3419.71 | backward_inner: 3344.73 | backward_allreduce: 74.87 | step: 106.79
 94%|█████████▎| 187/200 [22:04<01:05,  5.01s/it]                                                 {'loss': 1.5378, 'grad_norm': 1.6623227371411038, 'learning_rate': 2.2077427604429435e-07, 'epoch': 4.62}
 94%|█████████▎| 187/200 [22:04<01:05,  5.01s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:29,607] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.58 | forward_fetch_submit: 0.06 | forward_all_gather: 29.86 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.55 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:50:29,626] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.47 | backward_microstep: 1535.89 | backward_inner_microstep: 1517.56 | backward_allreduce_microstep: 18.25 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2541
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:32,058] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:32,138] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 227.10 | forward_fetch_submit: 0.03 | forward_all_gather: 22.13 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 133.20 | forward_prefetch_submit: 0.85 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:32,262] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:50:32,263] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 757.68 | backward_microstep: 1753.10 | backward_inner_microstep: 1733.51 | backward_allreduce_microstep: 19.54 | step_microstep: 104.99
[2024-07-26 15:50:32,264] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1518.13 | backward: 3289.00 | backward_inner: 3251.09 | backward_allreduce: 37.80 | step: 105.08
 94%|█████████▍| 188/200 [22:09<00:59,  4.99s/it]                                                 {'loss': 1.466, 'grad_norm': 1.3875894831923175, 'learning_rate': 1.8821823101760949e-07, 'epoch': 4.64}
 94%|█████████▍| 188/200 [22:09<00:59,  4.99s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2559
[2024-07-26 15:50:34,500] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:34,501] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:34,581] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.19 | forward_fetch_submit: 0.06 | forward_all_gather: 30.08 | backward_fetch_wait: 5.63 | backward_fetch_submit: 0.00 | backward_all_gather: 16.53 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:50:34,600] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.18 | backward_microstep: 1543.11 | backward_inner_microstep: 1524.75 | backward_allreduce_microstep: 18.29 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2501
[2024-07-26 15:50:36,910] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:36,910] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:36,910] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:36,910] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:36,910] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:36,910] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:36,911] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:36,911] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:36,988] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 54.83 | forward_fetch_submit: 0.03 | forward_all_gather: 28.13 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 134.30 | forward_prefetch_submit: 1.03 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:37,145] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.28
[2024-07-26 15:50:37,147] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 780.46 | backward_microstep: 1632.72 | backward_inner_microstep: 1584.90 | backward_allreduce_microstep: 47.77 | step_microstep: 109.92
[2024-07-26 15:50:37,147] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1547.62 | backward: 3175.84 | backward_inner: 3109.66 | backward_allreduce: 66.07 | step: 110.01
 94%|█████████▍| 189/200 [22:14<00:54,  4.96s/it]                                                 {'loss': 1.3958, 'grad_norm': 1.275547492842308, 'learning_rate': 1.5823515570925763e-07, 'epoch': 4.67}
 94%|█████████▍| 189/200 [22:14<00:54,  4.96s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2596
[2024-07-26 15:50:39,380] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:39,380] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:39,380] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:39,380] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:39,381] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:39,381] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:39,381] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:39,381] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:39,447] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.50 | forward_fetch_submit: 0.06 | forward_all_gather: 31.35 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.35 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:50:39,477] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 764.13 | backward_microstep: 1534.66 | backward_inner_microstep: 1505.96 | backward_allreduce_microstep: 28.63 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2586
[2024-07-26 15:50:41,727] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:41,727] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:41,727] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:41,728] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:41,728] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:41,728] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:41,728] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:41,728] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:41,808] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.41 | forward_fetch_submit: 0.03 | forward_all_gather: 19.48 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 45.00 | forward_prefetch_submit: 0.89 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:41,941] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.48
[2024-07-26 15:50:41,943] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 781.95 | backward_microstep: 1545.20 | backward_inner_microstep: 1526.93 | backward_allreduce_microstep: 18.21 | step_microstep: 116.24
[2024-07-26 15:50:41,943] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1546.06 | backward: 3079.87 | backward_inner: 3032.91 | backward_allreduce: 46.85 | step: 116.32
 95%|█████████▌| 190/200 [22:18<00:49,  4.91s/it]                                                 {'loss': 1.3803, 'grad_norm': 1.334805064056973, 'learning_rate': 1.30832912661093e-07, 'epoch': 4.69}
 95%|█████████▌| 190/200 [22:18<00:49,  4.91s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2576
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:44,249] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:44,329] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.81 | forward_fetch_submit: 0.06 | forward_all_gather: 33.00 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 17.08 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:50:44,501] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 771.06 | backward_microstep: 1757.22 | backward_inner_microstep: 1586.06 | backward_allreduce_microstep: 171.09 | step_microstep: 0.08
dynamic ViT batch size: 40, images per sample: 10.0, dynamic token length: 3577
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:47,355] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:47,442] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.32 | forward_fetch_submit: 0.03 | forward_all_gather: 21.21 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 19.40 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:47,567] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.94
[2024-07-26 15:50:47,568] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 987.53 | backward_microstep: 1949.74 | backward_inner_microstep: 1930.75 | backward_allreduce_microstep: 18.93 | step_microstep: 106.36
[2024-07-26 15:50:47,568] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1758.57 | backward: 3706.96 | backward_inner: 3516.83 | backward_allreduce: 190.02 | step: 106.45
 96%|█████████▌| 191/200 [22:24<00:46,  5.13s/it]                                                 {'loss': 1.5269, 'grad_norm': 1.3456239825185716, 'learning_rate': 1.0601868763643997e-07, 'epoch': 4.72}
 96%|█████████▌| 191/200 [22:24<00:46,  5.13s/it]dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2566
[2024-07-26 15:50:49,966] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:49,966] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:49,966] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:49,966] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:49,966] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:49,966] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:49,966] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:49,967] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:50,034] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.01 | forward_fetch_submit: 0.06 | forward_all_gather: 33.56 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 20.04 | forward_prefetch_submit: 0.76 | backward_prefetch_wait: 0.26
[2024-07-26 15:50:50,219] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 768.89 | backward_microstep: 1853.89 | backward_inner_microstep: 1669.44 | backward_allreduce_microstep: 184.37 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2675
[2024-07-26 15:50:52,519] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:52,600] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.72 | forward_fetch_submit: 0.03 | forward_all_gather: 21.91 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 20.20 | forward_prefetch_submit: 0.98 | backward_prefetch_wait: 0.30
[2024-07-26 15:50:52,877] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.52
[2024-07-26 15:50:52,879] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 798.29 | backward_microstep: 1730.94 | backward_inner_microstep: 1559.62 | backward_allreduce_microstep: 171.27 | step_microstep: 107.40
[2024-07-26 15:50:52,879] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1567.15 | backward: 3584.84 | backward_inner: 3229.08 | backward_allreduce: 355.65 | step: 107.49
 96%|█████████▌| 192/200 [22:29<00:41,  5.18s/it]                                                 {'loss': 1.3111, 'grad_norm': 1.4205125281179316, 'learning_rate': 8.379898773574924e-08, 'epoch': 4.74}
 96%|█████████▌| 192/200 [22:29<00:41,  5.18s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2603
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:50:55,207] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.46 | forward_fetch_submit: 0.06 | forward_all_gather: 31.54 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.64 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:50:55,226] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.47 | backward_microstep: 1550.98 | backward_inner_microstep: 1532.92 | backward_allreduce_microstep: 17.98 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2506
[2024-07-26 15:50:57,490] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:50:57,491] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:50:57,491] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:50:57,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:57,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:57,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:50:57,491] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:50:57,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:50:57,571] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 29.31 | forward_fetch_submit: 0.03 | forward_all_gather: 25.70 | backward_fetch_wait: 5.48 | backward_fetch_submit: 0.00 | backward_all_gather: 134.18 | forward_prefetch_submit: 0.87 | backward_prefetch_wait: 0.29
[2024-07-26 15:50:57,716] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.62
[2024-07-26 15:50:57,717] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 769.46 | backward_microstep: 1591.06 | backward_inner_microstep: 1553.84 | backward_allreduce_microstep: 37.15 | step_microstep: 108.59
[2024-07-26 15:50:57,718] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1538.91 | backward: 3142.04 | backward_inner: 3086.78 | backward_allreduce: 55.14 | step: 108.68
 96%|█████████▋| 193/200 [22:34<00:35,  5.08s/it]                                                 {'loss': 1.5438, 'grad_norm': 1.234649491625503, 'learning_rate': 6.417963969022389e-08, 'epoch': 4.77}
 96%|█████████▋| 193/200 [22:34<00:35,  5.08s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2579
[2024-07-26 15:50:59,948] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:50:59,949] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:50:59,949] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:50:59,949] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:50:59,949] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:50:59,949] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:50:59,949] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:50:59,949] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:51:00,031] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.66 | forward_fetch_submit: 0.06 | forward_all_gather: 31.33 | backward_fetch_wait: 5.60 | backward_fetch_submit: 0.00 | backward_all_gather: 19.58 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.25
[2024-07-26 15:51:00,050] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.73 | backward_microstep: 1541.80 | backward_inner_microstep: 1523.14 | backward_allreduce_microstep: 18.58 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2516
[2024-07-26 15:51:02,243] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:51:02,244] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:51:02,244] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:51:02,244] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:02,244] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:02,244] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:51:02,244] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:51:02,244] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:51:02,323] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 11.56 | forward_fetch_submit: 0.03 | forward_all_gather: 22.20 | backward_fetch_wait: 5.56 | backward_fetch_submit: 0.00 | backward_all_gather: 133.53 | forward_prefetch_submit: 1.26 | backward_prefetch_wait: 0.30
[2024-07-26 15:51:02,438] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:51:02,439] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 755.55 | backward_microstep: 1512.59 | backward_inner_microstep: 1494.79 | backward_allreduce_microstep: 17.75 | step_microstep: 98.11
[2024-07-26 15:51:02,439] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1519.26 | backward: 3054.39 | backward_inner: 3017.94 | backward_allreduce: 36.34 | step: 98.21
 97%|█████████▋| 194/200 [22:39<00:29,  4.97s/it]                                                 {'loss': 1.5992, 'grad_norm': 1.317693574678216, 'learning_rate': 4.716578833386054e-08, 'epoch': 4.79}
 97%|█████████▋| 194/200 [22:39<00:29,  4.97s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2587
[2024-07-26 15:51:04,685] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:51:04,686] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:51:04,686] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:51:04,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:04,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:04,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:51:04,686] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:51:04,686] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:51:04,766] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 21.22 | forward_fetch_submit: 0.06 | forward_all_gather: 31.61 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 19.35 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.25
[2024-07-26 15:51:04,975] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 767.82 | backward_microstep: 1741.56 | backward_inner_microstep: 1533.01 | backward_allreduce_microstep: 208.47 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2529
[2024-07-26 15:51:07,212] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:51:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:51:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:51:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:51:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:51:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:51:07,293] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 18.51 | forward_fetch_submit: 0.03 | forward_all_gather: 22.45 | backward_fetch_wait: 5.53 | backward_fetch_submit: 0.00 | backward_all_gather: 136.02 | forward_prefetch_submit: 1.04 | backward_prefetch_wait: 0.30
[2024-07-26 15:51:07,427] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.38
[2024-07-26 15:51:07,428] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.21 | backward_microstep: 1552.79 | backward_inner_microstep: 1525.76 | backward_allreduce_microstep: 26.97 | step_microstep: 107.55
[2024-07-26 15:51:07,429] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1538.02 | backward: 3294.35 | backward_inner: 3058.79 | backward_allreduce: 235.45 | step: 107.65
 98%|█████████▊| 195/200 [22:44<00:24,  4.98s/it]                                                 {'loss': 1.3971, 'grad_norm': 1.4086801846222115, 'learning_rate': 3.2761895254306285e-08, 'epoch': 4.81}
 98%|█████████▊| 195/200 [22:44<00:24,  4.98s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2598
[2024-07-26 15:51:09,842] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:51:09,843] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:51:09,843] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:51:09,843] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:09,843] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:09,843] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:51:09,843] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:51:09,843] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:51:09,922] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 19.87 | forward_fetch_submit: 0.06 | forward_all_gather: 32.18 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 19.57 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.25
[2024-07-26 15:51:09,940] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 772.19 | backward_microstep: 1711.58 | backward_inner_microstep: 1694.31 | backward_allreduce_microstep: 17.19 | step_microstep: 0.07
dynamic ViT batch size: 34, images per sample: 8.5, dynamic token length: 2552
[2024-07-26 15:51:12,270] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:51:12,270] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:51:12,270] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:51:12,270] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:12,270] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:12,271] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:51:12,271] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:51:12,271] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:51:12,338] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 13.74 | forward_fetch_submit: 0.03 | forward_all_gather: 21.91 | backward_fetch_wait: 5.51 | backward_fetch_submit: 0.00 | backward_all_gather: 124.34 | forward_prefetch_submit: 0.80 | backward_prefetch_wait: 0.30
[2024-07-26 15:51:12,510] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 6.25
[2024-07-26 15:51:12,512] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 750.44 | backward_microstep: 1693.88 | backward_inner_microstep: 1627.06 | backward_allreduce_microstep: 66.77 | step_microstep: 106.93
[2024-07-26 15:51:12,512] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1522.61 | backward: 3405.46 | backward_inner: 3321.38 | backward_allreduce: 83.97 | step: 107.01
 98%|█████████▊| 196/200 [22:49<00:20,  5.01s/it]                                                 {'loss': 1.2927, 'grad_norm': 1.1844658281951261, 'learning_rate': 2.0971737622883515e-08, 'epoch': 4.84}
 98%|█████████▊| 196/200 [22:49<00:20,  5.01s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2558
[2024-07-26 15:51:14,840] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:51:14,841] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:51:14,841] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:51:14,841] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:14,841] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:14,841] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:51:14,841] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:51:14,841] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:51:14,916] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 28.66 | forward_fetch_submit: 0.06 | forward_all_gather: 28.05 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 18.75 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:51:15,014] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 765.94 | backward_microstep: 1710.00 | backward_inner_microstep: 1613.22 | backward_allreduce_microstep: 96.70 | step_microstep: 0.09
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2550
[2024-07-26 15:51:17,224] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:51:17,224] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:51:17,225] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:51:17,225] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:17,225] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:17,225] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:51:17,225] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:51:17,225] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:51:17,304] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.68 | forward_fetch_submit: 0.03 | forward_all_gather: 21.89 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 132.45 | forward_prefetch_submit: 1.00 | backward_prefetch_wait: 0.30
[2024-07-26 15:51:17,418] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.25
[2024-07-26 15:51:17,419] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 763.31 | backward_microstep: 1520.60 | backward_inner_microstep: 1503.23 | backward_allreduce_microstep: 17.31 | step_microstep: 97.11
[2024-07-26 15:51:17,420] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1529.23 | backward: 3230.60 | backward_inner: 3116.47 | backward_allreduce: 114.01 | step: 97.20
 98%|█████████▊| 197/200 [22:54<00:14,  4.98s/it]                                                 {'loss': 1.5434, 'grad_norm': 1.345177248705955, 'learning_rate': 1.179840720409331e-08, 'epoch': 4.86}
 98%|█████████▊| 197/200 [22:54<00:14,  4.98s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2530
[2024-07-26 15:51:19,640] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:51:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:51:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:51:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:51:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:51:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:51:19,721] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.45 | forward_fetch_submit: 0.06 | forward_all_gather: 27.44 | backward_fetch_wait: 5.61 | backward_fetch_submit: 0.00 | backward_all_gather: 16.33 | forward_prefetch_submit: 0.74 | backward_prefetch_wait: 0.26
[2024-07-26 15:51:19,764] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 760.14 | backward_microstep: 1557.76 | backward_inner_microstep: 1514.95 | backward_allreduce_microstep: 42.73 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2528
[2024-07-26 15:51:22,017] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:51:22,018] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:51:22,018] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:51:22,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:22,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:22,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:51:22,018] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:51:22,018] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:51:22,098] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 23.08 | forward_fetch_submit: 0.03 | forward_all_gather: 23.38 | backward_fetch_wait: 5.59 | backward_fetch_submit: 0.00 | backward_all_gather: 135.48 | forward_prefetch_submit: 0.84 | backward_prefetch_wait: 0.30
[2024-07-26 15:51:22,244] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.37
[2024-07-26 15:51:22,245] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 776.31 | backward_microstep: 1570.62 | backward_inner_microstep: 1535.41 | backward_allreduce_microstep: 35.15 | step_microstep: 111.94
[2024-07-26 15:51:22,246] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1536.43 | backward: 3128.39 | backward_inner: 3050.39 | backward_allreduce: 77.89 | step: 112.02
 99%|█████████▉| 198/200 [22:59<00:09,  4.93s/it]                                                 {'loss': 1.4457, 'grad_norm': 1.2801549498270712, 'learning_rate': 5.2443095448506674e-09, 'epoch': 4.89}
 99%|█████████▉| 198/200 [22:59<00:09,  4.93s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2549
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:51:24,491] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:51:24,571] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 26.22 | forward_fetch_submit: 0.06 | forward_all_gather: 31.84 | backward_fetch_wait: 5.62 | backward_fetch_submit: 0.00 | backward_all_gather: 16.42 | forward_prefetch_submit: 0.75 | backward_prefetch_wait: 0.26
[2024-07-26 15:51:24,601] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 770.46 | backward_microstep: 1557.93 | backward_inner_microstep: 1528.79 | backward_allreduce_microstep: 29.07 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2596
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:51:26,906] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:51:26,986] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 24.90 | forward_fetch_submit: 0.03 | forward_all_gather: 21.48 | backward_fetch_wait: 5.57 | backward_fetch_submit: 0.00 | backward_all_gather: 116.83 | forward_prefetch_submit: 0.93 | backward_prefetch_wait: 0.30
[2024-07-26 15:51:27,268] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.41
[2024-07-26 15:51:27,269] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 774.48 | backward_microstep: 1762.29 | backward_inner_microstep: 1588.18 | backward_allreduce_microstep: 174.06 | step_microstep: 108.01
[2024-07-26 15:51:27,269] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1544.92 | backward: 3320.23 | backward_inner: 3116.98 | backward_allreduce: 203.13 | step: 108.10
100%|█████████▉| 199/200 [23:04<00:04,  4.96s/it]                                                 {'loss': 1.5325, 'grad_norm': 1.2022993656349035, 'learning_rate': 1.3111633436779792e-09, 'epoch': 4.91}
100%|█████████▉| 199/200 [23:04<00:04,  4.96s/it]dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2589
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3578546176
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 20, numel = 218103808
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 138, numel = 9616564224
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 82, numel = 5110272000
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 118, numel = 8744148992
[2024-07-26 15:51:29,509] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 82, numel = 5110272000
[2024-07-26 15:51:29,589] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 22.07 | forward_fetch_submit: 0.06 | forward_all_gather: 31.12 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 19.38 | forward_prefetch_submit: 0.73 | backward_prefetch_wait: 0.26
[2024-07-26 15:51:29,608] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 766.10 | backward_microstep: 1544.82 | backward_inner_microstep: 1525.92 | backward_allreduce_microstep: 18.82 | step_microstep: 0.08
dynamic ViT batch size: 36, images per sample: 9.0, dynamic token length: 2553
[2024-07-26 15:51:32,051] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 3505, numel = 3483771904
[2024-07-26 15:51:32,051] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 10, numel = 109051904
[2024-07-26 15:51:32,051] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 127, numel = 8423772160
[2024-07-26 15:51:32,051] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_wait: count = 1728, numel = 103162880
[2024-07-26 15:51:32,051] [INFO] [logging.py:96:log_dist] [Rank 0] backward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:51:32,052] [INFO] [logging.py:96:log_dist] [Rank 0] backward_all_gather: count = 97, numel = 5923966976
[2024-07-26 15:51:32,052] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 117, numel = 7987564544
[2024-07-26 15:51:32,052] [INFO] [logging.py:96:log_dist] [Rank 0] backward_prefetch_wait: count = 97, numel = 5923966976
[2024-07-26 15:51:32,133] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.86 | forward_fetch_submit: 0.03 | forward_all_gather: 21.03 | backward_fetch_wait: 5.58 | backward_fetch_submit: 0.00 | backward_all_gather: 49.68 | forward_prefetch_submit: 0.88 | backward_prefetch_wait: 0.31
[2024-07-26 15:51:32,401] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | optimizer_step: 5.70
[2024-07-26 15:51:32,402] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 977.49 | backward_microstep: 1690.32 | backward_inner_microstep: 1525.11 | backward_allreduce_microstep: 165.14 | step_microstep: 103.76
[2024-07-26 15:51:32,403] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward: 1743.57 | backward: 3235.14 | backward_inner: 3051.06 | backward_allreduce: 183.98 | step: 103.85
100%|██████████| 200/200 [23:09<00:00,  5.01s/it]                                                 {'loss': 1.5359, 'grad_norm': 1.3688678337995983, 'learning_rate': 0.0, 'epoch': 4.94}
100%|██████████| 200/200 [23:09<00:00,  5.01s/it][INFO|trainer.py:3503] 2024-07-26 15:51:41,863 >> Saving model checkpoint to work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200
[INFO|configuration_utils.py:472] 2024-07-26 15:51:41,866 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/config.json
[INFO|configuration_utils.py:807] 2024-07-26 15:51:41,866 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/generation_config.json
[INFO|modeling_utils.py:2750] 2024-07-26 15:52:00,161 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 4 checkpoint shards. You can find where each parameters has been saved in the index located at work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2702] 2024-07-26 15:52:00,163 >> tokenizer config file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2711] 2024-07-26 15:52:00,163 >> Special tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/special_tokens_map.json
[INFO|tokenization_utils_base.py:2762] 2024-07-26 15:52:00,163 >> added tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/added_tokens.json
[2024-07-26 15:52:00,217] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step200 is about to be saved!
[2024-07-26 15:52:02,966] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-07-26 15:52:02,967] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-07-26 15:52:07,703] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-07-26 15:52:07,866] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-07-26 15:52:08,732] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-07-26 15:52:08,733] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-07-26 15:52:08,820] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
[INFO|trainer.py:3595] 2024-07-26 15:52:08,840 >> Deleting older checkpoint [work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-81] due to args.save_total_limit
[2024-07-26 15:52:11,100] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:11,491] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:11,522] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:14,860] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:15,316] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:15,558] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
[INFO|trainer.py:3819] 2024-07-26 15:52:17,759 >> 
***** Running Evaluation *****
[INFO|trainer.py:3821] 2024-07-26 15:52:17,759 >>   Num examples = 160
[INFO|trainer.py:3824] 2024-07-26 15:52:17,759 >>   Batch size = 8
[2024-07-26 15:52:18,771] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:19,029] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:19,222] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:19,542] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:22,422] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:22,846] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:23,131] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:23,452] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:26,893] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-26 15:52:30,253] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2605
[2024-07-26 15:52:35,314] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:52:35,314] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:52:35,315] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 101, numel = 7771070464
[2024-07-26 15:52:35,315] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 101, numel = 7771070464
[2024-07-26 15:52:35,337] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.45 | forward_fetch_submit: 0.00 | forward_all_gather: 16.62 | forward_prefetch_submit: 1.05

  0%|          | 0/5 [00:00<?, ?it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2618
[2024-07-26 15:52:36,707] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:52:36,708] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:52:36,708] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:52:36,708] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:52:36,731] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.70 | forward_fetch_submit: 0.00 | forward_all_gather: 17.27 | forward_prefetch_submit: 0.79

 40%|████      | 2/5 [00:01<00:02,  1.44it/s][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2580
[2024-07-26 15:52:38,194] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:52:38,194] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:52:38,195] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:52:38,195] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:52:38,218] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.99 | forward_fetch_submit: 0.00 | forward_all_gather: 16.10 | forward_prefetch_submit: 0.74

 60%|██████    | 3/5 [00:02<00:02,  1.03s/it][Adynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2521
[2024-07-26 15:52:39,661] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:52:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:52:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:52:39,662] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:52:39,685] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 12.62 | forward_fetch_submit: 0.00 | forward_all_gather: 17.44 | forward_prefetch_submit: 0.79

 80%|████████  | 4/5 [00:04<00:01,  1.19s/it][Apetrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
petrel_client is not installed. If you read data locally instead of from ceph, ignore it.
Replace train sampler!!
petrel_client is not installed. Using PIL to load images.
dynamic ViT batch size: 72, images per sample: 9.0, dynamic token length: 2604
[2024-07-26 15:52:42,615] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_wait: count = 1761, numel = 1942767616
[2024-07-26 15:52:42,615] [INFO] [logging.py:96:log_dist] [Rank 0] forward_fetch_submit: count = 0, numel = 0
[2024-07-26 15:52:42,616] [INFO] [logging.py:96:log_dist] [Rank 0] forward_all_gather: count = 113, numel = 7771070464
[2024-07-26 15:52:42,616] [INFO] [logging.py:96:log_dist] [Rank 0] forward_prefetch_submit: count = 113, numel = 7771070464
[2024-07-26 15:52:42,639] [INFO] [logging.py:96:log_dist] [Rank 0] rank=0 time (ms) | forward_fetch_wait: 20.89 | forward_fetch_submit: 0.00 | forward_all_gather: 17.68 | forward_prefetch_submit: 0.88

100%|██████████| 5/5 [00:07<00:00,  1.80s/it][A                                                 
                                             [A{'eval_loss': 1.629651665687561, 'eval_runtime': 25.0802, 'eval_samples_per_second': 6.38, 'eval_steps_per_second': 0.199, 'epoch': 4.94}
100%|██████████| 200/200 [24:19<00:00,  5.01s/it]
100%|██████████| 5/5 [00:07<00:00,  1.80s/it][A
                                             [A[INFO|trainer.py:3503] 2024-07-26 15:52:52,469 >> Saving model checkpoint to work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200
[INFO|configuration_utils.py:472] 2024-07-26 15:52:52,471 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/config.json
[INFO|configuration_utils.py:807] 2024-07-26 15:52:52,472 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/generation_config.json
[INFO|modeling_utils.py:2750] 2024-07-26 15:53:25,251 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 4 checkpoint shards. You can find where each parameters has been saved in the index located at work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2702] 2024-07-26 15:53:25,253 >> tokenizer config file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2711] 2024-07-26 15:53:25,253 >> Special tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/special_tokens_map.json
[INFO|tokenization_utils_base.py:2762] 2024-07-26 15:53:25,253 >> added tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/added_tokens.json
[2024-07-26 15:53:26,028] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step200 is about to be saved!
[2024-07-26 15:53:28,294] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-07-26 15:53:28,295] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-07-26 15:53:47,424] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-07-26 15:53:47,736] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-07-26 15:53:48,964] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-07-26 15:53:48,967] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/checkpoint-200/global_step200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-07-26 15:53:49,121] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[INFO|trainer.py:2394] 2024-07-26 15:53:49,126 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                 {'train_runtime': 1529.8235, 'train_samples_per_second': 4.197, 'train_steps_per_second': 0.131, 'train_loss': 1.702927794456482, 'epoch': 4.94}
100%|██████████| 200/200 [25:26<00:00,  5.01s/it]100%|██████████| 200/200 [25:26<00:00,  7.63s/it]
[INFO|trainer.py:3503] 2024-07-26 15:53:58,356 >> Saving model checkpoint to work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt
[INFO|configuration_utils.py:472] 2024-07-26 15:53:58,358 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/config.json
[INFO|configuration_utils.py:807] 2024-07-26 15:53:58,359 >> Configuration saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/generation_config.json
[2024-07-26 15:54:00,762] [INFO] [launch.py:347:main] Process 3035047 exits successfully.
[2024-07-26 15:54:00,762] [INFO] [launch.py:347:main] Process 3035046 exits successfully.
[2024-07-26 15:54:01,763] [INFO] [launch.py:347:main] Process 3035048 exits successfully.
[INFO|modeling_utils.py:2750] 2024-07-26 15:54:18,519 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 4 checkpoint shards. You can find where each parameters has been saved in the index located at work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2702] 2024-07-26 15:54:18,520 >> tokenizer config file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/tokenizer_config.json
[INFO|tokenization_utils_base.py:2711] 2024-07-26 15:54:18,520 >> Special tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/special_tokens_map.json
[INFO|tokenization_utils_base.py:2762] 2024-07-26 15:54:18,520 >> added tokens file saved in work_dirs/00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt/added_tokens.json
***** train metrics *****
  epoch                    =        4.9383
  total_flos               = 74288211440GF
  train_loss               =        1.7029
  train_runtime            =    0:25:29.82
  train_samples            =          1284
  train_samples_per_second =         4.197
  train_steps_per_second   =         0.131
wandb: - 0.099 MB of 0.099 MB uploadedwandb: \ 0.099 MB of 0.099 MB uploadedwandb: | 0.099 MB of 0.099 MB uploadedwandb: / 0.099 MB of 0.827 MB uploadedwandb: - 0.733 MB of 0.842 MB uploadedwandb: \ 0.842 MB of 0.842 MB uploadedwandb: 
wandb: Run history:
wandb:               eval/loss █▄▂▁▁
wandb:            eval/runtime █▅▄▄▁
wandb: eval/samples_per_second ▁▃▅▅█
wandb:   eval/steps_per_second ▁▃▅▅█
wandb:             train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:       train/global_step ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:         train/grad_norm █▆▂▁▂▁▆▂▂▂▂▄▂▇▃▃▃▃▃▄▃▃▄▄▄▃▅▄▃▄▄▄▃▃▅▄▆▄▄▄
wandb:     train/learning_rate ▃███████▇▇▇▇▇▆▆▆▆▅▅▅▅▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:              train/loss █▇▆▅▅▄▄▄▄▄▃▃▃▂▃▃▃▃▃▃▂▁▂▂▂▁▁▂▂▁▂▂▁▂▂▂▁▁▂▂
wandb: 
wandb: Run summary:
wandb:                eval/loss 1.62965
wandb:             eval/runtime 25.0802
wandb:  eval/samples_per_second 6.38
wandb:    eval/steps_per_second 0.199
wandb:               total_flos 7.976635965328327e+19
wandb:              train/epoch 4.93827
wandb:        train/global_step 200
wandb:          train/grad_norm 1.36887
wandb:      train/learning_rate 0.0
wandb:               train/loss 1.5359
wandb:               train_loss 1.70293
wandb:            train_runtime 1529.8235
wandb: train_samples_per_second 4.197
wandb:   train_steps_per_second 0.131
wandb: 
wandb: 🚀 View run 00_internvl_chat_v1_5_internlm2_8b_dynamic_res_finetune_freezellm_unfreeze_vm_loravm16_basesysprompt at: https://wandb.ai/dberezin-SoftPear/huggingface/runs/lv9k3lr8
wandb: ⭐️ View project at: https://wandb.ai/dberezin-SoftPear/huggingface
wandb: Synced 6 W&B file(s), 0 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_152820-lv9k3lr8/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[2024-07-26 15:54:30,795] [INFO] [launch.py:347:main] Process 3035045 exits successfully.
